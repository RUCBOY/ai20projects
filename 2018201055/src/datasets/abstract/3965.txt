We present a Graphics Processing Units (GPU) implementation of time gating based reverse time migration (TG-RTM) which uses the pseudospectral time-domain (PSTD) algorithm to solve the acoustic wave equation. TG-RTM adopts the prior information of surrounding media to strengthen the correlation between the wavefields, thus has advantages in locating the targets over traditional reverse time migration (RTM) methods. The PSTD algorithm adopts fast Fourier transform (FFT) to obtain the spatial derivatives and a perfectly matched layer as an absorbing boundary condition to eliminate the wraparound effect introduced by the FFT periodicity assumption. Under the Nyquist sampling theorem, the spatial sampling density of the PSTD algorithm requires only two points per minimum wavelength. Thus, the PSTD algorithm can solve the time dependent partial differential equations efficiently and save mass computer memory. Compared with traditional RTM based on the finite difference time domain (FDTD) algorithm, the proposed RTM based on the PSTD algorithm can be implemented on a memory-limited GPU and can solve much larger models. To secure a better performance and generality of FFT in GPU, we present a scheme which combines 1D FFT with matrix transpositions instead of using 3D FFT directly. The matrix transpositions use shared memory to improve memory access efficiency. We also apply an efficient FFT scheme which replaces even-sized R2C FFT with a half-sized C2C FFT. For a small amount and balanced memory swapping from computer to GPU, we save the boundaries in lieu of checkpointing scheme when we propagate the source wavefield forward and backward. The proposed RTM has an acceleration ratio of about 80 times by a Tesla K20X GPU card on a desktop computer. The simulation results of 2D and 3D models demonstrate that the proposed RTM is fast and inexpensive.
