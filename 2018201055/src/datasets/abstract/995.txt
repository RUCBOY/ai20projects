Given a graph, the sparsest cut problem asks for a subset of vertices whose edge expansion (the normalized cut given by the subset) is minimized. In this paper, we study a generalization of this problem seeking for k disjoint subsets of vertices (clusters) whose edge expansions are small and furthermore, the number of vertices that remained in the exterior of the subsets (outliers) is also small. It is proved in Daneshgar etÂ al. (2012) that this problem is NP-hard for trees. Here, we prove that it can be solved in polynomial time for all weighted trees, provided that the search space is restricted to subsets inducing connected subgraphs. The additional constraint has justifications in real-world applications. The proposed algorithm is based on dynamic programming and runs in the worst case in O(k2n3) time, when n is the number of vertices and k is the number of clusters. It also runs in linear time when the number of clusters and the number of outliers are bounded by a constant.
