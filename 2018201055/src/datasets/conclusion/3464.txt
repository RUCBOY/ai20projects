In this paper, we provide a formal definition of flow-net. Using flow-net, we describe an approach to define different types of behaviors in computer systems and networks. Each type of behaviors has its unique fingerprint. Leveraging on this fact, we propose a flow-net based fingerprint (FNF). The salient features of FNF are two. First, it takes advantage of the graph structure of flow-net to capture relations of events in various behaviors explicitly. Second, it adopts the notion of abstract events, and only record types of attributes that an event entails and forgo values of the attributes. These result in precise and compact forms of behavior fingerprint represented in directed acyclic graphs. Furthermore, we propose a Fingerprint Lookup Algorithm (FLA) to locate behaviors in flow-net, a solution to solve a fingerprint matching problem. We apply the FNF and FLA into detecting the fingerprints of a few selected malicious behaviors in computer networks. Finally, evaluation results from experiments demonstrate superior computational efficiency of the proposed approach in intrusion detection.
It is worth noting that we formulate the fingerprint matching problem as a subgraph isomorphism problem. There are numerous subgraph matching algorithms available in the literature (Bonnici, Giugno, 2013, Cordella, 2004, Jamil, 2011, Ullmann, 2011). These algorithms are application specific, i.e., their efficiencies depend on specific characteristics of underlying graphs as subgraph isomorphism is in general an NP-hard problem. Their applicability to solve fingerprint matching in flow-net is an interesting subject to investigate.
Since the flow-net logging is a superset of conventional logging (i.e., recording events), it can be incorporated into existing IDS such as Snort (Roesch, 1999) to examine its accuracy to detect various instructions. However, at present Snort is a rule-based and event-based IDS, and it is difficult to utilize the graph feature of the flow-net to perform fingerprint matching in Snort. In other words, it requires significant effort to extend Snort with rules to incorporate flow-net into Snort with graph-based fingerprint matching.
One challenging issue in intrusion detection is to extract high-quality flow-net based fingerprints to represent the patterns of anomalous behaviors, which is critical and impacts how flow-net can be adopted in intrusion detection in practice. In our evaluation, the fingerprints are obtained via an arduous and manual process. To generate fingerprints automatically for our graph-based flow-net logging is a challenging task.
FNF has both advantages and disadvantages compared to other approaches also using direct acyclic graphs, e.g., that in Lee et al. (2009). As discussed in the related work (Section 2), the difference of our approach and those using direct acyclic graphs are two-fold. First is the granularity of events and their relations. Flow-net records events and their relations to form direct acyclic graphs in real time, and as the result it has the finer granularity than the later approaches that extract higher-level views of events in graphs. Advantages of flow-net include being practical and easy to achieve in real systems, while the later approaches build high-level views requiring high-level abstraction and knowledge of the underlying systems that may not be easy to obtain from practical and complex systems. Second is at a limitation of FNF as it is currently proposed. This resulted from the fact that fingerprinting only considers events that are adjacent in the flow-net logging. For example, in Fig. 2, it is difficult to see that (e11, e9, e5, e7) can form a behavior (assuming that it is a behavior in a system) and match a fingerprint. In other words, it becomes difficult to obtain a high-level abstraction or relations among non-adjacent nodes in the graph. This is the trade-off between the flow-net logging and those approaches using direct acyclic graphs as in Lee et al. (2009). In general, an approach with finer granularity, such as, flow-net, is easier to implement without requiring human knowledge on higher-level behaviors; however, it is more difficult to obtain a global view of the system. On the other hand, an abstract approach, such as, the approaches using direct acyclic graphs as in Lee et al. (2009), is more difficult to implement requiring human knowledge on high-level abstraction of system behaviors; but once achieved, it is more likely to have a global view of the system.
The above discussion leads to future exploration in a few directions. As FNF is formulated as a graph isomorphism problem, it is worth investigating the applicability and performance of various graph isomerism algorithms in the literature in the flow-net based IDS.
The trade-off between computational efficiency and detection accuracy is an important subject. In particular, how we may extend the flow-net based fingerprinting to higher, more abstract, and more global views of system behavior is an interesting one, in particular, leveraging existing research on extracting high-level views of system behavior into directed acyclic graphs.
Recording events precisely and efficiently in a system and detecting possible intrusion from the recorded events timely and accurately are two major problems that go hand-in-hand in intrusion detection. In this paper, we focus on the former by proposing a flow-net based logging and fingerprinting. Another direction is to extend existing IDS, such as Snort with FNF graph-based detection rules. There will be two related efforts for this. First, it is to investigate the feasibility of a rule-based language to express flow-net based behavior fingerprints. Second, it is to design efficient algorithms utilizing recent advances in machine learning to extract fingerprints of various behavior from computer systems and networks expressed in the language automatically. Finally, in full circle, it is important to examine detection algorithms and their detection performance including both detection accuracy and efficiency of instructions in actual systems and networks using the fingerprints and rules.
