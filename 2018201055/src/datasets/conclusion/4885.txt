The scalable parallelization of an AGCM turns out to be quite challenging for atmospheric scientists. It needs not only many parallel algorithms of numerical computing but also huge amounts of code implementation. Therefore, computer scientists or software engineers are needed to provide professional help during the design and development of an AGCM. As demonstrated above in this paper, we put forward a two-dimensional domain decomposition parallel algorithm for the IAP AGCM4.0. The algorithm is mainly used in the parallelization of the dynamical core implemented with MPI. After the parallelization, the IAP AGCM4.0 can run on 3120 CPU cores. The speedup of the IAP AGCM4.0 with 50.88% parallel efficiency on 512 CPU cores can reach 8.14x. The experimental result shows that our parallel algorithm is efficient and scalable, and it will show a more desirable parallel performance in the model with higher resolution and with longer-time integration. Our work is meaningful for real-time climate simulation. The parallel algorithm can also be used in the parallelization of other AGCMs, because their parallel ideas are all similar. Although the IAP AGCM4.0 does not have very high parallel efficiency on thousands of cores, we have created a precedent which will promote the development of climate simulation with computing on thousands of cores. We will continue to optimize the IAP AGCM4.0.
The dynamical core has many small computing tasks, so its parallelization can be implemented with OpenMP in the future. In this way, the IAP AGCM4.0, implemented with the MPI + OpenMP hybrid paradigm which exploits two-level parallelism, will run more quickly on a multi-core cluster. The physical parameterizations have quite a good parallel performance, so we can expect to assign more processors to the physical parameterizations in long-time computing with large-scale cores. At present, some physical parameterization schemes of the Weather Research and Forecasting model (WRF) with a Graphics Processing Unit (GPU) version have been implemented  [32], [33], [34], [35], [36]. The IAP AGCM4.0 shares physical parameterization schemes that are similar to the WRF, so running the physical parameterizations on the GPU cores may also be considered. In other words, the GPU version of the physical parameterizations may be developed later. Moreover, a parallel I/O strategy with high data throughput  [37] for the IAP AGCM4.0 should be also researched. In this way, the IAP AGCM4.0 will be more efficient and scalable in large-scale multi-core computing.
