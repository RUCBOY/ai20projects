Small-angle X-ray scattering (SAXS) from protein molecules in solution is a powerful technique that provides information on molecular structures and dynamics (Grant et al., 2011, Putnam et al., 2007, Svergun and Koch, 2003). Because the solution scattering method does not require special treatment for protein molecules, such as crystallization in diffraction measurement or isotope labeling in nuclear magnetic resonance, SAXS experiments can be performed in high-throughput manners (Hura et al., 2009). Another major advantage of SAXS experiments is the ability to probe the structure and dynamics in solution, which is especially useful when combined with pumping methods to promote conformational changes (Kim et al., 2012, Neutze and Moffat, 2012). Time-resolved studies will reveal important information on molecular mechanism for protein functions.
Despite the success in extracting structural information from SAXS profiles, reconstructing high-quality 3D models remains challenging. Several approaches have been proposed and implemented to build 3D density maps from SAXS data, including shape envelope approximation using spherical harmonics functions, polymer chain folding, dummy atom assembly, iterative phasing, and database searching methods. The spherical harmonics function approximation method is fast but limited by resolution (Stuhrmann, 1970, Svergun and Stuhrmann, 1991, Svergun et al., 1996). In the Gasbor program, polymers composed of connected beads were used to represent protein molecules, and the packing of these polymers was optimized to build 3D models (Svergun et al., 2001). Dummy atoms arranged in a 3D lattice were also used for model reconstruction, as implemented in DAMMIN/DAMMIF (Franke and Svergun, 2009, Svergun, 1999). An iterative phase retrieval method was expanded to analyze SAXS data and demonstrated its applications (Grant, 2018). Using machine learning methods, Franke et al. developed a method to classify the shapes and gain valuable model parameters (Franke et al., 2018). There are also successful attempts to integrate SAXS data to molecular prediction/modeling/simulation frameworks to obtain 3D structures (Hura et al., 2019, Karczyńska et al., 2018). A database of shapes abstracted from actual protein complexes and efficiently represented using 3D Zernike polynomials was used to quickly retrieve 3D models that match experimental SAXS profiles, as implemented in sastbx.shapeup (Liu et al., 2012b). A real space representation of a 3D model requires many parameters, such as the position of each bead, which can be described using its coordinates (then 3N parameters are required for a model with N beads). However, the number of parameters required is much greater than the number of free parameters encoded in 1D SAXS profiles (Moore, 1980). Therefore, prior knowledge must be applied to provide additional constraints for converged reconstructions. For example, the molecular size and the connectivity of the beads are very critical for DAMMIN/DAMMIF. In the case of sastbx.shapeup, the molecular size is de-coupled from the abstracted shapes (Liu et al., 2012a), allowing an optimization of the size as a separate parameter. However, the diversity of models is limited by the database. Model reconstruction will be significantly advanced if the following criteria are met: (1) diverse shapes of 3D models can be efficiently represented to cover a broader range than those in structure databases and (2) SAXS profiles can be computed for each model that can be scaled to arbitrary sizes. We provide a solution to achieve this using an auto-encoder method combined with 3D Zernike representations (Canterakis, 1999, Liu et al., 2012a).
Inspired by deep learning methods, real space 3D models were encoded using an auto-encoder neural network to a compressed representation of 200 latent parameters. The protein complexes in the PISA database (Krissinel and Henrick, 2007) were used to generate the training datasets for the auto-encoder. Each complex structure was scaled to the same radius (50Å was used in this study) then voxelized on a 3D grid of 31 × 31 × 31 (i.e., voxel edge size is 50/15Å). Because SAXS data often provide low-resolution information that warrants a uniform density approximation for 3D models, we binarized the voxelized objects before auto-encoder training. Owing to the uniform density approximation of the reconstructed models, the SAXS data comparison were limited up to q = 0.2 Å−1 (Grant, 2018, Poitevin et al., 2011). The auto-encoder model is based on the VGG network (Simonyan and Zisserman, 2015), composed of convolutional, pooling, and full-connected layers (see Figure 1, Table S1 and the Transparent Methods). The testing results show that diverse shapes represented using 313 voxels with binary numbers can be accurately encoded using a vector of 200 dimensions. The reduction of parameter space allows application of optimization algorithms to improve the model-data fitting. SAXS profiles for 3D voxelized objects were computed using the Zernike expansion method, taking advantage of fast evaluation of theoretical profiles at an arbitrary model radius. The genetic algorithm (Goldberg, 1989) was used to optimize the latent space parameters, which were decoded to 3D models subsequently. One of the major advantages of the proposed method is the automatic determination of the model radius, which can be coded as an additional parameter and subject to the optimization along with the other 200 parameters. The testing results using experimental data from the SASBDB (Valentini et al., 2015) and BIOISIS (Rambo and Tainer, 2011) show that the proposed method can successfully generate 3D models based on SAXS data. The algorithm is implemented to the software, decodeSAXS, whose source code and an associated webserver are available at http://liulab.csrc.ac.cn/decodeSAXS.Download : Download high-res image (746KB)Download : Download full-size imageFigure 1. Framework of Auto-Encoder and Its Capability in Representing 3D Models(A) The voxelization of a molecular structure. Left: an atomic model represented in the cartoon representation. Right: the model is mapped on a 3D matrix whose values are binarized depending on whether the grids are in the vicinity of any atom of the protein molecule.(B) The auto-encoder-decoder architecture used in this study. The layers and structures are shown in the figure; details can be found in the Transparent Methods.(C) The model quality encoded using the trained network and measured using the correlation coefficients between the models before and after going through the encode-decode process.(D) The distribution of encoding parameter values for first four parameters in latent space.
