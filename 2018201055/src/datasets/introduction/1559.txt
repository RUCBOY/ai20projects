1.1. BackgroundPartial key exposure attacks on RSA. In Eurocrypt'96, Coppersmith introduced polynomial time algorithms for recovering small roots of univariate modular polynomials [1] and bivariate integer polynomials [2] by using the LLL reduction [3]. The so-called Coppersmith's methods can also be used for solving modular/integer equations with more variables under a reasonable heuristic assumption. Thus far, the methods have provided numerous security results especially for RSA. See [4], [5], [6], [7], [8] for detailed information. One of the flagship applications is arguably Boneh and Durfee's small secret exponent attack [9]. They first showed that RSA is insecure if a secret exponent is sufficiently small such as d<N0.284, then improved the bound to d<N0.292 in the same work.Boneh, Durfee, and Frankel [10] studied the security of RSA when attacker are given (1) the most significant bits (MSBs) or (2) the least significant bits (LSBs) of a full size d, i.e., the so-called partial key exposure attacks. Boneh et al.'s attacks work only for a small public exponent e. Blömer and May [11] proposed improved attack in (2) that works for e<N0.875. Ernst et al. [12] proposed the first attack that works up to full size e in (1). Then, they also studied the problem for a full size e. Furthermore, in addition to (1) and (2), they also considered a case when attacker are given (3) both the MSBs and the LSBs of d. Their proposed attacks work up to full size d in (1) and (3), and for d<N0.875 in (2). Ernst et al.'s attack in (3) is an extension of those in (1) and (2) in the sense that the attack condition of (3) is the same as that of (1) and (2) when the amount of given LSBs and MSBs is zero, respectively. However, Ernst et al.'s results had obvious drawbacks for small d. Observe that the attack scenarios (1)–(3) are same as Boneh-Durfee's one when the amount of given partial information is zero. Nevertheless, Ernst et al.'s attacks in all (1)–(3) are not proper extensions of Boneh-Durfee's stronger attack but only those of the weaker attack in the sense that Ernst et al.'s attacks work for d<N0.284 when the amount of given partial information is zero. Although Sarkar et al. [13] tried to improve Ernst et al.'s attack, Sarkar et al.'s attack is included as a special case of Ernst et al.'s attack. Aono [14] proposed the first extension of Boneh-Durfee's stronger attack in (2) and improved Ernst et al.'s attack for small d<N0.368. Afterwards, Takayasu and Kunihiro [15] proposed the first extension of Boneh-Durfee's stronger attack in (1) and an improvement of Aono's attack in (2). Unfortunately, their improvements are limited to small d, i.e., d<N0.5625 in (1) and d<N0.368 in (2).Since Takayasu and Kunihiro [15] did not study the partial key exposure scenario (3), the most convincing way for improving Ernst et al.'s attack in (3) is constructing an extension of Takayasu-Kunihiro's attacks so that it is the same as Takayasu-Kunihiro's attack in (1) and (2) when the amount of given LSBs and MSBs is zero, respectively. We can expect that the extended attack improves Ernst et al.'s attack at least for d<N0.5625. However, the extension should be technically difficult due to the nature of Coppersmith's methods explained as follows.Hardness for constructing extended attacks. In the context of Coppersmith's methods, constructing a better attack is equivalent to constructing a better matrix so that a lattice spanned by the matrix has shorter vectors. For the purpose, Jochemsz and May [16] formalized a method of constructing such a matrix. A matrix based on the construction has a good quality to some extent. Furthermore, the matrix is always triangular; hence, the analysis is very simple. For example, Boneh-Durfee's weaker attack is based on the Jochemsz-May construction while the stronger attack utilized a non-triangular matrix and requires complicated analysis.Herrmann and May [17] shed light on the situation by providing a much simpler proof of Boneh-Durfee's strong attack based on the unraveled linearization technique [18]. In short, Boneh and Durfee solved a modular equation1+x(N+y)=0mode to obtain their attack. As claimed above, they employed a non-triangular basis matrix for the stronger attack. However, Herrmann and May showed that the matrix becomes triangular under a suitable variable transformation. In particular, they defined a new linearized variable z=1+xy and reformulate the above modular equation byNx+z=0mode. Although an algebraic property of x and y is lost by the linearization, Herrmann and May recovered the lost algebraic structure with an unraveling operation z⇒1+xy under a simple criterion. As a result, they successfully obtained Boneh-Durfee's stronger attack under a triangular matrix.However, it does not immediately mean that Herrmann-May's simpler proof is sufficient for analyzing an extension of Boneh-Durfee's stronger attack easily. Indeed, even after Herrmann-May's work, there were several papers to extend Boneh-Durfee's attack [19], [20], [21] that result in extending only the weaker attack. Intuitively, regarding Ernst et al.'s attack [12], it was technically hard to extend Boneh-Durfee's stronger attack by simultaneously preserving a complicated structure of the matrix and utilizing the given partial information. In general, to extend existing attacks are sometimes not trivial and require special techniques in the context of Coppersmith's methods. Specifically, we face the difficulty when the underlying attacks are not based on the Jochemsz-May construction. We note that Ernst et al.'s partial key exposure attacks in all (1)–(3) are based on the Jochemsz-May construction; hence, they were able to extend Boneh-Durfee's weaker attack easily.To improve Ernst et al.'s attacks, Takayasu and Kunihiro [15] developed a new approach for constructing a matrix, where the spirit was explained in their full version [22] in detail. Specifically, they exploited a hidden structure of a Herrmann-May's matrix and modified the matrix so that it becomes compatible for embedding the given partial information. For the purpose, Takayasu and Kunihiro first provided a matrix for Boneh-Durfee's stronger attack, where there are more x's and y's and less z's than Herrmann-May's matrix. Due to the specific modifications, they were able to preserve a structure of Boneh-Durfee's stronger attack in the partial key exposure scenarios (1) and (2) by embedding the given MSBs and LSBs to the recovered algebraic structures.It still seems a difficult task for extending Takayasu-Kunihiro's attacks for (3) since they took distinct ways for embedding the given MSBs and the LSBs in (1) and (2) with complicated analyses. In short, they applied the unraveling operation under distinct criteria between (1) and (2). Hence, the amount of algebraic structures that they recovered differ between (1) and (2). To be more precise, they recovered more algebraic structures for (2) than those for (1). Thus, the natural way for simultaneously extending (1) and (2) is embedding the given MSBs to Takayasu-Kunihiro's matrix for (2) that has more recovered algebraic structures. By following the approach, the resulting attack is arguably an extension of Takayasu-Kunihiro's attack of (2), i.e., the attack is the same as Takayasu-Kunihiro's attack (2) when the amount of given MSBs is zero. However, the amount of embedding of the MSBs is insufficient to extend Takayasu-Kunihiro's attack of (1), i.e., the attack is weaker than Takayasu-Kunihiro's attack (1) when the amount of given LSBs is zero. In other words, although Takayasu-Kunihiro's matrix in (2) recovered more algebraic structures than that in (1), it does not suggest that the matrix in (2) has the same quality as that in (1) for embedding the given MSBs. That is why Takayasu and Kunihiro took different ways in (1) and (2). Moreover, subsequent to Takayasu-Kunihiro's work, there were several papers for studying partial key exposure attacks on RSA variants [20], [23], [24] that failed to properly extend Takayasu-Kunihiro's attacks. Therefore, an extension of Takayasu-Kunihiro's attack seems to require developing a specific technique to the partial key exposure scenario (3) with complicated analyses.
1.2. Our resultsIn this paper, we propose an extension of Takayasu-Kunihiro's partial key exposure attacks for (3) and improve Ernst et al.'s attack. In spite of the above observation, we do not require a complicated analysis as the original Takayasu-Kunihiro's paper [15], [22] since we do not construct the attack from scratch but utilize the structures of the previous Takayasu-Kunihiro's attacks with as slight modifications as possible. Specifically, we first modify Takayasu-Kunihiro's attack in (2) so that the matrix is compatible for embedding the given MSBs with the same quality as Takayasu-Kunihiro's attack in (1). To be precise, although Takayasu-Kunihiro recovered more algebraic structures to obtain the attack in (2), we find that we are able to obtain the same attack with less recovered algebraic structures, where the criterion is the same as Takayasu-Kunihiro's matrix in (1). In other words, we find a fact that the structure of Takayasu-Kunihiro's original matrix in (2) is not so sensitive as the authors expected. Hence, our modified matrix still had the same quality as the original one to embed the given LSBs. As a result, we successfully extend Takayasu-Kunihiro's attacks for (3).Since our attack is an extension of Takayasu-Kunihiro's attack, it has an advantage for small d. In particular, our attack works for d<N0.292 when the amount of given partial information is zero. Furthermore, our attack has a surprising feature that the original Takayasu-Kunihiro's attacks do not have; our attack improves Ernst et al.'s one up to full size decryption exponent. As a consequence, we are also able to propose an improved attack when d is full size. We will provide more detailed comparisons in Section 2.
1.3. Related worksBoneh and Durfee's attack [9] is one of the flagship applications of Coppersmith's methods [1]. The attack improved Wiener's attack [25] based on the continued fraction approach and factorizes an RSA modulus when d<N0.292. Due to the popularity, several variants of the attack have been proposed, e.g., attacks on unbalanced RSA [26], [27], prime power RSA [19], [20], [28], [29], Takagi's RSA [29], [30], [31], multi-prime RSA [32], and RSA with multiple exponent pairs [21], [33], and its mathematical extensions [34], [35], [36], [37]. Recently, Aono et al. [38] found an optimality of the Boneh-Durfee stronger attack under heuristic assumptions. As similar settings, there are small CRT exponent attacks [39], [40], [41], [42].Similarly, partial key exposure attacks have been intensively studied. There are several partial key exposure on RSA variants, e.g., prime power RSA [23], [28], [29], Takagi's RSA [29], [43], multi-prime RSA [32], [44], and RSA with multiple exponent pairs [21], [33], [45]. As similar settings, several papers study partial key exposure attacks on CRT-RSA [46], [47], [48], [49].
1.4. OrganizationIn Section 2, we formulate a partial key exposure scenario, then provide attack conditions of previous works and ours. In Section 3, we recall Coppersmith's methods to solve modular equations with small solutions. In Sections 4, we observe previous attacks. The content in this section is crucial to obtain our improved attacks. Finally, we show our attacks in Section 5 and its experimental results in Section 6.
