With the development of the Internet of Things, smart cities have received widespread attention from academia and industry. As an essential part of a smart city, the Internet of Vehicles (IoV) can significantly improve transportation efficiency, reduce energy consumption, and traffic accidents [21]. Fig. 1 shows a typical application scenario of IoV. The RoadSide Units (RSUs) are usually road infrastructure fixed to the roadside and the Trusted Authority (TA) is usually a trusted server, and the Data Center (DC) is used to store all IoVs related information. Each vehicle is equipped with an OnBoard Unit (OBU). When the vehicle enters the communication range of the RSU, it will automatically communicate with the RSU over the wireless channel through the Dedicated Short Range Communications (DSRC) protocol. Wired channels are usually used between each TA and between the TA and DC. After a vehicle establishes a connection with the TA via the RSU, it can upload information such as its location and vehicle status to the TA, and can also receive information such as traffic information from the TA to plan its driving route.
In IoV, the services provided by the TA depend on the necessary data uploaded by the vehicle, and the decisions made by the vehicle depend on the services provided by the TA. However, as the vehicle and the RSU utilize wireless channels for communication, the risk of information being leaked or tampered is significantly increased [20]. Once the TA provides wrong services for vehicles based on false information, it may cause economic loss and even endanger vehicle safety. Therefore, designing a secure and reliable authentication and key agreement protocol for the IoV is the key to solving these problems [16].Download : Download high-res image (236KB)Download : Download full-size imageFig. 1. A typical application scenario of IoV.
Authentication and key agreement protocol is an effective access control and authorization mechanism [2]. In such a protocol, the two parties in communication use several message exchanges to confirm that the other party is a legitimate user or device in an insecure environment. In addition, in the process of message exchange, a secret session key can be negotiated to encrypt and decrypt subsequent communication data.
Most of the existing authentication protocols belong to a centralized structure, that is, it is assumed that all vehicles can only perform mutual authentication with the TA, so the RSU only serves as an intermediate node to assist the communication between the vehicle and the TA. Due to the high-speed mobility of vehicles, the TA must complete mutual authentication and key agreement with all vehicles that request authentication in a short time. However, for such centralized authentication protocols, as long as the number of vehicles requesting authentication at the same time is sufficient, it may fail to complete mutual authentication with all vehicles within a limited time. Therefore, such centralized authentication protocols are easily affected by TA’s communication and computing resource bottlenecks. In addition, under the assumption that the TA has unlimited resources, almost all existing authentication protocols use only one TA in the network model, which is inappropriate. In smart cities, it is clear each city should have one or more similar TAs responsible for managing different areas. Therefore, the IoVs should use a multi-TA network model. However, because the vehicle has long-distance mobility, this means that the vehicle faces cross-TA authentication problems [17].
In this article, we proposed a blockchain-based and RSU-assisted authentication and key agreement protocol for the IoVs to solve the above problems. Blockchain technology is suitable for decentralized application environments with distributed consensus characteristics [31]. In other words, it is suitable for solving cross-TA authentication problems in the IoV. We use blockchain technology to make all TAs jointly manage the same ledger that stores vehicle-related information. Under the protection of blockchain technology, adversaries cannot easily tamper with the vehicle-related information stored in the ledger. Besides, in order to solve the problem of computing bottlenecks in TAs, we move the computing load down to the RSU as much as possible to achieve decentralized authentication. Our protocol has the following characteristics:

•Our protocol uses a more reasonable multi-TA network model. Based on blockchain technology, all TAs in our protocol can jointly manage the same ledger that stores vehicle-related information, which can not only achieve cross-TA authentication but also improve authentication efficiency.•In our protocol, the RSU assists TA to complete the authentication with the vehicle and moves the computing load down to the RSU as much as possible, which effectively reduces the bottleneck of the TA and improves authentication efficiency.•In order to further reduce the computing time of the entire authentication protocol, our protocol uses only a limited number of cryptographic tools such as hash operations, XOR operations, and pseudo-random numbers.
The remaining of this article is organized as follows. Related works of this proposed research are introduced in Section 2. The background of the blockchain and the network and threat models used in this article are described in Section 3, and the proposed protocol is entirely described in Section 4. In Section 5, we used various methods to prove the security of the proposed protocol. The performance analysis and the comparison with some related works are shown in Section 6, and finally, concluding remarks and future directions are given in Section 7.
