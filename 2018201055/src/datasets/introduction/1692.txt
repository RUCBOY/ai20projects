Identifying unauthorized access of a computer network system is known as intrusion detection. The rationale behind this activity is the security threats and harmful consequences of illegal accesses, which can be instigated by internal or external intruders attempting to obtain valuable computer system information without permission [1]. Moreover, the strong growth of Internet-connected devices, the number of which is anticipated to reach 50 billion by the end of the decade, makes network security attacks become an essentially global problem [2].
Intrusion detection systems (IDS) are novel security mechanisms that use state-of-the-art techniques to secure computer networks against invasions in progress or illegal accesses that have occurred. In addition, cybersecurity work needs resilient and robust design of the IDS, which can withstand large scale ethical hacking and tests in real-time [3]. With respect to protection, an IDS can be categorized as a host-based IDS (HIDS) that uses system log files or a network-based IDS (NIDS) that uses network behaviors. Moreover, there are two forms of these systems, namely, anomaly based and signature-based detection IDSs, which are based on normal and abnormal network patterns, respectively. A signature-based IDS detects an intrusion directly when predefined abnormal network data are detected [4], while an anomaly based IDS analyzes normal network behaviors to determine whether network patterns are considered intrusions [5]. To date, existing IDS designs have been reported with poor performance, including high false positive rates and low accuracy [6], [7], [8], [9], [10]. Hence, one of the most important requirements for designing an IDS is improved detection performance.
To improve IDS performance, many studies have focused on IDS design using machine learning (ML) techniques, which rely mainly on supervised or unsupervised methods to learn representative patterns [11]. The most common ML-based algorithms are the naive Bayes, decision tree, support vector machine [12], random forest (RF) [13], and K-nearest neighbor (KNN) [14], Gaussian mixture model [15], and principal component analysis [16]. However, existing effective ML algorithms involve a small amount of input data because the utilizing a very large set of data for the ML method results in a time-consuming process. Moreover, the high-dimension and nonlinear characteristics of large-scale data make them unfit for use in ML methods to solve multiple classification tasks due to decreased performance. Hence, the feature selection utility, which is considered an important requirement of an ML algorithm to remove irrelevant features in the input data and improve the learning process, is inevitable [17].
Recently, deep learning (DL) models, such as long short-term memory, the convolutional neural network (CNN) [18], the deep convolutional generative adversarial network [19], and the deep long-short-term memory recurrent neural network [20], have been widely applied to IDS design. The evolution of the deep features through different layers makes DL capable of extracting a better representative feature subset, enabling better classification performance [21]. Obviously, one of the advantages of DL is that no feature selection requirement is needed. Nevertheless, existing publications show that deep features are learned more efficiently by the DL using a relevant feature subset selected by the feature selection algorithms from the original feature set (OFS) of the input dataset [22]. Clearly, two-layered feature extraction is employed in this strategy, which includes DL as the secondary feature extraction and classification method. Another efficient method to obtain better classification performance for DL in an IDS is the use of additional features, such as a probability score combined with the OFS [23] or an image reshaped from the OFS [24] as the input for different DL algorithms. Additionally, a DL and ML hybrid has been studied intensively in IDS design, in which the former is as the extractor for primary learning to extract a deep feature subset (DFS) from the OFS and the latter plays a secondary learning and classification role [2]. However, the use of DL must be accompanied with careful selection of the structure parameters to achieve an effective model in terms of detection performance improvement. Therefore, the optimization method is essentially necessary to infer a set of parameters for which an optimal DL structure is constructed.
Because (i) most previous studies do not follow a statistically valid process, which results in unreliable IDS application performance in a practical network environment, (ii) the CNN model, which has been carefully investigated and verified to be well-fitted for IDS application design [24], [25], has probably not been considered for IDS design in terms of optimal structure, and (iii) IDS classification performance is definitely improved with a feature subset selected by optimization algorithm-based feature selection, in this paper, a novel algorithm using an improved feature subset (IFS) and a CNN and bagging (BG) classifier hybrid algorithm is proposed for a NIDS. First, the IFS is formed as a combination of the features selected carefully by the genetic algorithm (GA) [26] in combination with a KNN fitness function [27] (F-GA) and additional features computed by the fuzzy C-means clustering (FCM) algorithm [28] (F-FCM) from the above F-GA. Second, the best CNN models are selected on the training data using the IFS as the input. Last, the ML classifiers using the DFS extracted by the selected CNN model as the extractor validate the classification performance using 5-fold cross validation (CV). The main contributions of this work are as follows:

•The quality improvement of the deep feature subset, which is then used as the input of the BG classifier, is implemented by three-layered feature construction, consisting of the GA to select the F-GA, FCM to calculate an improved F-FCM, and the CNN model for DFS extraction.•GA-based optimization method is applied for selection of the most effective CNN structure, which is considered as the deep feature extractor.•The reliably statistical performance results of various ML and DL models are computed with the 5-folds CV procedure to propose the most productive model for the NIDS.
Obviously, the existing studies consider one-layer feature construction including either the feature set selected by the ML [29], [30], [31] or the deep features extracted by the DL [23], [24]. Moreover, two-layered feature construction using the DL [22], [32], [33], [34] or hybrid algorithms of the DL and ML [2], [11], [35], [36] are also implemented in various publications. Compared with previous works, we apply a three-layered feature construction to obtain a DFS with better quality in terms of final classification performance. Indeed, the GA is used for careful selection of the most informative features from the original feature set, which is then reinforced by adding more features calculated by the FCM. This combined feature set, known as IFS, is used as the input of the CNN model for deep feature extraction. Clearly, individual structures of the CNN model produce the DFS with different quality, which show a large impact on the ML classification performance. Furthermore, the GA can blend with DNA cryptography and DL to provide a stronger security measurement and services [37]. Therefore, the GA and 5-folds CV procedure are adopted for selection of the most effective structure of the CNN model as the feature extractor and the ML classifier. The validation performance results imply that the GA is efficient for the CNN structure selection and the proposed NIDS is reliable for practical environment applications.
The rest of the paper is organized as follows: Background explanations for the intrusion problem are described in Section 2, followed by the related work in Section 3. The descriptions of the proposed method are given in Section 4, while Section 5 discusses the evaluation of the method. Sections 6 Discussion, 7 Conclusion present the discussion and conclusion of this study, respectively.
