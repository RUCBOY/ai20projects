With the rapid development and deployment of intelligent transportation systems (ITS), a huge amount of traffic information is gathered by a traffic flow prediction (TFP) module, which provides real-time traffic analysis to estimate future states based on the historical traffic data collected from various sensors, including radars, mobile phones, cameras, etc. As an essential component of ITS, TFP is helpful in supporting traffic control departments and traffic policies to allocate road resources, alleviate traffic congestion, and improve traffic efficiency, ultimately achieving transportation management and guaranteeing driving safety [1]. At present, deep learning has been widely applied for TFP to learn generic traffic flow features and improve prediction performance. However, deep learning algorithms generally require vehicles to transmit raw data containing sensitive information (e.g., location) to a central server to train the proposed deep learning models in a centralized fashion [2], [3], [4], [5]. If the central server is compromised, the entire TFP system suffers from a typical single-point-of-failure attack, and this may easily result in severe privacy loss for the vehicles.
To resolve the problem, we propose a federated learning (FL)-based TFP method. As introduced by [6], FL is a new machine learning paradigm that encourages participants to collaboratively train a globally shared model released by the central server. In each iteration of the global model training, each participant receives an initial global model, performs local model training, and submits local model updates (i.e., gradient parameters) to the central server without uploading the raw data. After that, the central server aggregates all the local model updates to obtain a new global model, and then releases the model. The above process of global model training continues iteratively until convergence. The application of FL can effectively remove privacy threats for vehicles by performing TFP tasks locally. However, conventional FL depends greatly on the central server, which collects and manages the local model updates, thus the security vulnerability to a single point of failure cannot be avoided [7]. Furthermore, if malicious vehicles upload false or low-quality local model updates to the central server, the convergence performance of the algorithm degrades, and this further influences the results of the TFP system, ultimately affecting the traffic control decisions of the traffic management department or the traffic police. Therefore, a considerate FL framework is strictly required to ensure the accuracy and reliability of the algorithm [8], [9], such that the application performance of FL in the TFP system is enhanced to promote traffic management and policy enforcement for ITS.
To cope with these challenges, we focus on blockchain and further study a combination of blockchain and FL to enhance the entire TFP system with security and privacy protection. As a decentralized and distributed public ledger technology, blockchain adopts consensus mechanisms to synchronize the changes in P2P networks, without dependence on any centralized entities or third parties. Due to the remarkable features of decentralization, unalterability, traceability, and anonymity, blockchain has been widely applied in a variety of domains [10], [11]. We were motivated to utilize the technology for secure and efficient implementation of FL in TFP by verifying local model updates and removing unreliable ones from malicious vehicles. At the same time, we considered the decentralized blockchain instead of the central server to record and manage all the local model updates and tackle the single-point-of-failure problem.
In this study, we integrate FL and blockchain into the TFP system for high-level privacy protection. More specifically, we introduce the application of FL for TFP by applying a lightweight yet efficient neural network model from [12] called GRU to process time series traffic data and construct a consortium blockchain for the decentralized FL-based TFP system. A consortium blockchain is exploited to employ a limited number of pre-selected miners to maintain the distributed ledger. Compared with the public and private blockchain technologies, consortium blockchain is widely accepted due to its moderate management overhead, remarkable network scalability, and lower consensus latency. We investigate potential security threats from the viewpoints of the central server and vehicles participating in FL, respectively. To protect against these security threats, we implement the entire FL procedure within a consortium blockchain-based framework and particularly describe the consensus process by using delegated Practical Byzantine Fault Tolerance (dBFT). Furthermore, we leverage the local differential privacy technology with a noise-adding mechanism to strengthen location privacy protection for participating vehicles that need to share their locations with other vehicles during vehicular communications. Finally, extensive numerical experiments based on real datasets are performed to demonstrate the effectiveness and efficiency of our proposed scheme, which is helpful to traffic management departments and traffic police in making correct traffic control decisions.
The main contributions of this paper are summarized as follows:

•We revise the GRU neural network to successfully present an FL-based TFP method. In this method, the participating vehicles use their data to perform local model training and share local model updates instead of directly transmitting individual data, thereby preserving privacy.•We exploit the consortium blockchain to promote the application of FL for TFP in a decentralized manner. The local model updates submitted by participating vehicles are validated, with the central server replaced by a set of trusted consensus nodes to manage all the local model updates. Consequently, the security risks of FL on the central server and participants’ sides are prevented.•We apply the local differential privacy technique to provide location privacy protection for participating vehicles. When a participating vehicle uploads its local model update, considerable Gaussian noise is added to disturb the location information and finally prevent lawbreakers from collecting information from participants using a membership inference attack.
The remainder of this paper is organized as follows: Section 2 presents the related literature. Section 3 describes the FL based on GRU for TFP. Section 4 introduces the consortium blockchain for FL-based TFP and the consensus algorithm design for the consortium blockchain is proposed in Section 5. In Section 6, a local differential privacy technique is applied for privacy-preserving vehicular communications in TFP. A performance evaluation based on real datasets is chosen as the study case to demonstrate the proposed framework in Section 7. Finally, some conclusions and future works are presented in Section 8.
