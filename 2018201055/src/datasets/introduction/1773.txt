An integer sequence (e1,e2,…,en) is an inversion sequence of length n if 0 ≤ ei < i for all 1 ≤ i ≤ n. The set of inversion sequences of length n, denoted by In, serves as various kinds of codings for Sn, the set of all permutations of [n]:={1,2,…,n}. By a coding of Sn, we mean a bijection from Sn to In. The most famous one is the so-called Lehmer code of permutations and many other different codings with interesting applications have been constructed in the literature; see [3], [17], [20], [22], [27] for more informations.
Pattern avoidance in permutations and words has connections with computer sciences, mathematical biology, theoretical physics and pure mathematics (see the book survey by Kitaev [19]). The enumerative aspect of permutation patterns has already been extensively studied in the last two decades, while the systematic study of patterns in inversion sequences was initiated only recently in [15], [25], where inversion sequences avoiding patterns of length 3 are exploited. Martinez and Savage [27] further considered a generalization of length-3 patterns in inversion sequences to patterns of relation triples. Recently, Auli and Elizalde [1] reported their study of consecutive patterns in inversion sequences.
Motivated by the above works and Claesson’s study of generalized patterns in permutations [14], we investigate inversion sequences avoiding vincular patterns of length 3, where two of the three letters are required to be adjacent. This theme will also be carried out for ascent sequences, which form an important subset of inversion sequences and were used by Bousquet-Mélou et al. [8] to encode (2+2)-free posets.
Recall that an ascent sequence (e1,e2,…,en) is an inversion sequence satisfyingei≤asc(e1,e2,…,ei−1)+1for all 1 < i ≤ n, where asc(e1,e2,…,ei−1) is the number of ascents in the prefix (e1,e2,…,ei−1), that is, the number of indices 1≤j<i−1 such that ej<ej+1. The set of ascent sequences of length n, denoted An, has cardinality Fn, the nth Fishburn number (see A022493 in the OEIS [28]) which appears as the coefficient of tn in the following beautiful formal power series∑m≥1∏i=1m(1−(1−t)i)=t+2t2+5t3+15t4+53t5+217t6+1014t7+⋯.The study of pattern avoidance in ascent sequences was initiated by Duncan and Steingrímsson [16] in 2011 and continued by several other researchers in [4], [13], [26], [29], [30]. Nevertheless, none of them has considered the vincular patterns in ascent sequences.
This paper is the first systematic studies of inversion/ascent sequences avoiding vincular patterns of length 3. The study turns out to be unexpectedly fruitful and many interesting integer sequences with or without combinatorial interpretations arise naturally in this framework, including Bell numbers, Bell-like numbers, Fishburn numbers, Semi-Baxter numbers, Powered Catalan numbers and the number of 3-noncrossing partitions. The enumeration results of avoidance classes are summarized in Table 1 for inversion sequences and in Table 2 for ascent sequences. Some more refined results or conjectures will also be presented throughout the paper.Table 1. Enumeration of inversion sequences avoiding vincular patterns of length 3. Those marked as “?” are counted by unknown integer sequences, whose first 7 terms are provided.Pattern pan=|In(p)| counted by:Solved?in OEIS?a8, equiv class012Bell numbersYes (Section 2.3)A0001104140,A021Bell-like numbersYes (Section 2.4)A09176811708102? (1,2,6,22,92,425,2124,…)OpenNew11317120? (1,2,6,23,104,532,2997,…)OpenNew18248201? (1,2,6,24,118,680,4460,…)OpenNew32634,A210? (1,2,6,24,118,680,4460,…)OpenNew32634,B000? (1,2,5,18,81,446,2897,…)OpenNew217080012n−1yes (Section 2.1)A000079128,A010? (1,2,5,15,53,216,996,…)OpenNew5117011an+1=nan+an−1, a1=1,a2=2Yes (Section 2.2)A10203816937100? (1,2,6,23,109,616,4058,…)OpenNew30587101? (1,2,6,23,107,584,3655,…)OpenNew25790,A110? (1,2,6,23,107,584,3655,…)OpenNew25790,B012? (1,2,5,13,35,99,296,…)OpenNew935021Semi-Baxter numbersYes (Section 2.6)A11710617734102? (1,2,6,22,90,398,1877,…)OpenNew9361120Powered Catalan numbersYes (Section 2.7)A11322720577201? (1,2,6,24,118,676,4356,…)OpenNew30816210? (1,2,6,24,118,676,4362,…)OpenNew31012000? (1,2,5,17,72,371,2259,…)openNew15918001? (1,2,4,11,39,178,1002,…)OpenNew6709010Fishburn numbersYes (Section 2.5)A0224935335,A011Fishburn numbersYes (Section 2.5)A0224935335,B100? (1,2,6,23,106,567,3440,…)OpenNew23286,A101? (1,2,6,23,106,567,3440,…)OpenNew23286,B110? (1,2,6,23,107,586,3706,…)OpenNew26683Table 2. Enumeration of ascent sequences avoiding vincular patterns of length 3. Those marked as “?” are counted by unknown integer sequences, whose first 7 terms are provided.Pattern pbn=|An(p)| counted by:solved?in OEIS?b8, equiv class012? (1,2,4,9,22,58,164,…)OpenNew494021Nexus numbers: |Sn(3¯1¯524)|Yes (Section 3.3)A0479702048102|Sn(σ,τ)|, where σ=(123,{2},∅) andNoA2495621921τ=(123,∅,{1}) are bivincular patterns120? (1,2,5,14,43,143,509,…)OpenNew1920201? (1,2,5,15,52,203,876,…)OpenNew4121210? (1,2,5,15,52,204,893,…)openNew4313000? (1,2,4,11,35,133,585,…)OpenNew2933,A0012n−1Yes (Section 3.1)A000079128,B0102n−1Yes (Section 3.1)A000079128,C011? (1,2,4,10,30,108,456,…)OpenNew2214100? (1,2,5,14,46,175,765,…)OpenNew3793101Triangular binomial coefficientsYes (Section 3.2)A0985691936,A110? (1,2,5,14,44,155,610,…)OpenNew26670122n−1Yes (Section 3.1)A000079128,D0213-noncrossing partitions of [n]Yes (Section 3.5)A1083043930,A102? (1,2,5,14,42,133,442,…)OpenNew1536120Triangular binomial coefficientsNoA0985691936,B2013-noncrossing partitions of [n]Yes (Section 3.5)A1083043930,B210Bell numbersYes (Section 3.4)A0001104140,B000? (1,2,4,11,35,133,585,…)OpenNew2933,B001? (1,2,4,10,30,107,447,…)OpenNew21480102n−1Yes (Section 3.1)A000079128,E0112n−1Yes (Section 3.1)A000079128,F100? (1,2,5,14,44,154,596,…)OpenNew2532101? (1,2,5,14,43,144,525,…)OpenNew2082110? (1,2,5,14,45,166,701,…)OpenNew3362
In the rest of this section, we will fix the notations and terminologies of vincular patterns in words, introduce some statistics on permutations and inversion sequences and recall two encodings of permutations by inversion sequences that will be repeatedly used in our proofs.
1.1. Patterns and vincular patterns in wordsWe view permutations and inversion sequences as words over N. A word W=w1w2⋯wn is said to contain an occurrence of a word (or pattern) P=p1p2⋯pk (k ≤ n) if there exists i1 < i2 < ⋅⋅⋅ < ik such that the subword wi1wi2⋯wik of W is order isomorphic to P. In addition, if some consecutive letters in a pattern P are underlined, then we further require an occurrence of P whose letters corresponding to these underlined letters must be adjacent in W. Such generalized patterns were introduced by Babson and Steingrímsson [2] and are nowadays known as vincular patterns. If a word W does not contain an occurrence of a vincular pattern P, then W is said to avoid the pattern P. For example, the word W=12421 contains the pattern 231, because the subword w2w3w5=241 of W has the same relative order as 231. However, W is 231-avoiding.For a set W of words, the set of words in W avoiding generalized patterns P1,…,Pr is denoted by W(P1,…,Pr).
1.2. Statistics on permutations and inversion sequencesLet π=π1π2⋯πn∈Sn be a permutation. The number of descents of π, des(π), is defined bydes(π)=|{i∈[n−1]:πi>πi+1}|and the number of inverse descents of π is ides(π):=des(π−1). The number of left-to-right maxima of π islmax(π):=|{i∈[n]:πi>πjforall1≤j<i}|.Similarly, we define the number of left-to-right minima lmin(π), the number of right-to-left maxima rmax(π) and the number of right-to-left minima rmin(π).For an inversion sequence e=(e1,e2,…,en)∈In, several statistics concerned in this paper are introduced as•asc(e)=|{i∈[n−1]:ei<ei+1}|, the number of ascents of e;•dist(e)=|{e1,e2,…,en}∖{0}|, the number of distinct positive entries of e;•rmin(e)=|{i∈[n]:ei<ejforallj>i}|, the number of right-to-left minima of e;•zero(e)=|{i∈[n]:ei=0}|, the number of zero entries in e;•satu(e)=|{i∈[n]:ei=i−1}|, the number of saturated entries of e;•last(e)=en, the last entry of e.It is known [3], [18], [22] that on inversion sequences or ascent sequences the first two statistics “asc” and “dist” are Eulerian, while the next three statistics “rmin”, “zero” and “satu” are Stirling.
1.3. Encodings of permutations by inversion sequencesTwo encodings of permutations by inversion sequences will be used in this paper. The first one is the invcode of permutations defined for π=π1π2⋯πn∈Sn byΘ(π)=(e1,e2,…,en),whereei:=|{j:j<iandπj>πi}|.The following property of invcode is folkloric in enumerative combinatorics.Theorem 1.1The invcode Θ:Sn→In is a bijection such that for any π∈Sn,(des,lmin,lmax,rmax)π=(asc,satu,zero,rmin)Θ(π).The invcode has already been applied in the study of inversion sequences avoiding triples of relations in [27].The second coding we need is a recent bijection b:Sn→In due to Baril and Vajnovszki [3] that we outlined below. An interval I=[p,q], p ≤ q, is the set of integers {x: p ≤ x ≤ q}; and a labeled interval is a pair (I, ℓ) where I is an interval and ℓ is an integer. For a permutation π=π1π2…πn∈Sn and an integer i, 0 ≤ i < n, the ith slice of π is a sequence of labeled intervals Ui(π)=(I1,ℓ1),(I2,ℓ2),…,(Ik,ℓk) constructed recursively by the following procedure.Set U0(π)=([0,n],0). Assume that Ui−1(π)=(I1,ℓ1),(I2,ℓ2),…,(Ik,ℓk) has been defined for some 1 ≤ i < n and πi ∈ Iv. Below is a procedure to determine Ui(π) from Ui−1(π) according to four possible cases:•If min(Iv) < πi < max(Iv), then Ui(π) equals(I1,ℓ1),…,(Iv−1,ℓv−1),(H,ℓv),(J,ℓv+1),(Iv+1,ℓv+2),…,(Ik−1,ℓk),(Ik,ℓk+1),where H=[πi+1,max(Iv)] and J=[min(Iv),πi−1].•If min(Iv)<πi=max(Iv), then Ui(π) equals(I1,ℓ1),…,(Iv−1,ℓv−1),(J,ℓv+1),(Iv+1,ℓv+2),…,(Ik−1,ℓk),(Ik,ℓk+1),where J=[min(Iv),πi−1].•If min(Iv)=πi<max(Iv), then Ui(π) equals(I1,ℓ1),…,(Iv−1,ℓv−1),(H,ℓv)(Iv+1,ℓv+1),…,(Ik−1,ℓk−1),(Ik,ℓk+1),where H=[πi+1,max(Iv)].•If min(Iv)=πi=max(Iv), then Ui(π) equals(I1,ℓ1),…,(Iv−1,ℓv−1),(Iv+1,ℓv+1),…,(Ik−1,ℓk−1),(Ik,ℓk+1).Now the permutation code b(π)=(b1,b2,…,bn) is defined by letting bi=ℓv such that (Iv, ℓv) is a labeled interval in the (i−1)th slice of π with πi ∈ Iv.Example 1.2Let π=61832547. The process described above gives the slices below.U0(π)=([0,8],0)U1(π)=([7,8],0)([0,5],1)U2(π)=([7,8],0)([2,5],1)([0,0],2)U3(π)=([7,7],1)([2,5],2)([0,0],3)U4(π)=([7,7],1)([4,5],2)([2,2],3)([0,0],4)U5(π)=([7,7],1)([4,5],2)([0,0],5)U6(π)=([7,7],1)([4,4],5)([0,0],6)U7(π)=([7,7],1)([0,0],7)Thus, we have b(π)=(0,1,0,2,3,2,5,1).The permutation code b has the following nice property.Theorem 1.3 Baril and Vajnovszki [3]The code b:Sn→In is a bijection such that for any π∈Sn,(des,ides,lmin,lmax,rmax)π=(asc,dist,satu,zero,rmin)b(π).The permutation code b turns out to be useful in the study of vincular patterns in inversion sequences.
