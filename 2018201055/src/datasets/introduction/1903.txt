According to the Global Health Organization, colorectal cancer is the third most frequent type of cancer with 1.8 million people diagnosed in 2018 (Siegel et al., 2019). The early detection of cancer, when it is still small and has not spread, is essential for the treatment and the survival of the patient. The detection and removal of intestinal polyps, an abnormal growth of the tissue that can evolve into cancer, is specially important. According to the American Cancer Society, screening tests of the gastrointestinal (GI) tract have significantly increased the survival rate of colorectal cancer patients.1
The standard clinical procedure for the screening of the rectum and the colon is a colonoscopy. Despite the fact that this procedure is widely accepted, it has some important drawbacks: it requires qualified personnel in expensive medical facilities and may result in patient discomfort.
Wireless Capsule Endoscopy (WCE), originally developed by Iddan et al. (2000), is an alternative technique designed to visualize the inside of the digestive tract with minimal patient discomfort. Patients ingest a vitamin-size capsule that contains a camera and an array of LEDs powered by a battery, to record and send the captured images to an external device for a posterior analysis.
WCE has become a solution to the rapid increase in demand for optical endoscopies in recent years (Li and Leung, 2018), as it can deliver GI investigations without the need for expensive clinical resources and much improved patient comfort. It has been reported report that this device can accurately evaluate pathologies such as gastrointestinal bleeding (Usman et al., 2016, Jia and Meng, 2016, Zwinger et al., 2019), Crohn's disease (Goran et al., 2018), ulcerative colitis (Ozawa et al., 2019, Maeda et al., 2019), small-bowel tumors, polyposis syndrome (Byrne and Donnellan, 2019, Yang, 2020) and is also applicable in polyp detection (Kobaek-Larsen et al., 2018). Furthermore, recent studies (McGoran et al., 2019, Takada et al., 2020) foresee WCE as a tool to not only investigate the symptoms of GI disorders but also, in the future, to perform therapeutic interventions. The capsule could also democratize the screening process since it is better tolerated than standard endoscopy (McGoran et al., 2019), has minimal invasiveness with user-friendliness (Vasilakakis et al., 2019), does not require sedation and has fewer potential complications.
Although WCE presents many advantages over other screening techniques, it presents an important drawback in clinical practice: resulting videos can contain hundreds of thousands of images per patient that must be screened by clinical specialists. This screening is complex, tedious and time-consuming, often lasting 2–3 h per video (Vasilakakis et al., 2019, Yang, 2020). Moreover, and also because of the fatigue caused by the visual inspection of these videos, it is common to review procedures more than once to ensure that no pathological images are missed (Byrne and Donnellan, 2019). All these inconveniences hinder the adoption of WCE, exposing the need of computer-aided decision (CAD) support systems (El Ansari and Charfi, 2017, Rahim et al., 2020) with artificial intelligence (McGoran et al., 2019, Hwang et al., 2018, Yang, 2020).
In the literature, we can find several AI-based CAD systems specially designed to detect suspicious or abnormal WCE images. Most of these methods are aimed at reducing visualization and diagnosis time by detecting specific GI events with high performance machine learning systems (Takada et al., 2020).
With regard to the specific goal of polyp detection, most of the published systems have been reported and validated as automatic detection methods. However, because of legal and practical reasons, these systems cannot be used for automatic diagnosis and can only be deployed as decision support systems which filter the whole set of frames to allocate physician's attention to those images that show potential polyp structures. In most cases, this is a needle-in-haystack problem because of the occasional appearance of images with these pathologies. Fig. 1 shows two sequences from different procedures where a polyp is observed. It is important to point out that, in both procedures, those are the only images of the whole procedure where a polyp is visible. Fig. 2 shows some random images from the same procedures.Download : Download high-res image (475KB)Download : Download full-size imageFig. 1. Illustration of two polyp sequences extracted from different patients. In the first sequence can be seen how the polyp appears in all the frames approximately in the same location. However, in the second sequence, the polyp location change while the WCE moves through the GI tract.Download : Download high-res image (530KB)Download : Download full-size imageFig. 2. Illustration of 16 random samples obtained from the same procedures that represent the huge diversity of the dataset. For example, some of the frames present turbid, GI walls or wrinkles among others.
Polyp detection has been an active research topic, as it can be seen in Table 2. However, to our knowledge, there is no agreement about a common evaluation methodology to allow the community to compare different CAD methods. Most of these methods have been developed and evaluated with private datasets and using different evaluation methodologies, which are suited for image detection systems but not fully informative for CAD systems in medical applications.
In this paper, we propose and validate a CAD system for the detection of polyps in WCE videos. The proposed system is based on deep Convolution Neural Networks (CNN). It is well known that CNNs have become state-of-art in many visual recognition problems, but their application in the medical field has been rather limited, with some exceptions like dermatology and breast X-rays. The main reason for this is that medical databases are comparably poor and small due to the high costs involved in data acquisition, their complex labelling, and because the use of these data often involves confidentiality issues (Akay and Hess, 2019).
Small size and imbalanced data are two of the main obstacles to develop reliable deep learning classifiers, because if not properly addressed, they may lead to training overfitting and poor generalization. Several tricks and techniques, such as dropout (Srivastava et al., 2014), sampling strategies (Katharopoulos and Fleuret, 2018), image augmentation (Mikołajczyk and Grochowski, 2018) and curriculum learning (Taghanaki et al., 2019), try to alleviate this problem, but it is still an open and important challenge in the medical field as described in Akay and Hess (2019). To this aim, and to overcome the small amount of available data for training the CNN, in this paper we propose an optimization strategy based on deep metric learning that uses the Triplet Loss function (Schroff et al., 2015). The obtained results show that this learning strategy outperforms the classical learning strategy using the cross-entropy loss function in our problem.
Our contributions are as follows:
•We propose an evaluation methodology that involves quantitative metrics as well as the reporting of qualitative database information in order to allow fair comparisons between different systems.•We show how to build an end-to-end CNN polyp detection system, based on the Triplet Loss function, that overcomes the problem of imbalanced datasets.•Finally, we propose the use of classifier interpretation techniques as a mechanism to build trust in the system.
The paper is organized as follows: first, we give an overview of the related work in the field. This is followed by a description of our methodology, presenting the system architecture, parameter optimization and evaluation methodology, followed by experimentally setup and results. Finally, we conclude the paper and give directions for future work.
