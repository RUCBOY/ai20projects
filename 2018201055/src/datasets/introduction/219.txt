Advanced 3D imaging technologies, including X-ray micro-computed tomography (Micro-CT) [1], magnetic resonance imaging (MRI) [2], optical coherence tomography (OCT) [3] and confocal laser scanning microscopy (CLSM) [4], provide revolutionary tools to explore the internal structure of heterogeneous materials in a non-destructive way. Combination of these techniques and digital volume correlation (DVC) remarkably promotes the accurate and quantitative study on the evolution of internal structure[5], [6], [7], [8]. The basic principle of DVC is similar to its well-known two-dimensional counterpart, i.e. digital image correlation (DIC), which traces the motion of point of interest (POI) centered subsets within the images acquired before and after deformation. Since Bay et al. proposed the first DVC algorithm in 1999 [9], this technique has found rapidly growing applications in the measurement of deformation or strain fields inside artificial and natural materials, such as metal and polymer foams [10], [11], bones [12], [13], rocks [14], [15], batteries [16], [17], and soft gels [18], [19].
The development of DVC borrows many algorithms and strategies from DIC. For example, the Newton-Raphson algorithm [20] and the inverse compositional Gauss-Newton (IC-GN) algorithm [21], which are current mainstream iterative DIC algorithms for sub-pixel registration, were extended from 2D case dealing with six-component deformation vector (p=[u,ux,uy,v,vx,vy]T) to 3D case with twelve-component deformation vector (p=[u,ux,uy,uz,v,vx,vy,vz,w,wx,wy,wz]T) [19], [22]. The fast Fourier transform-based cross correlation (FFT-CC) was introduced to estimate the integer-voxel displacement at POIs efficiently, which was fed as the initial guess to the iterative DVC algorithms in path-independent processing strategy [19], [23], [24], [25].
The differences between DVC and DIC bring new challenges to the methodological study of DVC. One of the main difficulties is the measurement of large and complex internal deformation. In this situation, de-correlation is prone to occur, and registration algorithms may fail to locate the corresponding sub-volumes in the volume image obtained before deformation (reference) and the one after deformation (target). This problem can be tackled easily in DIC by resolving the large and complex deformation into a series of small and simple deformation, through the application of high-speed cameras. However, the issue becomes much harder in DVC because the generation process of volume images (usually including scanning and reconstruction) are time-consuming. It generally takes minutes in micro-CT or seconds in CLSM to get a volume image with sufficiently high resolution and accuracy. A compromising solution for DVC to evaluate the internal deformation within the materials subjected to large deformation is called incremental processing strategy [26], [27], [28], in which the deformation of specimen is controlled in a stepped manner, accompanied with in-situ scan. The de-correlation can be circumvented by renewing the reference volume image during the processing of the series. To enhance the accuracy and efficiency of this method, adaptive sub-volume offset is introduced to avoid calculating the intensity within sub-volumes at sub-voxel positions in the renewed reference volume image through interpolation [28]. It is noteworthy that the incremental processing strategy works well to the quasi-static tests but becomes impractical to the dynamic tests, e.g. the impact test of metal foams [29]. During the impact, large and inhomogeneous internal deformation is imposed to the foams at high strain rate, and the intermediate volume images between the reference and the target are hard to obtain.
The image feature extraction and matching techniques, fortunately, shed a light on the solution of this formidable issue without manual intervention to the processing. The image features extracted using the scale-invariant feature transform (SIFT) are found robust to the large translation, rotation, shear and scaling of the objects in image [30], [31]. By matching the features in the reference image and the target image, deformation of the POIs near the features can be estimated and used as initial guess for the iterative DIC algorithms [32], [33], [34], [35], [36]. Our preliminary study shows that the corresponding subsets in the reference image and the target image can be accurately located using SIFT aided initial guess estimation, even when the objects travels nearly across the view field accompanying with considerable deformation [37].
There is no public report about the SIFT aided DVC heretofore due to another challenge, i.e. extending SIFT from 2D case to 3D case. It took more than one decade for the image processing community to overcome this obstacle, as the construction of descriptor for 3D SIFT features is much more complicated. The effort on 3D SIFT can be traced back to 2007, when Cheung and Hamarneh attempted to develop n-dimensional SIFT [38]. The method showed encouraging effectiveness in the analysis of medical volume images obtained through MRI, CT and OCT [38], [39], [40]. Later in the same year, Scovanner et al. proposed a new 3D SIFT descriptor and checked its performance on the action recognition in videos [41]. The method was adopted by various groups to register the features in the volume images acquired using ultrasound [42], [43], CT [44] and MRI [45]. In the two pioneer approaches, difference-of-Gaussian (DoG) pyramids are built for the volume images, and then the local extrema are detected in these pyramids and regarded as the candidates of features. The two approaches reach the quantitative description of image features through different ways, but both suffer the issues of partial rotational invariance and anisotropic geometry of gradient histogram [46], [47], [48]. In 2D images, the features are assigned the most prominent local orientation(s) to achieve invariance to rotation of image. This operation can be done by establishing a histogram of intensity gradient and finding its peak [31]. However, the 3D orientation consists of at least three characteristic parameters (e.g. azimuth, elevation, and tilt angles), in contrast to a single parameter in 2D case. Researchers tried to determine the angles of dominant orientation one by one [46], [47], which still encounter the difficulties in correct and efficient quantization of orientation histogram. A sophisticated solution was given recently by Rister et al.[48], who estimate the dominant orientation of local features based on eigen-decomposition of the structure tensor and calculate the gradient histograms on the regular icosahedron to guarantee its isotropic geometry. The codes they released in an open-source manner (https://github.com/bbrister/SIFT3D) facilitate the further developments, including debug and application of their methods, which constitute one of the bases for this paper.
The computation efficiency of DVC is considered as another challenging issue [7], [8], [49], which may hinder its applications. Compared with DIC, the data to process proliferate in DVC due to the increase in dimension of both image and subset. For instance, the computation burden of DVC for a pair of 5123-voxel volume images using 333-voxel sub-volume could be scaled up for approximately three orders of magnitude, compared with that of DIC processing for a pair of 5122-pixel images using 332-pixel subset.
Acceleration of DVC can be attained via two ways:
(I)Optimization of algorithms and strategies. For instance, the calculation of zero-mean normalized cross-correlation (ZNCC) criterion for integer-voxel registration can be speed up by introducing fast Fourier transform [19], [23], [24], [25] or 3D sum-table [19]. The iterative sub-voxel registration was accelerated by replacing the classic Newton-Raphson algorithm with more efficient IC-GN algorithm [22], [25] or image deformation method [23]. Moreover, the cogitatively designed strategies, such as dynamic-expanding range search for initial guess estimation [50] and lay-wise reading and processing of volume images, also help elevate the efficiency of DVC and reduce the RAM required by data storage during the calculation [50], [51].(II)Exploitation of hardware resource, i.e. implementation of algorithm with parallel computing mechanisms. Multi-core CPU and GPU allow the threads running simultaneously, which leads to explosively increase in computation speed for DIC (from several times to orders of magnitude, depending on the simultaneous cores supported by the device) [52], [53], [54], [55], [56]. Multi-core CPU-based parallel computing can be readily applied to DIC and DVC, using the well-established programming libraries, e.g. OpenMP (https://www.openmp.org/) or MPI (https://software.intel.com/en-us/mpi-library). This kind of acceleration has been widely adopted by methodological researchers [50], [51] and appeared in commercial software (https://www.correlatedsolutions.com/vic-volume/). GPU-based parallel computing has demonstrated great superiority over its CPU-based counterpart [25], [56], but remains somewhat arduous to the developers of DIC and DVC methods, as the programming models for GPU device, e.g. CUDA (https://en.wikipedia.org/wiki/CUDA)or OpenCL (https://www.khronos.org/opencl/), are more complicated and have steeper learning curves. The earliest GPU-based acceleration of DVC was reported in 2012 by Leclerc et al.[57], who used GPU to solve the linear system containing millions of degrees of freedom in their global DVC method, and to reconstruct the key matrix and vector during the iterations in their modified global DVC method later [58]. Local DVC methods, most of them are iterative algorithms, have also benefited greatly from GPU-based parallel computing. Bar-Kochba et al.[23] found their iterative DVC algorithm with 323-voxel sub-volume can be 5.5× faster on GPU (Nvidia GTX 690) than the single thread implementation on CPU (Intel i7–3820). Gates et al.[24] proposed a design of hybrid parallel computing to speed up their DVC method combining FFT-CC algorithm and Broyden–Fletcher–Goldfarb–Shanno (BFGS) algorithm, in which GPUs estimate the normalized cross-correlation objective function and its gradient at POIs, while CPUs handle the BFGS iterations. The time consumed by the hybrid mode consisting of one GPU (Nvidia Tesla M2090) and one CPU (Intel X5660) is 8.7× less than that by the single CPU thread version (413-voxel sub-volume). A speed of 343 POI/s was achieved on a computation node equipped with three GPUs and two 6-core CPU. It is noteworthy that the hybrid parallel computing requires highly optimized parallelism of task and data,otherwise the potential of hardware could not be fully exploited. The similar computation efficiency can be reached on a single GPU with even weaker computation power. For example, our implementation combining FFT-CC algorithm and IC-GN algorithm achieved 444 POI/s (333-voxel sub-volume) on a low-end GPU (Nvidia GTX 680), 23.3× faster than the single CPU thread implementation (Intel E5–1650)[25].
The work presented in this paper is an extension of our previous study on image feature aided DIC and GPU accelerated DIC/DVC [25], [37], [55], [56]. A robust DVC method is proposed for the high accuracy measurement of large and complex deformation, in which 3D SIFT is employed to estimate the initial guess of deformation for the IC-GN algorithm at each POI. GPU-based implementation is developed to accelerate the time-consuming 3D SIFT aided initial guess estimation. The GPU accelerated IC-GN algorithm is also upgraded, replacing the tri-cubic interpolation with more accurate tri-cubic B-spline interpolation. The performance of the proposed 3D SIFT aided path-independent DVC (PiDVC) method is evaluated through a series of experiments using simulated examples and real test data. In addition, multi-core CPU-based implementation of the proposed DVC method is made for the comparison purpose.
