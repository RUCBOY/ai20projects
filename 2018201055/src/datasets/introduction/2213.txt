Due to recent advances in HPC technologies, it has become possible to simulate many complex phenomena. In materials science, the capability to perform first-principles calculations for systems containing several tens of thousands of atoms has led to analyzes of entire transistor devices in LSI.
To handle microscopic systems, such as transistor devices (Fig. 1), performing calculations that incorporate quantum mechanics effects are typically required. Electronic structure calculation based on the density functional theory (DFT) [1], [2] allows us to perform quantum-mechanical calculations (including correlation effects) with a relatively small computational burden [3]. With a pseudopotential DFT program, it is possible to perform structural optimizations and finite-temperature molecular dynamics simulations of large-scale systems with high accuracy. However, the number of atoms is limited by the available time and memory because the number of operations and memory requirements scale by three and two powers of the number of atoms, respectively. Currently, to deal with the important issues in semiconductor devices such as extended defects and interface reactions, there is a great demand of first-principles calculations for materials systems whose typical numbers of atoms are several-thousands atoms (or several tens of thousands atoms depending on the situation), although such calculations take a tremendously long time. On the other hands, contemporary supercomputers have been making rapid progress in massive parallelization, and as a result, the number of nodes equipped in such computers greatly exceeds the number of atoms included in a typical system of interest. Thus, realizing strong scaling to use efficiently such a large number of nodes is becoming critically important when developing a pseudopotential DFT program [4], [5], [6], [7], [8], [9].
In a DFT program, the maximum number of parallel processes will be limited by the number of atoms (bands) when decomposition is performed with respect to only the band (and/or k point). On the other hand, if decomposition is performed with respect only to the coefficients of the wavefunctions, the length of the inner-most loop will become short when a large number of processes is used, which would degrade performance. Furthermore, when plane waves are used, transpose operations originating from three-dimensional fast Fourier transformation (3D-FFT) occurs, which inevitably leads to frequent all-to-all communications.Download : Download high-res image (1MB)Download : Download full-size imageFig. 1. Schematic illustration of the structure of a typical SiC power device and three major issues to be improved: (1) threading dislocations (gray lines) in a SiC substrate, (2) formation of an oxide layer (oxidation process), and (3) electronic properties in the vicinity of the SiC/SiO2 interface region. Blue, yellow, and red balls in (2) and (3) denote Si, C, and O atoms, respectively . (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)
In its original 2007 version, the PHASE/0 program [10], which is the focus of this study, demonstrated high computational and parallel efficiency for up to 4096 processors (512 nodes) with decomposition with respect to the band and k point [11]. To increase the number of usable processes, we have developed a multi-axis decomposition scheme implemented in the PHASE/0 program [12], [13]. Our goal is to extend the number of usable processes to significantly exceed the number of atoms contained in a calculation system. The term “multi-axis” has two meanings, i.e., (i) decomposition with respect to the band, the k point, and the coefficients of the wavefunctions (3-axis parallelization), and (ii) decomposition with respect to two axes regarding 3D-FFTs, which transform wavefunctions from real- to reciprocal-space representation and vice versa. Note that the array of plane-wave coefficients for electron wavefunctions has two axes, i.e., band and G-vector axes, and the array can be decomposed along both axes, as shown in Fig. 2.
Decomposition (i) maintains sufficient lengths for the inner-most loops, i.e., G-loops in most cases, even when the number of processes greatly exceeds the number of atoms. Decomposition (ii) improves the parallel efficiency of the 3D-FFTs, whose elements are divided and mapped in node spaces for G-vectors. In each G-vector space, all-to-all communications regarding the 3D-FFT operations are performed efficiently by utilizing redundant connections in the K computer’s 6D torus network. This leads to compactly packed all-to-all communication, i.e., the decomposed processes are continuously placed in a node space.Download : Download high-res image (53KB)Download : Download full-size imageFig. 2. Decomposition of a wavefunction array (Ψ) along the two axes of bands (B) and G-vectors (G).
The remainder of this paper is organized as follows. In Section 2, we present the calculation procedure of the plane-wave DFT code PHASE/0 and explain the problematic O(N3) operations and communication that occurs with 3D-FFT operations that degrades parallel efficiency. In Section 3, we introduce the K computer and the revolutionary decomposition technique we adopted. We explain how we optimize communication by maximally utilizing the 6D mesh/torus network topology of the K computer. In Section 4, the performance of the adopted decomposition technique estimated from calculations for a wide-gap semiconductor SiC is presented. In Section 5, we present the calculated result for a defect structure in SiC as an example. Finally, in Section 6, we discuss the superiority of the multi-axis decomposition scheme as a programming method in a multi-dimensional direct network system and offer our expectations about future advances in computer systems.
