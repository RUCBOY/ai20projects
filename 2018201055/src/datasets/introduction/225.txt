More and more companies and individuals are migrating their data and computing to the cloud to take advantage of its use-on-demand feature [20], [24]. Unfortunately, this convenience comes at the price of losing control of data and computing environments, which leads to security incidents that limit the potentially widespread adoption and acceptance of cloud services [33], [36]. To meet rising concerns over security and privacy in the cloud, the security-on-demand service mode dynamically provides cloud customers with trusted computing environments according to their specific security needs [17].
Cloud customers’ security needs are various security attributes corresponding to different application environments, which are constraints or configurations related to security for both subjects and objects in cloud services. Typical security attributes include visitor identities, provider trust levels, operating system security, data center locations, and so on. The requirements of cloud customers’ security attributes constitute their security strategies. A secure computing environment is related to both trustworthy service providers and a secure, trusted cloud infrastructure. So far, no standardized, auditable, tamper-resistant trust-management mechanism exists in the cloud infrastructure for customers to assess service providers, virtual machines, and physical hosts.
However, the availability of secure computing platforms is only a necessary, not a sufficient, solution to convince cloud customers to move their sensitive data and code to the cloud [48]. Cloud customers tend to need further assurance to convince them that security measures are indeed deployed and are working correctly.
The advance of new cryptographic algorithms and mechanisms enable new solutions to this problem. The Oxford myTrustedCloud project [39] and policy-sealed data abstraction [34] have opened new ways to build trusted cloud services, for example. Attribute-based encryption (ABE) protects data and security policies with key-policy attribute-based encryption (KP-ABE) [47], ciphertext-policy attribute-based encryption (CP-ABE) [5], [13], [44], and attribute-based signatures (ABSs) [16], [26], [35]. Fully homomorphic encryption guarantees the privacy of data owners and supports multi-party computing [11], [23]. Blockchain technology is used in auditing, billing, data sharing, etc., in cloud security for its auditability, traceability, and non-repudiation [2], [22], [43]. So far, however, it remains an open issue for scholars and developers to explore.
To sum up, major challenges remain to achieve the goal of security on demand: (1) integrating an auditable, tamper-resistant trust-management mechanism into the cloud infrastructure and (2) building a protocol to guarantee the consistency of customers’ policies during virtual machine (VM) migrations.
In this paper, we introduce blockchain technology and ABSs to our former work on remote attestation with ABE in [13] and present an ABS- and blockchain-based policy-customized trusted cloud service (PC-TCS) architecture, as ABS is superior to KP-ABE and CP-ABE for its anonymous, untraceable nature that better fits cloud computing. Cloud customers can customize the security policies of computing environments by validating whether they meet security policies with ABS and auditing cloud service providers’ actions and reputations by auditing actions with blockchain technology throughout the VM life-cycle in PC-TCS, which focuses on the following three aspects:

•Availability—cloud customers can customize the security policies of computing environments, and cloud providers can partition and configure VMs and physical servers on different security levels. Cloud customers can customize and enforce the security attributes of computing environments, such as the central processing unit (CPU), memory, disk, service provider trust level, operating system security, data center location, etc., with the support of the trusted cloud infrastructure.•Trustworthiness–cloud customer can validate whether the current computing environment meets the custom security policy. An auditable and tamper-resistant trust management mechanism is required in cloud infrastructure. Meanwhile, the privacy of both sides should be considered, the specific configuration or attributes of cloud platform could never be over exposed in the attestation stage.•Consistency— VM-migration operations meet customer’ security policies. Unlike physical machines, VMs may migrate among physical nodes, changing both physical hosts and VMs and possibly destroying the security attributes of computing environments. Therefore, guaranteeing the consistency of customers’ policies during VM migrations requires a trustworthy VM migration protocol.
To achieve the first goal, we introduce a customized security policy to PC-CTS to connect users’ security expectations to the security attributes of cloud services. PC-TCS adds interfaces to customize security policies for cloud customers. It supports matching security policies with VMs and deployment based on security policies by improving VM schedulers. ABSs enhance the remote-attestation mechanism, the core of trusted computing technology [27], to become an effective scheme to integrate the trusted computing mechanism into cloud-computing architecture to provide cloud customers the capability to remotely attest to the trustworthiness of cloud services [34], [39]. They also reduce the information leak in the current remote-attestation mechanisms, such as platform-configuration information and attribute information. To achieve the second goal, we introduce ABSs and blockchain mechanisms to the remote-attestation field so customers can assess the trustworthiness of cloud services by validating the attribute signatures of computing environments. Meanwhile, all customers’ security policies and service providers’ actions are audited on the blockchain for its lifetime so a reputation system can be built on it. The information that customers can acquire in the attestation phase, however, is only whether the security attributes of current computing environments meet their custom security policies. VMs migrate when custom security policies or the security attributes of physical nodes change or because of load balancing. VM-migration operations are transparent to customers, especially live migration. Cloud administrators carry out existing VM-migration attestation, so its trustworthiness cannot meet customers’ requirements. To achieve the third goal, we present a VM-migration protocol that supports customized migration policy and migration attestation. To prove the availability of PC-TCS architecture, we designed and implemented a prototype that supports a customized security policy and a VM-migration protocol that supports a customized migration policy and validation based on the open-source Xen Hypervisor. We experimentally evaluated the migration latency, the results of which suggest that the attestation scheme does not obviously degrade VM-migration performance while maintaining customers’ security requirements.
The primary contributions of this paper are the following:

•A PC-TCS architecture that supports a customized security policy and remote attestation;•A remote-attestation scheme that supports the customized security policy;•A VM-migration protocol that supports a customized migration policy;•A prototype implementation of the remote attestation and VM-migration protocol in the open-source Xen Hypervisor.
Our implementation and experimental results indicate that (1) PC-TCS can be integrated into cloud infrastructure as part of a trusted computing base; (2) cloud users can customize the security policies of computing environments and validate their enforcement throughout the service life-cycle with the support of PC-TCS; and (3) PC-TCS can support policy-customized remote attestation and policy-customized migration with a minimal impact on performance.
The rest of the paper is organized as follows. Section 2 reviews the background of remote attestation and ABS. Section 3 describes PC-TCS architecture. Section 4 describes the implementation of the PC-TCS architecture. Section 5 presents the security and preliminary performance. Finally, Section 6 concludes and indicates key areas for future research.
