Today, smart city construction with the Internet of Things (IoT) as its core has attracted widespread attention from the academic and industrial communities. Smart cities are supported by a new generation of mobile information technology represented by the Internet of Things, cloud computing, etc., and realize the technology fusion of comprehensive perception, distributed interconnection and pervasive computing. In this model, one particular ongoing research focus is on ensuring the security of the sensor network used in an IoT setting. At the same time, as an important part of smart cities, the security of distributed clean energy networks has received widespread attention from industry and scholars. Energy Internet system is operated with the Internet of Things (IoT) equipment as the information sensing module and through wireless sensor network (WSN) technology, which has also made a significant contribution to the construction of smart cities.
In the energy system, the traditional centralized energy production and sales model has encountered many challenges and bottlenecks, such as the problems of low efficiency, weak reliability, and vulnerability to single-point attacks, which have become increasingly prominent. Therefore, the concept of Energy Internet has been developing rapidly and has occupied a dominant position in energy revolution. Energy Internet takes advantages of advanced power electronics, modern information technology, and intelligent management technology to build a vast energy network consisting of distributed energy harvesting devices, distributed energy storage devices and various types of consumer devices. The illustration of the energy Internet is shown in Fig. 1. Especially in the context of smart cities, the security and reliability of the Energy Internet is critical.
To better support the Energy Internet, blockchain technology has been employed in place of the traditional centralized transaction mode due to its technological advantages such as openness, autonomy, non-tamperability and resistance to single-point attacks. However, blockchain-based trading models often lack the protection of user privacy. While the blockchain enables public auditing and traceability of transaction data, it also exposes the privacy information of both parties, which obviously does not meet the actual needs for privacy protection. To deal with this issue, some research attempts to indirectly protect privacy by hiding the data on the blockchain and the connections between users. For example, in [13], the identity information is protected by randomly assigning an anonymous address each time. There are also schemes that use cryptographic primitives to protect data privacy. In [19], Sun et al. combined differential privacy with blockchain to protect the electrical data used in smart meters. Others combine the traditional privacy protection schemes with the blockchain. For example, [1] applies a multi-party computing-based aggregation technique to the blockchain, allowing power suppliers to calculate consumer bills without having to know their power consumption data.Download : Download high-res image (231KB)Download : Download full-size imageFig. 1. Illustration of Energy internet.
It is not difficult to see that the above scheme combines blockchain and cryptographic technologies such as pseudonym addresses, differential privacy, and multi-party computing-based aggregation technique to achieve the security of energy trading data.
In practice, the transaction initiator always does not want participants who do not meet the access policy to view the transaction data, resulting in the disclosure of their private information [24]. Through the access control algorithm, users can set access policies to choose the type of users allowed to view their private information. The access control strategy implements the filtering of access users to avoid the leakage of private information to irrelevant users. However, most of the existing research schemes do not consider similar access control requirements. Ciphertext-Policy Attribute-Based Encryption (CP-ABE) [23] as a fine-grained access control encryption scheme can solve this problem perfectly as a cryptography algorithm. Considering the advantages of CP-ABE and blockchain technologies, we combine them to build a generalized transaction model that supports access control and arbitration to accommodate the needs of privacy preservation of Industry 4.0. Our main contributions are as follows:

1.We propose a blockchain based privacy-preserving distributed energy transaction scheme PP-BCETS. We use Ciphertext-Policy Attribute-Based Encryption (CP-ABE) as the core algorithm to design a ciphertext-based fine-grained access control scheme. The scheme supports transaction arbitration and lightweight ciphertext updates by multiple arbitration nodes, which can maximize the protection of user privacy. This design considerably enhances the safety and reliability of the energy trading process.2.In order to overcome the shortcomings of low efficiency and high delay in blockchain and adapt to the Energy Internet’s distributed energy trading environment, we develop a credibility-based equity proof consensus mechanism in PP-BCETS, which can greatly improve the system operation efficiency. We design a base model and a customizable enhanced model for the mechanism to cope with different application scenarios. As far as we are concerned, our proposed mechanism is the first of its kind.3.Finally, we conduct a detailed security analysis and performance evaluation of PP-BCETS. After our multi-angle analysis and derivation, the proposed PP-BCETS system is proved to provide strong security. Meanwhile, we also conduct experimental evaluations to our system and compared it with other similar work. The results show that our proposed system is indeed efficient.
The rest of this paper is organized as follows. In Section 2, we discuss the related work. In Section 3, the preliminaries are given. Models and goals are introduced in Section 4. In Section 5, we present the basic and enhanced scheme of PP-BCETS. The security analysis is given in Section 6. The performance of PP-BCETS is evaluated in Section 7. Section 8 concludes the paper.
