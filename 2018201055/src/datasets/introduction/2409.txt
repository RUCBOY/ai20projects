Foreign object detection plays a significant role in the agriculture product processing and food quality control industries. Foreign objects can be introduced to food products through, for instance, raw materials, a malfunctioning production line or artefact pollution. Foreign material in foods (plastic, metal, etc.) is the biggest single source of customer complaints for many food manufacturers, retailers and enforcement authorities (Edwards and Stringer, 2007). The detection of foreign objects is very important with respect to consumer satisfaction and health, and it is always required by food security regulations (Trafialek et al., 2016, Djekic et al., 2017, Diogo et al., 2018). The detection of foreign objects in walnuts is done using human eyes in many developing walnut-producing countries; however, the traditional quality inspection technique is slow, inefficient, and has a high rate of missed detections because of human factors and the impact of outside interference. In recent years, increasingly more researchers use machine vision and imaging techniques to inspect foreign objects in the food and agriculture industry. Kwon et al. (2008) collected images using grating-based multimodal X-ray imaging hardware and used global threshold segmentation to detect foreign objects inside foods, such as in bread, cheese, salami and steak. NIR spectral imaging hardware was used for the discriminant analysis and detection of materials among blueberries (Sugiyama et al., 2010). The global threshold segmentation and the support vector machine algorithm were applied to detect endogenous foreign bones in fish X-ray images (Mery et al., 2011). The terahertz imaging hardware was used to realise a safe nondestructive inspection method for sensing foreign crickets that were embedded in flour (Ok et al., 2013). The detection of foreign bodies in biscuits was realised using infrared thermography and image processing (Senni et al., 2014). Foreign matter in cotton can damage spinning and dyeing equipment and thus seriously affects the quality of cotton products. Many researchers proposed different image processing methods to detect the foreign matter. They involve traditional image segmentation algorithms (e.g., Otsuâ€™s method, the iterative thresholding method, the grey level cooccurrence matrix and the saliency-based method), handcrafted image feature extraction (e.g., the genetic algorithm, ant colony algorithm and particle swarm optimisation algorithm) and classification approaches (e.g., fuzzy clustering, rough sets and support vector machines) (Zhang and Li, 2014, Yu and Li, 2015, Zhang et al., 2016, Zhang et al., 2017). A sparse classifier was used for foreign object detection and segmentation in the multispectral X-ray image of foods (Gudmundur et al., 2017). The foreign objects in soybeans were detected based on machine vision, and the process involved a colour image segmentation process, median blur-ring, morphological operators, watershed transformation and component labeling (Momin et al., 2017).
Recently, deep learning algorithms have made remarkable progress in many research fields. Conventional methods are greatly affected by the hand-crafted parameters that are set up by users, but methods based on deep learning can provide accurate results through learning the features of training data. Accordingly, they provide better results, and many studies are being conducted on quality inspection using deep learning algorithms in different research projects and applications. Wang et al. (2016) proposed a banknote image defect recognition method based on CNNs (convolutional neural networks). Feng et al. (2017) proposed an injurious or no injurious defect identification method for magnetic flux leakage images based on CNNs. Cha and Choi (2017) realised crack damage detection based on deep learning and computer vision. Zhang et al. (2018) used CNNs to effectively recognise subgrade defects. Arif et al. (2018) applied two different deep fully convolutional network structures to progressively segment spinal regions and cervical vertebrae. Cao et al. (2018) used convolutional neural network structures for the foreign object debris detection on airfield pavement.
In this paper, we originally proposed employing CNNs to separately build two different models for automatically conducting both the image segmentation and detection of foreign objects in walnut images. In the CNN process flow, detailed features of walnut images were extracted in lower layers of the network, more features of walnut images were extracted by increasing the abstraction level from low-level layers to high-level layers, the low level features of walnut images were combined by higher layers, a single convolutional network layer in the output part of the network performs the segmentation and the fully connected layers in the output part of the network perform the classification. As a result, the CNN directly recognised patterns without the handcrafted feature extraction of walnuts and foreign objects. The feature extraction and detection of foreign objects in walnut images were simultaneously performed in the neural network, and the features that were fit for the classification were automatically realised. The detection and recognition performance was tested using walnuts from the nut production base of base of Linan district in the city of Hangzhou, China.
