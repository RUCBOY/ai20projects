Nowadays, many significative diseases can be identified by the analysis of retinal images [1]. In this line, a precise segmentation of the main ocular structures [2] [3] is useful for the posterior diagnosis and treatment of relevant retinal and systemic pathologies [4].
Among the different retinal image modalities, Optical Coherence Tomography (OCT) is a powerful tool for the diagnosis of retinal diseases, since the image acquisition in these devices consists in a contactless, non-invasive method which gives a set of images of the main retinal structures in real time [5], [6]. Nowadays, OCT imaging can be employed in the analysis and diagnose of many relevant diseases: the information regarding the thickness of OCT layers is useful in the diagnosis of glaucoma [7], macular degeneration [8], [9] or diabetic retinopathy [10], among others. Also, the retinal thinning is studied in multiple sclerosis [11]. Therefore, an adequate segmentation of the layers of the retina is crucial for clinical experts as they delimit the region of interest as well as offer relevant clinical information.
In this work, the top boundaries of the Internal Limiting Membrane (ILM) and the Ellipsoid (limiting with the Myoid) (M/E) are included, as well as both boundaries of the Retinal Pigment Epithelium-Bruch's Complex, limiting with the Interdigitation zone (I/RPE) and the Choroid (RPE/C), see Figure 1. These layers correspond to the retinal thickness (ILM and RPE/C) and the photoreceptor zone (M/E and I/RPE), also known as the External Zone of Photoreceptors (EZPR). Many studies correlated these retinal regions with the visual acuity measurement [12], [13], [14]. The efficacy of therapies to treat some of the most common eye-diseases, including diabetic macular edema or age-related macular degeneration, are usually evaluated by the retinal thickness (ILM and RPE/C) measurement [15], [16], [17]. Additionally, the photoreceptor zone (M/E and I/RPE) is also affected by these diseases and, therefore, is correlated with the visual acuity loss [18], [19], [20]. Given this clinical background and relevance, we aimed the mentioned layers as the most representative and informative ones, delimiting the regions of the most studied diseases that use the analysis of OCT imaging as reference.Download : Download high-res image (129KB)Download : Download full-size imageFigure 1. Analyzed retinal layer boundaries and regions of clinical interest in an OCT image.
Different methods have been proposed in previous works to segment the layers of the retina. As reference, a graph-based technique is presented in [21], [22], achieving the segmentation by finding the minimum-closed-set in the geometric graph, while in [23] the proposal includes a multi-scale 3-D graph search for the optic nerve head segmentation. Dynamic programming was used in [24] to automatically segment seven retinal layers. A sparsity-based process is presented in [25], where the input image is transformed into a layer-like domain to the later application of graph-theory. A further proposal with diffusion maps using a sparse representation of the graphs is presented in [26], where its main limitation is the influence of the value for the size of the rectangles (or cubes) used in the approach. In [27], the authors proposed a learning strategy for the retinal layers segmentation task. This method uses a random forest (RF) algorithm for the classification of the pixels between these boundaries. A dual-gradient-based method is proposed in [28] to segment nine intra-retinal boundaries, combining gradient information to achieve the shortest path-based segmentation. Although the results were promising, the segmentation in the area of the fovea was not accurate regarding the manual expert segmentations. That work is extended in [29], where the segmentation is obtained to construct layer maps representing the thickness in a context of pathological patients. For this kind of segmentation tasks, the active contour models seem suitable. A multi-object geometric deformable model is used in [30], where nine retinal layers are segmented. In [31], the authors proposed an adapted the Chan-Vese's model [32], an active contour-based model using a Mumford-Shah functional [33], for the extraction of the retinal layers in OCT images of rodents. Posteriorly, this strategy was refined in a semiautomatic method presented in [34]. Although this method achieved an adequate performance, it still presents some intrinsic limitations of the active contour models as, for reference, the improvable segmentation results in images with intensity inhomogeneity, the sensitivity to the initial location of the level set contours in complicated images and the high time-consuming of the re-initialization step of the algorithm [35], [36].
Recently, deep learning-based strategies have been used successfully for the automatic retinal layer segmentation issue. In [37], the authors proposed an automatic system that uses convolutional neural networks (CNN) for the thickness segmentation in OCT scans. Other work, [38], also proposed a CNN based deep learning approach to simultaneously segment three surfaces. This approach demonstrated a low computation cost and a higher performance compared to the graph based approaches and the U-NET learning-based method. In [39], the authors proposed a method also using a CNN implementation, followed by an analysis of the effects of the patch size as well as the network architecture design on the CNN performance and the subsequent layer segmentation. A new fully-convolutional architecture was presented in [40]. This architecture, called ReLayNet, uses a contracting path of encoders to learn a hierarchy of contextual features, followed by an expansive path as decoder for the retinal layer and fluid segmentation.
The main contributions of the paper include: (i) a new strategy based on an active contour model that uses the horizontal placement of the layers of the retina and their relative location over the analyzed images to restrict the search space and to enclose the possible movements of the model to reach the different desired layers; (ii) not all the proposals to segment the layers of the retina considered the presence of shades that are normally generated by blood vessels, exudates, cysts or any other pathological or non-pathological artifact; (iii) to date, none proposal considered the pathological scenarios (patients without macular edema, with macular edema and with lesions in the photoreceptor layers) where the retinal layers suffer significative alterations, including the fusion of some of them or the possibility of their absence in particular regions of the retina, as illustrated in Figure 2.Download : Download high-res image (301KB)Download : Download full-size imageFigure 2. OCT images from a healthy patient (a) and a patient with some pathology altering the EZPR (b). The arrows identify regions where this layer is altered or almost missing.
In this paper, we propose a fully automatic methodology to segment the main retinal layer boundaries using OCT images, not only when the layers are clearly perceived but also in the previously exposed situations. The proposed method, based on active contours, was completely adapted and optimized for this specific search space using anatomical knowledge of the retinal layers. Additionally, the adopted segmentation method includes specific refinement phases to correct possible mistakes and improve as much as possible the performance of the layer segmentation task. Preliminary results of an early proposal were presented in [41], initially demonstrating the potential of the followed strategy.
This paper is organized as follows: Section 2 presents the proposed methodology for the automatic retinal layer segmentation and the characteristics of all its stages. Section 3 presents the results that were obtained with the method. Finally, Section 4 presents the conclusions about the proposed system as well as possible future lines of work.
