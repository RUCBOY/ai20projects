SELEX (Systematic Evolution of Ligands by EXponential enrichment) procedures, where experimenters iteratively apply selection, reproduction and mutation to populations of nucleic acid molecules, are known as a valuable tool for finding DNA or RNA sequences with high affinity for a pre-specified target molecules (Darmostuk et al., 2015).
The SELEX procedure for DNA sequences in vitro starts with a chemically synthesized DNA library, which is incubated with target molecules. Unbound molecules are removed and the target/DNA complex is split. Released DNA sequences are amplified by the polymerase chain reaction (PCR) with possible modifications by mutations (error-prone PCR) and the next round of selection is performed. Typically, this process is repeated for a number of rounds. Analogous procedure may be applied to RNAs. The in vivo SELEX searches for short functional sequences that contribute to the fitness of the genotype. The DNA strings of potential “solutions”, obtained in this process, are sequenced and their binding kinetics is evaluated by various methods. Because SELEX in real experiments requires a costly procedure, both in vivo and vitro experiments are often preceded by in silico SELEX, using computer simulation. While in silico SELEX is mainly aimed at the aptamer generation, here we aim at modeling SELEX in vitro or in vivo.
We start with the observation (Oh et al., 2011) that the SELEX procedures may be treated as an experimental implementation of an evolutionary algorithm (EA). The field of EAs emerged in the area of computer science due to a transfer of ideas from biology and it is mainly focused on development of heuristic optimization methods, based on simulation of a population of individuals (tentative solutions) that undergo random mutation, selection, and sometimes crossover (Paixao et al., 2015). The evolutionary process that is associated with such transformations of the population is expected to guide the search towards an optimal, or locally optimal, solution. Sometimes the convergence to optimum may be guaranteed as time tends to infinity (Rudolph, 1998) or upper and lower bounds may be proven for the expected number of tentative solutions evaluated until an optimum is found for the first time (Auger et al., 2011).
We aim at the prediction of the efficiency of the SELEX procedure, if the parameters of the optimal sequence can be estimated to some degree. We propose to consider the search for a regulatory region “from scratch”, as an implementation of an EA where the fitness function is given by the Royal Road (Mitchell et al., 1992), the Royal Staircase (van Nimwegen and Crutchfield, 2000) function, or a combination of both. Instead of the binary alphabet, originally used in the definition of these fitness functions, we use the four-letter alphabet of nucleotides. The desired sequence in DNA-alphabet must include several short subsequences of nucleotides (binding sites) with exact match in some fixed positions and several acceptable options in others. The sequences of the spacers between the binding sites are arbitrary, but the lengths of the spacers are supposed to be fixed. Each binding site serves as a target for a specific DNA-binding protein (polymerase subunits or transcription factors), and if such a binding occurs, it influences the activity of the gene. In the initial stage, where the order in which the sites are found is pre-determined, we use a Royal Staircase fitness function. In the final stage, when the search for enhancer sequence begins, the order in which the sites are found is arbitrary and all sites have identical binding constraints, therefore a Royal Road function becomes a relevant fitness model.
In the present paper, we apply the results from the theory of EAs to upper bound the number of rounds of SELEX procedure until an optimal series of motifs is found (Eremeev, 2017) and to upper bound the expected number of desired strings at a given round of SELEX (Eremeev, 2018). The theoretical bounds are evaluated in computational experiment on the examples based on a typical bacterial rRNA regulatory region of bacteria E. coli.
It is expected that development of such methods will be helpful for prediction of efficiency of in vitro evolution, combined with rational design strategies (Koizumi et al., 1999). Consider e.g. the evolutionary search for multivalent (chimeric) aptamers (Vorobyeva et al., 2016). At this stage, the model with two building blocks of a Royal Road or a Royal Staircase function may be applied.
A different type of prospective applications of our methods is expected in modeling the SELEX procedures aimed at fine tuning the promoter activity (Tyo et al., 2011). These procedures are suitable for design of synthetic genetic networks and circuits, e.g. in industrial production of pharmaceutical proteins. Also, we expect that our methods may also be applied for modeling new experimental approaches to directed evolution of macromolecules based on droplet-based microfluidics (Weng and Spoonamore, 2019).
1.1. BackgroundSELEX procedures are known as a valuable tool in identifying DNA and RNA sequences with high affinity for a pre-specified target proteins/molecules. However, SELEX procedure is time-consuming and costly. Therefore, in parallel with the practical in vitro procedures for selection and evaluation of DNA and RNA sequences, in silico approaches have been developed to predict the high-affinity sequences, allowing to reduce time and cost (see e.g. Darmostuk et al., 2015, Kinghorn et al., 2017). Most of the in silico studies focus on selecting the configurations with the highest probability to be found in vitro. In contrast to this, our analysis aims at the prediction of efficiency of the SELEX procedures, if the contents of an individual enhancer or promoter are already known or estimated to some degree.The first deterministic model of SELEX was proposed by Irvine, Tuerk, and Gold in Irvine et al. (1991), where the model showed adequate results w.r.t. experimental verification. However this model did not take into account the possibility of mutations in polymerase chain reaction (PCR) which is used for amplification of ligand sequences, functioning in the desired manner. (Point mutations are inevitable in the PCR procedure, moreover, their level may be specifically increased. More complex mutations can occur as well, but their probability is low.) This aspect of SELEX was covered in Oh et al. (2011), where an evolutionary algorithm was proposed as a simulation tool for SELEX with mutations and heritability. The authors consider a special case where the fitness function has a unique optimum, and their approach turns out to be limited to population sizes up to 108 molecules. Analogous limitation has the simulation-based approach employed in Hoinka et al. (2015), however it is reported that the simulation software AptaSIM from Hoinka et al. (2015) shows good agreement with the real-life experimental data in the case of high-throughput SELEX.One of the serious difficulties in the case of simulation-based approach is that in vitro SELEX can be performed on populations as large as 1015 molecules. On a personal computer, it is technically possible to implement an EA with a population of millions of individuals, but populations of the order of 1010 individuals are on the verge of the capabilities of modern (super) computers (Lee et al., 2011). This justifies the need for further development of EA theory as a substitute for the simulation-based approach.The present work is aimed at the prognosis of effectiveness of SELEX procedures, if there are preliminary estimates of the length of the nucleotide sequence of an individual enhancer and promoter domain as well as its statistical properties (such as the sequence logos) are known. The analytical methods used in this work allow us to obtain the estimates for SELEX procedures with populations of large size, for which simulation modeling is not possible.Here we proceed from the consideration that the level of a gene expression can be seen as a molecular realization of a fitness function, generalizing one of the Royal Road functions proposed by Mitchell, Forrest and Holland in Mitchell et al. (1992). In fact several different families of functions acting from the set of binary strings to real numbers were introduced and termed the Royal Road functions in Mitchell et al. (1992). To avoid a confusion, by the Royal Road functions we refer to the formal definition from Jansen and Wegener (2005). In this function, an argument x, which is an n-bit string, is partitioned into n∕r blocks of length r each where n∕r is an integer. Then the value of the Royal Road function equals the number of blocks of x, containing one-bits only.In van Nimwegen and Crutchfield (2000), van Nimwegen and Crutchfield introduced a class of Royal Staircase fitness functions. Unlike the Royal Road functions, in the case of the Royal Staircase fitness, the consecutive blocks of one-bits are counted, starting from the first position of a given string x, and the fitness is assumed to be the number of consecutive valid blocks starting from the first position, plus one.In a biologically meaningful generalization of Royal Road and Royal Staircase functions, the desired sequence in the DNA-alphabet must include several short stretches of nucleotides (called sites) with exact consensus sequence or close to that. In the present paper, as a fitness function we consider the expression level of a gene, regulated by its promoter sequence composed of several binding sites, which may also contain an enhancer. We assume that the nucleotide choices in the sequences of spacers between the sites are arbitrary, but the size of the spacers is fixed. The sites of a promoter (e.g. sites “-10” and ”-35”) serve for polymerase binding, while each site of an enhancer serves as a target for specific binding of the DNA-binding factor, and the level of expression of the gene depends on the set of binding sites with suitable strings in the promoter and enhancer.The desired promoter sequence in SELEX may be sought by experimenters using the output of some preceding procedure or using a library of random sequences (from scratch). As soon as a new site is found, this raises the sequence fitness level by a discrete step — see e.g. Hirvonen et al. (2001) and Blazeck et al. (2011). The effects of binding sites of a promoter may be modeled by the blocks of a generalized Royal Staircase function, see  Fig. 1. In the case of enhancers with multiple binding sites, the order of the sites finding is arbitrary, therefore we can apply a generalization of a Royal Road function to model the gene expression level. Combining both cases, we can assume that the selection criterion in the SELEX procedure is based on the number of valid Royal Staircase blocks, starting from the first position (the closest to the coding region of the gene), and if all such blocks are valid, then each valid Royal Road block adds an extra unit to the aptamer’s fitness (see more details in Section 2).A practical case, where clusters of binding sites were evolved via SELEX procedures may be found in Zhang and Simon (2003). In that work, in vivo genetic selection (function-based in vivo SELEX) was applied to Turnip Crinkle Virus (TCV) sequences, where 28 base pairs (bp) of the viral regulatory element motif1-hairpin were randomized and then subjected to selection in plants. Most of the “winners” in this experiment contained up to three short sequences (5–7 bp), many of which are found in promoter elements of the wild type virus. Another relevant practical case is described in Remans et al. (2005), where in vitro evolution scheme was applied for functional promoter analysis in banana streak virus.Download : Download high-res image (239KB)Download : Download full-size imageFig. 1. An example of regulatory region and its consideration from the EA viewpoint. Fitness levels indicate different stages of formation of promoter rrnB P1 of E. coli (core promoter and UP elements) and its enhancer (FIS I – FIS III binding sites). More details about the definition of the fitness function implied in this figure may be found in Sections 3.2 Royal road fitness for modeling FIS enhancer, 3.3 Generalized royal staircase fitness for modeling promoter and one enhancer site, 3.4 Fitness function for modeling promoter and a cluster of enhancer sites.It is important that in SELEX in vitro, at the selection stage, there is an intermediate “population” of molecules, bound to the target proteins (with a selection probability that monotonously depends on their binding ability), and then the molecules of this sub-population are used to build “descendant molecules”, i.e. undergo amplification in polymerase chain reaction. The (μ,λ)-selection procedure (see Section 3) and the vesicular selection (Lee et al., 2011) satisfy this requirement. However not every selection procedure known in the EAs has such an intermediate population. For example, the tournament and the proportionate selection do not have such a population.There are some dissimilarities between optimization of the Royal Road and Royal Staircase functions in the EAs and the problem of breeding a nucleotide sequence of a regulatory region via SELEX. One of the crucial differences is that each building block in the standard Royal Road and Royal Staircase functions has only one valid sequence, while in biology each site is a family of sequences, which are mutually similar in their structure and yield close to the minimum values of the energy of free binding.Also, some of the molecules go to the next round of SELEX from the previous one due to random binding. Usually this is a constant fraction of the total pool, but its specific value in practice depends very much on the method of separation used in the SELEX. This value can vary within a very wide range. For example, for selection on nitrocellulose membranes, this fraction is 1%–3% of the initial pool, and for SELEX on magnetic particles it is of the order of 10−6 of the initial pool (Wang et al., 2012). If the immobilized target is washed with a buffer with a detergent, then this fraction can be further reduced to 10−9, see e.g. Ouellet et al. (2015).Another difference is that, in general, for the purposes of evolutionary computation, it is sufficient to find a single copy of an optimal solution. However generating a single sufficiently fit DNA string in a SELEX population is not enough, since it is necessary to get a reasonable fraction of sufficiently fit genotypes here. The results from the EA theory should be slightly adjusted for this purpose (in the present paper we do not consider this modification in order to simplify the presentation). Finally, modern SELEX procedures can include only up to 50 rounds, while the number of EA generations is usually measured in thousands.The main contribution of the present paper suggests that theoretically provable EA runtime bounds may be used, at least in principle, for a priori estimation of efficiency of SELEX-based procedures. On the one hand, the upper bound on expected hitting time of a target area of genotypic space by EA (the EA runtime) from Eremeev (2017) allow to upper-bound the expected time to finding a sufficiently fit series of subsequences (e.g. binding sites for transcription factors) in a SELEX procedure. On the other hand, the theoretical approach (Eremeev, 2018) yields upper bounds on the expected proportion of the DNA sequences with sufficiently high fitness at a given iteration of SELEX procedure. As a proof of concept, both approaches are evaluated in a computational experiment, using generalized Royal Road and Royal Staircase fitness functions and their combination to model the SELEX procedure if it were applied to a typical rRNA regulatory region from bacteria E. coli.The paper has the following structure. In Section 2, we provide some relevant details on functioning of promoters and enhancers and the binding sites for FIS factor, in particular. Section 3 outlines the non-elitist evolutionary algorithm and its relationship to the SELEX procedure for enhancers and promoters. Theoretical bounds on performance of the considered evolutionary algorithm are presented in Section 4. Application of these bounds to the specific cases of SELEX modeling and comparison of theoretical forecasts to a computational experiment are described in Section 5. In Section 6, we discuss the possible consequences of the simplifying assumptions that we make in this paper. Concluding remarks are given in Section 7. Detailed proofs of mathematical statements are provided in the appendix for the sake of completeness.
