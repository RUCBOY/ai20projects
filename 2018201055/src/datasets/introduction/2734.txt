Network information hiding is a discipline that deals with the concealment of network communications or their characteristics and the hidden communication channel created by a data hiding method is referred to as a network covert channel [1].
From an economic perspective, covert channels are firstly a contributing factor for malware communications, especially botnet command & control (C&C) [2], [3]. With covert channels, botnets (in comparison to solely applying encryption) can keep their communications secret [1], [4]. As rental botnets are offered in the darkweb and as covert channels (and encryption) are a major factor in the longevity of such botnet “products”, their study is a key factor for the success of such botnets. Secondly, another economically important scenario is the fact that covert channels provide a means for the stealthy exfiltration of business data, e.g., internal research results, marketing plans, business contracts or development plans [1], [4]. Thirdly, covert channel detection, limitation and elimination is a feature of today’s anti-malware/-virus software products, which represent an important market. Defeating covert channels is expected to become not only more challenging (as sophisticated techniques emerge) but also more important (as covert channel application increases [5], [6]). From a more general perspective, cyber threats are causing massive economical damage and with the improvement of defense systems, cybercriminals turn to less detectable attack techniques, such as network covert channels [5]. One of the key techniques ante portas are adaptive covert channels that automatically adjust their covert communication so that they can bypass introduced filter technologies. Considering these aspects, it is important to develop effective countermeasures to address risks involved with the utilization of network covert channels.
In information hiding the network entity that tries to reveal the existence of (and subsequently eliminate) the covert channel is referred to as a warden. A warden’s role is to enable auditing, detection, limitation or elimination of such hidden communications [4], [7]. The warden can be equipped with various countermeasures, which can be classified into passive and active techniques.
Passive wardens apply non-influential techniques that monitor the traffic (e.g. using statistical or behavioral traffic analysis) to detect the involvement of a party in a covert communication or the secret communication itself. On the other hand, active wardens [8] employ measures to monitor, analyze and manipulate the overt traffic (that potentially carries a covert channel), the covert traffic, or both in order to try to disrupt the covert communication (e.g. by modifying packet contents, injecting packets into existing connections, inflicting intentional packet losses and/or delays).
An active warden is typically realized by means of traffic normalization. Traffic normalizers aim to remove semantic ambiguities of the protocol header fields or unify the timing behavior of network traffic passing through the normalizer. For example, a normalizer can be equipped with rules to set unused, reserved, and padding bits to zero or to reorder certain portions of packet headers to limit the possibility to successfully hide information there.1  Traffic normalization may also affect the passing traffic (both malicious and legitimate) significantly, resulting in the unwanted side-effects.
Primarily, it can have a negative impact on the Quality of Service (QoS) of the passing traffic. The two main sources of this degradation are: (i) a potentially high number of warden’s normalization rules with which the traffic is inspected, which may incur additional delays; (ii) warden normalization behavior which, for example, can result in adding intentional delays or losses to counter covert channels that exploit the timing aspects of the network traffic.
Secondly, an important deficit of current wardens (referred to as regular wardens in the sequel) is that typically their functioning is static, i.e., the set of active normalization rules typically remains constant in time or changes very rarely and slightly (e.g. in reaction to the discovery of some previously unknown data hiding techniques, an administrator may manually add new rules). In particular, this means that if the covert sender and the covert receiver are able to infer the warden’s normalization capabilities then they can try to adapt to them [12] by adjusting their behavior. This is achieved by first discovering (during a so-called network environment learning (NEL) phase, cf. Section 4) and then by exploiting the warden’s vulnerabilities, e.g., a lack of certain normalization rules for a particular data hiding method. In result, both covert communication parties can select a network covert channel which is not influenced by the warden in order to perform their hidden communication in an uninterrupted manner.
In this paper, we address the above mentioned deficits, i.e., the warden’s static behavior and its impact on the inspected traffic. In particular, we devise a novel warden operation strategy that we call dynamic. A dynamic warden performs periodic, randomized shuffling of the active subset of normalization rules. In result, the warden is evolving its normalization behavior over time and thus it is increasing the uncertainty for the adaptive covert communication parties by limiting their ability to successfully infer a warden’s normalization capabilities.
Considering the above, the main contributions of this paper are to: (i) perform a first comprehensive analysis of various aspects and features of a warden which influence its capabilities and effectiveness in countering network covert channels — to this aim a novel taxonomy for wardens is introduced; (ii) propose a novel active warden strategy, i.e., the dynamic warden, which is based on the constantly evolving normalization behavior in order to increase the uncertainty of the covert communication parties and to limit their chance for successful covert communication; (iii) create the first proof-of-concept implementation of a dynamic warden; (iv) perform an extensive experimental evaluation which proves that this concept is effective and, in particular, allows to achieve a trade-off between the time needed to completely transmit covert data and CPU load, with a longer completion time of the hidden transmission at CPU load similar to a regular warden.
The remainder of this paper is structured as follows. Section 2 summarizes the state-of-the-art research on wardens and their capabilities. In Section 3, we introduce a novel and comprehensive warden taxonomy which takes various aspects of wardens into account. In Section 4, the concept of a dynamic warden is introduced which is later evaluated in Section 5. Section 6 concludes and provides an outlook on future work.
