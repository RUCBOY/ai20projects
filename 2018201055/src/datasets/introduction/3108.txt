Teaching the computer to plan chemical syntheses has been one of the outstanding challenges of modern-era organic chemistry. Despite decades of research and many ingenious approaches,1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 there have been no literature reports of complete synthetic pathways designed by the computer and then successfully executed in the laboratory.11 The inadequacy of computer programs reflected, among other factors, their limited knowledge base of chemical transformations, their inability to navigate enormous “trees” of synthetic possibilities in an intelligent fashion, and the lack of higher-order logic prescribing how individual steps should be put together to produce elegant, or at least viable, pathways. Building on over a decade of research on chemical networks,13, 14, 15, 16 we have recently disclosed10 a de novo retrosynthetic module within the Chematica platform (henceforth, simply Chematica) that unites network theory, modern high-power computing, artificial intelligence, and expert chemical knowledge to rapidly design synthetic pathways leading to arbitrary (i.e., previously made or never attempted) targets. Although Chematica has attracted considerable interest,17, 18 its predictions have not been verified experimentally until now. Here, we describe the results of a systematic evaluation in which synthetic pathways leading to eight structurally diverse and medicinally relevant targets were first designed by Chematica without any human supervision and subsequently executed in the laboratory. All of these syntheses were successful and either improved on previous approaches or provided the first documented route to a given target.
Starting in 2005,13 we have published extensively on the algorithms and methods enabling representation of synthetic pathways as the so-called bipartite graphs, which can then be queried in the Chematica10, 16 platform according to different sets of criteria. In retrosynthesis, these criteria are rules describing various types of reactions. The rules are coded by expert chemists and to ensure applicability to arbitrary targets, they cover not only popular and simple transformations but also the advanced methodologies essential in the synthesis of complex targets. At the core of each of Chematica's ∼50,000 rules is a decision tree such as the one shown in Figure 1A for double stereodifferentiating condensation of esters with aldehydes. The various conditions within the tree specify the range of admissible and also possible (i.e., not only those based on prior literature precedents) substituents or atom types. Importantly, all rules account for stereo- and regioselectivity and also for the “context” of the molecule; that is, for groups incompatible with the reaction or those to be protected (for these and other aspects of rule application including electronic and steric effects, see Supplemental Information, Sections S2–S5).Download : Download high-res image (1MB)Download : Download full-size imageFigure 1. Reaction Rules and Reaction Networks Underlying Chematica(A) An example of a decision tree for one of Chematica's ∼50,000 reactions rules (double stereodifferentiating condensation of esters with aldehydes). The tree begins with a condition of the reaction being intermolecular. To ensure face selectivity of the enolate, conditions for the substituents at positions #8, #1, and #3 are considered. Conditions at positions #12, #2, #11, #14 follow and ensure proper face selectivity of the aldehyde. The last two conditions are common for both substrates. The substrates should be acyclic because cyclic structures might distort the aldehyde-titanium chelate conformation or face selectivity of the ester enolate. The other requirement concerns the consonant selectivity at both substrates that ensures the desired diastereoselectivity. The mechanistic reasons for each condition as well as the translation of the tree into SMILES notation are discussed in detail in the Supplemental Information, Section S3.4.(B) The rules such as the one described in (A) are used to explore the graphs of synthetic possibilities emanating from the target and growing with the number of search iterations. Each node corresponds to a set of substrates. The image shown here is for the early stage of planning the synthesis of the BRD7/9 inhibitor 8. In a typical planning task, the program constructs and analyzes networks that are tens to thousands (sic!) of times larger than the one shown.(C) A subgraph of (B) showing only the viable synthetic pathways terminating in commercially available (red nodes) or known (green nodes) substrates. Once such feasible syntheses are found, the program extracts them from its internal network representation and displays as in the actual synthetic routes in Figures 2 and 3 (also see Movie S1).
The reaction rules are only the basic “moves” from which the complete synthetic pathways (“games”) are to be constructed. Because the number of choices at each retrosynthetic step10 is ∼100 (commensurate with the number of choices at each step in a chess game), the number of possibilities within n steps scales as 100n. To search such an enormous synthetic space (Figures 1B and 1C; Supplemental Information, Section S6), intelligent algorithms are needed to truncate and revert from unpromising “branches” and channel the searches toward the most efficient and elegant sequences of steps. Chematica avoids unpromising routes by using numerous heuristics prohibiting unlikely structural motifs, penalizing reactions that are non-selective, or those that would have to proceed through very strained intermediates (Supplemental Information, Sections S5.2 and S6). The searches are then guided toward the most feasible solutions by the so-called scoring functions that evaluate (1) the sets of substrates made at each step and (2) the sequences of reactions that were used to reach any particular set. Importantly, to enable searches and scoring of substrate sets rather than individual molecules, the bipartite reaction graphs are transformed into so-called hypergraphs (with “supernodes” combining several individual substance nodes; Supplemental Information, Sections S6.1 and S6.2). The algorithm navigating these hypergraphs takes advantage of higher-order logic (concatenating individual steps into “strategic sequences,” eliminating sequences of steps in which highly reactive groups are dragged along, etc.; see Supplemental Information, Section S7) and terminates when reaching commercially available (currently, over 200,000 chemicals from the Sigma-Aldrich catalog) or other synthetically popular substrates (ca. 7,000,000 molecules from literature and patents, each with the value of its connectivity within the Network of Chemistry13, 14, 15, 16). Finally, because up to millions of viable pathways can be found for typical targets, dynamic linear programming algorithms are used to retrieve pathways that are not only best scoring but also significantly different from each other (Supplemental Information, Section S6.3). In the pathways presented to the user, each substance can be further inspected via built-in molecular mechanics tools, and each reaction comes with suggestions for reaction conditions, literature citation(s) illustrating this type of chemistry, information on which groups need to be protected (and with what protecting groups), examples of similar reactions reported in literature, and more (see Supplemental Information, Section S8).
