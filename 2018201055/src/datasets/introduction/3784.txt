The weather conditions influence our daily lives and production in many ways [1], such as wearing, traveling, solar technologies and so on. Therefore, acquiring weather conditions automatically is important to a variety of human activities. A possible solution to weather recognition is utilizing various of hardwares. While these hardware equipments are usually expensive and need professionals to maintain. An alternative scheme is to recognize weather conditions from color images using computer vision techniques [2], [3]. Nowadays, surveillance cameras are ubiquitous, which makes the computer vision solution feasible. Apart from the guiding significance to our daily lives, weather recognition is also an important function to many other computer vision applications [4], [5], [6], [7], such as image retrieval [8], image restoration [9], and the reliability improvement of outdoor surveillance systems [3]. Robotic vision [10], [11] and vehicle assistant driving systems [12], [13] can also benefit from the results of weather recognition. Thus, we can draw a simple conclusion that weather recognition from outdoor images has great research significance.
1.1. Motivation and overviewAlthough weather recognition is of remarkable value, only a few researches have been published to tackle this problem. Several previous works [12], [14], [15], [16] concentrated on recognizing weather conditions from images captured by in-vehicle cameras. Several other papers [1], [17], [18] exploited weather recognition from single outdoor images. All of these works referred to weather recognition as a single-label classification task (the weather label means weather category in this paper), namely, determining whether an image belongs to a specific weather category or not.However, it is not always appropriate to view weather recognition as a single-label classification problem. There are mainly two reasons to explain this inappropriateness. The first reason can be summarized as uncertainty, i.e., the class boundaries among some weather categories are ambiguous essentially. As can be seen from Fig. 1, the changes from Fig. 1(a)–(f) demonstrate that there are a series of states between a pure sunny weather (like Fig. 1(a)) and an obvious cloudy weather (as illustrated in Fig. 1(f)). It is hard to determine whether the category is sunny or cloudy when referring to an intermediate weather state like Fig. 1(c), (d) and (e) [2]. Thus, the uncertainty of such boundary samples causes the difficulty to determine ground-truth labels even from the perspective of human beings, and few previous works present solutions to this problem. The second drawback of treating weather recognition as a single-label classification task can be summarized as incompleteness, namely, a single weather label may not describe the weather conditions comprehensively for a given image. For example, the visual effect of haze is obvious in Fig. 1(g), (h) and (i). Nevertheless, it can be seen from the comparisons among these three images that Fig. 1(g) seems more sunny while Fig. 1(h) seems more overcast, and Fig 1(i) seems snowy. Therefore, only a haze label cannot reveal the differences among these three images.Download : Download high-res image (544KB)Download : Download full-size imageFig. 1. Several outdoor images (A part of these images are from [19]). (a) A sunny image with no clouds in the sky. (b) A sunny image with a few clouds in the sky. (c) In comparison with (b), there are more clouds in this image. (d) and (e) present both sunny and cloudy features. (f) A cloudy image. (g) A foggy image with an obvious sun in the sky. (h) A foggy image that seems more overcast. (I) A foggy image with obvious snow on the ground.Motivated by the aforementioned two reasons, we propose to view weather recognition as a multi-label classification problem, i.e., assigning multi-labels to an image according to the displayed weather conditions. Specifically, it is achieved by a CNN–RNN architecture. The intuition lies in two aspects. On one hand, most of the previous works focused on exploiting hand-crafted weather features [1], [20], while these features did not achieve desired results in the weather recognition task. Inspired by the great success of Convolutional Neural Network (CNN) in these years, we utilize CNN as the weather feature extractor. On the other hand, labels exhibit strong co-occurrence dependencies in weather domain. For example, snowy and cloudy usually occur together while rainy and sunny almost never co-occur. Inspired by the success of Recurrent Neural Network (RNN) in dependency modeling [21], [22], we propose to use RNN to model the dependencies among labels and predict weather labels step by step. In such a way, when predicting subsequent labels, the network can refer to the previous hidden states that incorporate the historical information implicitly.For weather recognition, different image regions have different importances when predicting labels. As shown in Fig. 2, the blue sky is crucial for judging a sunny day, and snow on the ground is significant for estimating the snowy weather. Lu et al. [2] also emphasized that such weather cues are critical. Therefore, it is necessary to make the weather cues discriminative and preserve the spatial information of the image. To achieve this goal, a channel-wise attention model is designed to exploit more discriminative features for the weather recognition task. Besides, we use convolutional Long Short-Term Memory (LSTM) [23] instead of vanilla RNN in our CNN–RNN architecture to preserve the spatial information. Convolutional LSTM uses convolution operations in both state-to-state and input-to-state transformations, which captures better spatio-temporal information than fully connected LSTM (FC-LSTM) [23].Download : Download high-res image (926KB)Download : Download full-size imageFig. 2. Illustration of some important regions in weather recognition. (a) A sunny weather with blue sky. (b) A snowy weather with snow on the ground. (c) and (d) When occluding the important regions, it is more difficult to estimate the weather conditions. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article).In addition, considering that there are lacking of datasets in the weather recognition task, two new datasets are constructed in this paper, where the first consists of about 8K images from seven weather categories, it is transformed from an existing transient attribute dataset [19]. The second is built from scratch containing 10K images from five weather categories.
1.2. ContributionsIn summary, there are three main contributions of this work:
(1)We propose to treat weather recognition as a multi-label classification task by analyzing the drawbacks of classifying images with a single weather label and the co-occurrence relationships among different weather conditions.(2)We present a CNN–RNN architecture to tackle the multi-label weather classification task. It is composed of a CNN to extract features, a channel-wise attention model to recalibrate feature responses, and a convolutional LSTM to model the relationships among different weather labels.(3)We build a new multi-label weather classification dataset and transform an existing transient attribute dataset [19] for the weather recognition task. The datasets will be available on the project website.
1.3. OrganizationThe remainder of this paper is in the following structure: In Section 2, some related works about weather recognition are reviewed. In Section 3, we describe the proposed approach in detail. In Section 4, we first present the construction of the new multi-label weather image dataset and the modification of the transient attribute dataset [19]. Then, we analyze the experimental results on these two datasets. In Section 5, the conclusion of this paper is drawn.
