Reverse time migration (RTM) (Hemon, 1978; Baysal et al., 1983; Whitmore, 1983; McMechan, 1983) has been considered to be one of the most accurate seismic pre-stack depth migration methods, especially for imaging geologically complex structures. A number of progresses in RTM have been made. Červenỳ presents RTM based on both first order wave equation and second order wave equation in anisotropic media (Červenỳ, 2001). Alkhalifah models P-wave propagation based on the P-wave dispersion relation in transversely isotropic (TI) media (Alkhalifah, 2000), and in vertical orthorhombic media (Alkhalifah, 2003). Qu et al. extend a attenuation term of viscoacoustic wave to VTI wave quasi-differential equations in order to consider both viscosity and anisotropy of media simultaneously (Qu et al., 2016).
RTM consumes vast memory and computation time. To solve this problem, Wu et al. verify the advantages of high order spatial finite-difference operators (Wu et al., 1996). Chen presents three kinds of high-order finite difference (FD) schemes in time (Chen, 2007). Oprsal and Zahradnik propose a rectangular grid with both laterally and vertically variable grid sizes (Opršal and Zahradnik, 1999). The memory and time cost can also be resolved through Fourier or pseudospectral methods (PSM), which calculate the spatial derivatives by the fast Fourier transform (FFT) with a smaller spatial sampling density but yield higher accuracy. Baysal introduces PSM in RTM firstly (Baysal et al., 1983). Fornberg has compared the PSM with the FD method, and indicates the obvious priority of PSM in efficiency and accuracy (Fornberg, 1987).
We propose to implement RTM on general purpose GPU by Compute Unified Device Architecture (CUDA). RTM contains lots of inherently data-parallel computing. As a result, it is suitable to run in GPU. In recent years, many researchers implement RTM on GPU. Clapp et al. study different hardware for RTM, and demonstrate the strengths of GPU (Clapp et al., 2010). Micikevicius et al. parallelize 3D two-way RTM on GPU using CUDA (Micikevicius, 2009). Liu et al. accelerate anisotropic RTM by GPU (Liu et al., 2009). Kim et al. apply GPU to speed up stable TTI P-wave RTM (Kim et al., 2013).
Video memory size often becomes a bottleneck of the usage of GPU. In contrast to the CPU cluster, which has hundreds or even thousands of gigabytes memory, GPU has only up to tens gigabytes video memory at present, and cannot solve a large-scale problem. RTM using the pseudospectral time-domain (PSTD) algorithm can reduce this limitation effectively. The PSTD algorithm has been proposed for electromagnetic waves (Liu, 1997, 1999), acoustic waves (Liu, 1998a; Liu and Tao, 1997), and elastic waves (Liu, 1998b). The PSTD algorithm combines PSM (Fornberg, 1987; Karazincir and Gerrard, 2007; Kim et al., 2013) with perfectly matched layer (PML) (Berenger, 1994; Liu and Tao, 1997). The PS method solves the spatial derivatives by FFT, thus achieving greater accuracy with lower spatial sampling density than the conventional FDTD method (Fornberg, 1987). Nevertheless, the wraparound effect arisen from FFT which always assumes to be periodic limits the application of PS method (Cerjan et al., 1985; Liu, 1998a). PML is a ideal way to remove this wraparound effect. The PML can not only work as the absorbing boundary condition (ABC), but also eliminate the periodicity limitation caused by FFT (i.e., wraparound effect), because the PML absorbs passing waves and eliminates reflection at the boundaries of the computation area (Liu, 1998a; Xie et al., 2016). On the basis of the Nyquist sampling theorem, the spatial sample density of the PSTD method requires only two points per minimum wavelength, which is only a half of the eighth-order FDTD method sustaining the same accuracy, and thus it can save lots of video memory and solve bigger problems on a memory-limited GPU (Xie et al., 2016).
The throughput of memory swapping is another bottleneck of GPU. GPU's capability is greatly influenced by large and frequent memory swapping between the GPU and the host computer, because the IO bandwidth is limited in the PCIe bus. (Araya-Polo et al., 2010). Dussaud and Clapp advise to save only servel layers of the source wavefield close to the boundaries, and then loading them in the reverse propagation (Dussaud et al., 2008; Clapp). The boundary saving method can effectively reduce the amount of memory transmission to an extremely low level and save a mass of storage space. We implemented the technique in our RTM in lieu of checkpointing scheme when we propagate the source wavefield.
The cross-correlation imaging condition multiplies the source wavefield and the receiver wavefield at each time step (Claerbout, 1971). However, for complex geological structures, the cross-correlation imaging condition will produce low frequency artifacts (Kaelin and Guitton, 2006; Chattopadhyay and McMechan, 2008). Lots of work have been done to improve the image quality. Claerbout proposes cross-correlation normalized by the square of the source illumination strength to suppress the artifact close to the source (Claerbout, 1971). Kaelin et al. propose cross-correlation normalized by the square of receiver illumination strength to suppress the artifacts above the strongest reflector and to enhance the deeper reflectors (Kaelin and Guitton, 2006). Yoon et al. develop an angle-domain imaging condition using the Poynting vector to calculate the wave-propagation directions (Yoon and Marfurt, 2006). Yang et al. introduce a time gating function to weight the result of RTM and suppress the artifact in radar imaging (Yang et al., 2015). The time gating based RTM (TG-RTM) uses the prior information of surrounding media to estimate the occurring moment of dominating reflection, and thus has advantages in locating reflectors. In this work, we implement the TG-RTM.
