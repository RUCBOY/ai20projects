Network traffic classification (NTC) is a topic of extremely deep interest for internet service providers (ISPs) and network operators in order to identify the typology of data flowing in the network and mapping them to their generating applications. This knowledge is important for many reasons, including monitoring network security and network applications behavior, performing traffic engineering or Quality of Service/service Level Agreement calibration, improving knowledge of users’ traffic demands for supporting policing and prioritization mechanisms, as well as performing data collection for marketing, accounting/billing or capacity planning purposes. Reliably classifying the network traffic is also crucial for automation of network operations, where the prediction of traffic demands and flow matrices, the development of realistic traffic models (Xu et al., 2005) and the detection of anomalous behaviors (D’Angelo et al., 2015, Palmieri, 2019) for triggering autonomous reactions, become core components of modern network management frameworks. Possible actions and countermeasures associated to traffic class monitoring may include filtering/blocking unwanted flows, starting lawful interception sessions, performing rerouting or resource reallocations in presence of specific overload conditions, menaces or activities contravening the network operator’s terms of service.
There are many use cases that can be taken as examples to demonstrate the need for NTC, ranging from the ability to provide different bandwidth or QoS guarantees to traffic from different applications (chat, bulk FTP/HTTP data transfer, Peer-to-Peer (P2P) file sharing Claffy et al., 1995, Sen et al., 2004, Karagiannis et al., 2004), to the identification (and eventually blocking) of specific frauds (Palmieri et al., 2013), copyright infringement (Cheng and Lai, 2010) or malicious activities (Palmieri et al., 2011) associated to properly obfuscated traffic flows.
More precisely, in order to know what kind of traffic is flowing through their network infrastructures, by avoiding, both for privacy and scalability reasons, the deployment of excessively granular controls at the end-users level, ISPs are obliged to adopt a data-driven approach (Alshammari and Zincir-Heywood, 2008). That is, they need to extract some relevant characteristics (features) from the traffic flows, and to use such features to associate any individual flow to its generating application. In modern NTC schemes, such association is usually performed by using Machine Learning (ML), often empowered by technologies coming from the Artificial Intelligence (AI) arena. These approaches have proven to be more fast and precise compared to traditional port-based and Deep Packet inspection (DPI)-based ones as well as more immune to obfuscation techniques. However, the right choice of features to be extracted from individual or aggregated traffic observations is an extremely critical factor for the success of ML-based NTC approaches. Indeed, the individuation of features that are representative enough for successfully discriminating between different traffic types and the design of methods to be used to extract and use them assumes paramount importance for the success of any NTC approach, as well as for its implementation/operating strategy and performance. This requires considerable skills and engineering efforts, which make such task essentially bound to human activities in charge of the designers of new NTC schemes. Due to the complexity of modern networks and applications, it is also considered one of the most challenging activities in networking research.
The main aim of this work is supporting this process by mining new and more expressive, meaningful and discriminating features from the basic ones without human intervention. Accordingly, we investigate the potentiality of an autoencoder-based neural network in extracting more meaningful features to be used in NTC. We start from some elementary statistical features (referred to as basic-features) obtained by sampling over time and functionally aggregating on a window basis several traditional header-based properties, resulting in new values obtained from processing multiple consecutive packets falling within the time window occurring between two sampling points. By leveraging a novel deep neural network architecture also involving convolutional and recurrent neural networks we derive new features (referred to as spatial and temporal features) which are able to express relevant knowledge existing among the basic-features (spatial-features) and among such features as they change over time (temporal-features). These new features are able to significantly improve the ML-based classification process by capturing more deep and discriminating traffic dynamics, often associated with temporal correlations and dependencies, recurrence phenomena as well as mixed spatial–temporal patterns and trends that are not easy to be perceived at a first glance. In detail, a typical Internet traffic flow associated to a service/application may exhibit a significant variance in its evolution over time, essentially due to burstiness, observable on multiple time scales, and depending on the specific characteristics of the involved application. Thus, some specific clustering properties between basic features as well as the presence of periodic structures that better characterize the traffic type do not emerge from observations strictly bounded in a single space or time but result from the superposition of several distinct, independent and almost hidden dynamics, each related to a different combination of basic features eventually analyzed over historical trends properly scaled over time.
Accordingly, we propose a network architecture making use of an autoencoder stacked with a fully connected neural network, where the encoding functions of the autoencoder are implemented with combinations of convolutional and recurrent networks in order to mine the aforementioned spatial and temporal features, respectively. This makes it possible to extract features without using a designed engineering process, but automatically starting only from the basic-features and eliciting relevant knowledge about their more or less evident correlations over space and time. Furthermore, the derived features are more powerful and expressive due to the presence of layers into the encode–decode function of the autoencoder, including combination of convolutional and recurrent neural networks. Finally, a fully connected neural network is used to classify the traffic by using the new features extracted.
In addition, a detailed mathematical description of the different neural network architectures that can be used for the aforementioned purpose is provided in order to clarify the understanding of how each network component affects the feature extraction process.
Ultimately, the main contributions of our work can be summarized as follows:

1.A neural network based classifier is provided for near real time NTC.2.Spatial and temporal features are introduced for mining correlations among the components of a feature vector and among such vectors over time, respectively.3.These spatial and temporal features are mined by combining convolutional and recurrent neural networks with an autoencoder.4.A formal description of the overall architecture is provided in order to better motivate the approach from the theoretical point of view and improve the understanding of how each network component affects the feature extraction process.
The remaining of the paper is organized as follows. Section 2 presents the related works with particular attention to deep network solutions. A brief description of the typologies of deep neural networks employed in the proposal is given in Section 2. The description of the proposal and a detailed mathematical formalization of the proposed deep neural networks used to extract the spatial–temporal features from network traffic flows are described in Section 4. Section 5 is devoted to describe the experiments setting, results, discussion, and comparison with state-of-the-art models. Finally, conclusions and future works are the subject of Section 6.
