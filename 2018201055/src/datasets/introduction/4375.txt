Let a1,…,ak,b,n∈Z, n≥1. A linear congruence in k unknowns x1,…,xk is of the form(1.1)a1x1+⋯+akxk≡b(modn). By a solution of (1.1) we mean an ordered k-tuple of integers modulo n, denoted by 〈x1,…,xk〉, that satisfies (1.1). Let (u1,…,um) denote the greatest common divisor (gcd) of u1,…,um∈Z. The following result, proved by D. N. Lehmer [19], gives the number of solutions of the above linear congruence:
Proposition 1.1Let a1,…,ak,b,n∈Z, n≥1. The linear congruence a1x1+⋯+akxk≡b(modn) has a solution 〈x1,…,xk〉∈Znk if and only if ℓ|b, where ℓ=(a1,…,ak,n). Furthermore, if this condition is satisfied, then there are ℓnk−1 solutions.
Interestingly, this classical result of D. N. Lehmer has been recently used [4] in introducing GMMH⁎ which is a generalization of the well-known △-universal hash function family, MMH⁎.
The solutions of the above congruence may be subject to certain conditions, such as gcd⁡(xi,n)=ti (1≤i≤k), where t1,…,tk are given positive divisors of n. The number of solutions of this kind of congruence, we call it restricted linear congruence, was investigated in special cases by several authors. It was shown by Rademacher [29] in 1925 and Brauer [7] in 1926 that the number Nn(k,b) of solutions of the congruence x1+⋯+xk≡b(modn) with the restrictions (xi,n)=1 (1≤i≤k) is(1.2)Nn(k,b)=φ(n)kn∏p|n,p|b(1−(−1)k−1(p−1)k−1)∏p|n,p∤b(1−(−1)k(p−1)k), where φ(n) is Euler's totient function and the products are taken over all prime divisors p of n. This result was rediscovered later by Dixon [13] and Rearick [31]. The equivalent formula(1.3)Nn(k,b)=1n∑d|ncd(b)(cn(nd))k, involving the Ramanujan sums cn(m) (see Section 2.1) was obtained by Nicol and Vandiver [28, Th. VII] and reproved by Cohen [8, Th. 6].
The special case of k=2 was treated, independently, by Alder [1], Deaconescu [11], and Sander [32]. For k=2 the function Nn(2,b) coincides with Nagell's totient function [27] defined to be the number of integers x (mod n) such that (x,n)=(b−x,n)=1. From (1.2) one easily gets(1.4)Nn(2,b)=n∏p|n,p|b(1−1p)∏p|n,p∤b(1−2p). From (1.4) it is clear that Nn(2,0)=φ(n) and(1.5)Nn(2,1)=n∏p|n(1−2p).
Interestingly, the function Nn(2,1) was applied by D. N. Lehmer [20] in studying certain magic squares. It is also worth mentioning that the case of k=2 is related to a long-standing conjecture due to D. H. Lehmer from 1932 (see [11], [12]), and also has interesting applications to Cayley graphs (see [32], [33]).
The problem in the case of k variables can be interpreted as a ‘restricted partition problem modulo n’ [28], or an equation in the ring Zn, where the solutions are its units [11], [32], [33]. More generally, it has connections to studying rings generated by their units, in particular in finding the number of representations of an element of a finite commutative ring, say R, as the sum of k units in R; see [17] and the references therein. The results of Ramanathan [30, Th. 5 and 6] are similar to (1.2) and (1.3), but in another context. See also McCarthy [22, Ch. 3] and Spilker [35] for further results with these and different restrictions on linear congruences.
The general case of the restricted linear congruence(1.6)a1x1+⋯+akxk≡b(modn),(xi,n)=ti(1≤i≤k), was considered by Sburlati [34]. A formula for the number of solutions of (1.6) was deduced in [34, Eq. (4), (5)] with some assumptions on the prime factors of n with respect to the values ai, ti (1≤i≤k) and with an incomplete proof. The special cases of k=2 with t1=t2=1, and ai=1 (1≤i≤k) of (1.6) were considered, respectively, by Sander and Sander [33], and Sun and Yang [36]. Cohen [10, Th. 4, 5] derived two explicit formulas for the number of solutions of (1.6) with ti=1, ai|n, ai prime (1≤i≤k). Jacobson and Williams [16] gave a nice explicit formula for the number of such solutions when (a1,…,ak)=ti=1 (1≤i≤k). Also, the special case of b=0, ai=1, ti=nmi, mi|n (1≤i≤k) is related to the orbicyclic (multivariate arithmetic) function [21], which has very interesting combinatorial and topological applications, in particular in counting non-isomorphic maps on orientable surfaces (see [3], [21], [23], [24], [37], [40]). The problem is also related to Harvey's famous theorem on the cyclic groups of automorphisms of compact Riemann surfaces; see Remark 3.14.
The above general case of the restricted linear congruence (1.6) can be considered as relevant to the generalized knapsack problem (see Remark 3.12). The knapsack problem is of significant interest in cryptography, computational complexity, and several other areas. Micciancio [25] proposed a generalization of this problem to arbitrary rings, and studied its average-case complexity. This generalized knapsack problem, proposed by Micciancio [25], is described as follows: for any ring R and subset S⊂R, given elements a1,…,ak∈R and a target element b∈R, find 〈x1,…,xk〉∈Sk such that ∑i=1kai⋅xi=b, where all operations are performed in the ring.
In the one variable case, Alomair et al. [2], motivated by applications in designing an authenticated encryption scheme, gave a necessary and sufficient condition (with a long proof) for the congruence ax≡b(modn), with the restriction (x,n)=1, to have a solution. Later, Grošek and Porubský [15] gave a short proof for this result, and also obtained a formula for the number of such solutions. In Theorem 3.1 (see Section 3) we deal with this problem in a more general form as a building block for the case of k variables (k≥1).
In Section 3, we obtain an explicit formula for the number of solutions of the restricted linear congruence (1.6) for arbitrary integers a1,t1,…,ak,tk,b,n (n≥1). Two major ingredients in our proofs are Ramanujan sums and the discrete Fourier transform (DFT) of arithmetic functions, of which properties are reviewed in Section 2. Bibak et al. [6] applied this explicit formula in constructing an almost-universal hash function family and gave some applications to authentication and secrecy codes.
