Graph separators are a ubiquitous tool in graph theory and computer science since they are key to many divide-and-conquer and dynamic programming algorithms. Typically, the smaller the separator the better the results obtained. For instance, many problems that are NP-complete for general graphs have polynomial time solutions for classes of graphs that have bounded size separators—that is, graphs of bounded treewidth.
By the classical result of Lipton and Tarjan [53], every n-vertex planar graph has a separator of size O(n). More generally, the same is true for every proper minor-closed graph class,4 as proved by Alon et al. [3]. While these results have found widespread use, separators of size Θ(n), or non-constant separators in general, are not small enough to be useful in some applications.
In this paper we study a type of graph separator, called layered separators, that may have Ω(n) vertices but have bounded size with respect to a different measure. In particular, layered separators intersect each layer of some predefined vertex layering in a bounded number of vertices. We prove that many classes of graphs admit such separators, and we show how (with simple proofs) they can be used to obtain logarithmic bounds for a variety of applications for which O(n) was the best known long-standing bound. These applications include nonrepetitive graph colourings, track layouts, queue layouts and 3-dimensional grid drawings of graphs.
In the remainder of the introduction, we define layered separators, and describe our results on the classes of graphs that admit them. Following that, we describe the implications that these results have on the above-mentioned applications.
1.1. Layered separationsA layering of a graph G is a partition (V0,V1,…,Vt) of V(G) such that for every edge vw∈E(G), if v∈Vi and w∈Vj, then |i−j|⩽1. Each set Vi is called a layer. For example, for a vertex r of a connected graph G, if Vi is the set of vertices at distance i from r, then (V0,V1,…) is a layering of G, called the bfs layering of G starting from r. A bfs tree of G rooted at r is a spanning tree of G such that for every vertex v of G, the distance between v and r in G equals the distance between v and r in T. Thus, if v∈Vi then the vr-path in T contains exactly one vertex from layer Vj for j∈{0,…,i}.A separation of a graph G is a pair (G1,G2) of subgraphs of G such that G=G1∪G2. In particular, there is no edge between V(G1)∖V(G2) and V(G2)∖V(G1). The order of a separation (G1,G2) is |V(G1∩G2)|.A graph G admits layered separations of width ℓ with respect to a layering (V0,V1,…,Vt) of G if for every set S⊆V(G), there is a separation (G1,G2) of G such that:•for i∈{0,1,…,t}, layer Vi contains at most ℓ vertices in V(G1∩G2), and•both V(G1)∖V(G2) and V(G2)∖V(G1) contain at most 23|S| vertices in S. Here the set V(G1∩G2) is called a layered separator of width ℓ of G[S]. Note that these separators do not necessarily have small order, in particular V(G1∩G2) can have Ω(n) vertices. For brevity, we say a graph G admits layered separations of width ℓ if G admits layered separations of width ℓ with respect to some layering of G.Layered separations are implicit in the seminal work of Lipton and Tarjan [53] on separators in planar graphs, and in many subsequent papers (such as [1], [41]). This definition was first made explicit by Dujmović et al. [24], who showed that a result of Lipton and Tarjan [53] implies that every planar graph admits layered separations of width 2. This result was used by Lipton and Tarjan as a subroutine in their O(n) separator result. We generalise this result for planar graphs to graphs embedded on arbitrary surfaces.5 In particular, we prove that graphs of Euler genus g admit layered separations of width O(g) (Theorem 13 in Section 3). A key to this proof is the notion of a layered tree decomposition, which is of independent interest, and is introduced in Section 2.We further generalise this result by exploiting Robertson and Seymour's graph minor structure theorem. Roughly speaking, a graph G is almost-embeddable in a surface Σ if by deleting a bounded number of ‘apex’ vertices, the remaining graph can be embedded in Σ, except for a bounded number of ‘vortices’, where crossings are allowed in a well-structured way; see Section 5 where all these terms are defined. Robertson and Seymour proved that every graph from a proper minor-closed class can be obtained from clique-sums of graphs that are almost-embeddable in a surface of bounded Euler genus. Here, apex vertices can be adjacent to any vertex in the graph. However, such freedom is not possible for graphs that admit layered separations of bounded width. For example, the planar n×n grid plus one dominant vertex (adjacent to every other vertex) does not admit layered separations of width o(n); see Section 5. We define the notion of strongly almost-embeddable graphs, in which apex vertices are only allowed to be adjacent to vortices and other apex vertices. With this restriction, we prove that graphs obtained from clique-sums of strongly almost-embeddable graphs admit layered separations of bounded width (Theorem 23 in Section 5). A recent structure theorem of Dvořák and Thomas [36] says that H-minor-free graphs have this structure, for each apex6 graph H. We conclude that a minor-closed class G admits layered separations of bounded width if and only if G excludes some fixed apex graph. Then, in all the applications that we consider, we deal with (unrestricted) apex vertices separately, leading to O(log⁡n) or logO(1)⁡n bounds for every proper minor-closed class. These extensions depend on two tools of independent interest (rich tree decompositions and shadow-complete layerings) that are presented in Section 6.
1.2. Queue-number and 3-dimensional grid drawingsLet G be a graph. In a linear ordering ⪯ of V(G), two edges vw and xy are nested if v≺x≺y≺w. A k-queue layout of a graph G consists of a linear ordering ⪯ of V(G) and a partition E1,…,Ek of E(G), such that no two edges in each set Ei are nested with respect to ⪯. The queue-number of a graph G is the minimum integer k such that G has a k-queue layout, and is denoted by qn(G). Queue layouts were introduced by Heath et al. [49], [50] and have since been widely studied, with applications in parallel process scheduling, fault-tolerant processing, matrix computations, and sorting networks; see [30], [61] for surveys.A number of classes of graphs are known to have bounded queue-number. For example, every tree has a 1-queue layout [50], every outerplanar graph has a 2-queue layout [49], every series-parallel graph has a 3-queue layout [63], every graph with bandwidth b has a ⌈b2⌉-queue layout [50], every graph with pathwidth p has a p-queue layout [27], and more generally every graph with bounded treewidth has bounded queue-number [27]. All these classes have bounded treewidth. Only a few highly structured graph classes of unbounded treewidth, such as grids and cartesian products [76], are known to have bounded queue-number. In particular, it is open whether planar graphs have bounded queue-number, as conjectured by Heath et al. [49], [50].The dual concept of a queue layout is a stack layout, introduced by Ollmann [59] and commonly called a book embedding. It is defined similarly, except that no two edges in the same set of the edge-partition are allowed to cross with respect to the vertex ordering (in contrast to queue layouts, which exclude nested edges in the same set). Stack-number (also known as book thickness or page-number) is bounded for planar graphs [80], for graphs of bounded Euler genus [55], and for every proper minor-closed class [7]. A recent construction of bounded degree monotone expanders by Bourgain and Yehudayoff [9], [10] has bounded stack-number and bounded queue-number; see [26], [29], [34].Until recently, the best known upper bound for the queue-number of planar graphs was O(n). This upper bound follows easily from the fact that planar graphs have pathwidth at most O(n). In a breakthrough result, this bound was reduced to O(log2⁡n) by Di Battista, Frati, and Pach [18], which was further improved by Dujmović [22] to O(log⁡n) using a simple proof based on layered separators. In particular, Dujmović [22] proved that every n-vertex graph that admits layered separations of width ℓ has O(ℓlog⁡n) queue-number. Since every planar graph admits layered separations of width 2, planar graphs have O(log⁡n) queue-number [22]. Moreover, we immediately obtain logarithmic bounds on the queue-number for the graph classes described in Section 1.1. In particular, we prove that graphs with Euler genus g have O(glog⁡n) queue-number (Theorem 32), and graphs that exclude a fixed apex graph as a minor have O(log⁡n) queue-number (Theorem 33). Furthermore, we extend this result to all proper minor-closed classes with an upper bound of logO(1)⁡n (Theorem 36). The previously best known bound for all these classes, except for planar graphs, was O(n).One motivation for studying queue layouts is their connection with 3-dimensional graph drawing. A 3-dimensional grid drawing of a graph G represents the vertices of G by distinct grid points in Z3 and represents each edge of G by the open segment between its endpoints so that no two edges intersect. The volume of a 3-dimensional grid drawing is the number of grid points in the smallest axis-aligned grid-box that encloses the drawing. For example, Cohen et al. [13] proved that the complete graph Kn has a 3-dimensional grid drawing with volume O(n3) and this bound is optimal. Pach et al. [60] proved that every graph with bounded chromatic number has a 3-dimensional grid drawing with volume O(n2), and this bound is optimal for Kn/2,n/2. More generally, Bose et al. [8] proved that every 3-dimensional grid drawing of an n-vertex m-edge graph has volume at least 18(n+m). Dujmović and Wood [31] proved that every graph with bounded maximum degree has a 3-dimensional grid drawing with volume O(n3/2), and the same bound holds for graphs from a proper minor-closed class. In fact, every graph with bounded degeneracy has a 3-dimensional grid drawing with O(n3/2) volume [33]. Dujmović et al. [27] proved that every graph with bounded treewidth has a 3-dimensional grid drawing with volume O(n). Whether planar graphs have 3-dimensional grid drawings with O(n) volume is a major open problem, due to Felsner et al. [40]. The best known bound on the volume of 3-dimensional grid drawings of planar graphs is O(nlog⁡n) by Dujmović [22]. We prove a O(nlog⁡n) volume bound for graphs of bounded Euler genus (Theorem 38), and more generally, for apex-minor-free graphs (Theorem 39). Most generally, we prove an nlogO(1)⁡n volume bound for every proper minor-closed class (Theorem 40).All our results about queue layouts are proved in Section 7, and all our results about 3-dimensional grid drawings are proved in Section 8.
1.3. Nonrepetitive graph colouringsA vertex colouring of a graph is nonrepetitive if there is no path for which the first half of the path is assigned the same sequence of colours as the second half. More precisely, a k-colouring of a graph G is a function ψ that assigns one of k colours to each vertex of G. A path (v1,v2,…,v2t) of even order in G is repetitively coloured by ψ if ψ(vi)=ψ(vt+i) for i∈{1,…,t}. A colouring ψ of G is nonrepetitive if no path of G is repetitively coloured by ψ. Observe that a nonrepetitive colouring is proper, in the sense that adjacent vertices are coloured differently. The nonrepetitive chromatic number π(G) is the minimum integer k such that G admits a nonrepetitive k-colouring.The seminal result in this area is by Thue [72], who proved in 1906 that every path is nonrepetitively 3-colourable. Nonrepetitive colourings have recently been widely studied; see the surveys [12], [44], [45]. A number of graph classes are known to have bounded nonrepetitive chromatic number. In particular, trees are nonrepetitively 4-colourable [11], [52], outerplanar graphs are nonrepetitively 12-colourable [5], [52], and more generally, every graph with treewidth k is nonrepetitively 4k-colourable [52]. Graphs with maximum degree Δ are nonrepetitively O(Δ2)-colourable [2], [25], [44], [48].Perhaps the most important open problem in the field of nonrepetitive colourings is whether planar graphs have bounded nonrepetitive chromatic number [2]. The best known lower bound is 11, due to Ochem [24]. Dujmović et al. [24] showed that layered separations can be used to construct nonrepetitive colourings. In particular, every n-vertex graph that admits layered separations of width ℓ is nonrepetitively O(ℓlog⁡n)-colourable [24]. Applying the result for planar graphs mentioned above, Dujmović et al. [24] concluded that every n-vertex planar graph is nonrepetitively O(log⁡n)-colourable. We generalise this result to conclude that every graph with Euler genus g is nonrepetitively O(g+log⁡n)-colourable (Theorem 44). The previous best bound for graphs of bounded genus was O(n), which is obtained by an easy application of the standard O(n) separator result for graphs of bounded genus. We further generalise this result to conclude a O(log⁡n) bound for graphs excluding a fixed topological minor (Theorem 49).All our results about nonrepetitive graph colouring are proved in Section 9.
