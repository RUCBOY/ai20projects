Tanglegrams are graphs obtained by taking two binary rooted trees with the same number of leaves and matching each leaf from the tree on the left with a unique leaf from the tree on the right. This construction is used in the study of cospeciation and coevolution in biology. For example, the tree on the left may represent the phylogeny of a host, such as gopher, while the tree on the right may represent a parasite, such as louse [14], [22, page 71]. One important problem is to reconstruct the historical associations between the phylogenies of host and parasite under a model of parasites switching hosts, which is an instance of the more general problem of cophylogeny estimation. See [22], [23], [24] for applications in biology. Diaconis and Holmes have previously demonstrated how one can encode a phylogenetic tree as a series of binary matchings [7], which is a distinct use of matchings from that discussed here.
In computer science, the Tanglegram Layout Problem (TL) is to find a drawing of a tanglegram in the plane with the left and right trees both given as planar embeddings with the smallest number of crossings among (straight) edges matching the leaves of the left tree and the right tree [2]. These authors point out that tanglegrams occur in the analysis of software projects and clustering problems.
In this paper, we give the exact enumeration of tanglegrams with n matched pairs of vertices, along with a simple asymptotic formula and an algorithm for choosing a tanglegram uniformly at random. We refer to the number of pairs of matched vertices in a tanglegram as its size. Furthermore, two tanglegrams are considered to be equivalent if one is obtained from the other by replacing the tree on the left or the tree on the right by isomorphic trees. For example, in Fig. 1, the two non-equivalent tanglegrams of size 3 are shown.Download : Download full-size imageFig. 1. The tanglegrams of size 3.
We state our main results here postponing some definitions until Section 2. The following is our main theorem. Theorem 1The number of tanglegrams of size n istn=∑λ∏i=2ℓ(λ)(2(λi+⋯+λℓ(λ))−1)2zλ, where the sum is over binary partitions of n and zλ is defined by Equation (1).
The first 10 terms of the sequence tn starting at n=1 are1,1,2,13,114,1509,25595,535753,13305590,382728552, see [21, A258620] for more terms.
ExampleThe binary partitions of n=4 are (4), (2,2), (2,1,1) and (1,1,1,1), sot4=14+328+32⋅124+52⋅32⋅1224=13 as shown in Fig. 2. It takes a computer only a moment to computet42=33889136420378480492869677415186948305278176263020722832251621520063757 and under a minute to compute all 3160 integer digits of t1000 using a recurrence based on Theorem 1 given in Section 6.Download : Download full-size imageFig. 2. The 13 tanglegrams of size 4.
We use the main theorem to study the asymptotics of the sequence tn. It turns out thattnn!∼e184n−1πn3, see Corollary 8 for an explanation and better estimates.
A side result of the proof is a new formula for the number of inequivalent (i.e., non-isomorphic) binary trees, called the Wedderburn–Etherington numbers [21, A001190].
Theorem 2The number of inequivalent binary trees with n leaves isbn=∑λ∏i=2ℓ(λ)(2(λi+⋯+λℓ(λ))−1)zλ, where the sum is over binary partitions of n.
A tangled chain is an ordered sequence of k binary trees with matchings between neighboring trees in the sequence. For k=1, these are inequivalent binary trees, and for k=2, these are tanglegrams, so the following generalizes Theorem 1, Theorem 2.
In terms of computational biology, tangled chains of length k formalize the essential input to a variety of problems on k leaf-labeled (phylogenetic) trees (e.g. [28]).
Theorem 3The number of ordered tangled chains of length k for n is∑λ∏i=2ℓ(λ)(2(λi+⋯+λℓ(λ))−1)kzλ, where the sum is over binary partitions of n.
ExampleFor n=k=3, we have partitions (2,1) and (1,1,1), and the theorem gives132+33⋅136=5, as shown in Fig. 3. For k=3, the number of tangled chains on trees with n leaves gives rise to the sequence starting1,1,5,151,9944,1196991,226435150,61992679960,23198439767669,11380100883484302. See [21, A258486] for more terms.Download : Download full-size imageFig. 3. The tangled chains of length 3 for n = 3.
From the enumerative point of view, it is also quite natural to ask how likely a particular tree T is to appear on one side or the other of a uniformly selected tanglegram. In Section 7, we give a simple explicit conjecture for the asymptotic growth of the expected number of copies of T on one side of a tanglegram as a function of T and the size of the tanglegram. For example, the cherries of a binary tree are pairs of leaves connected by a common parent. We conjecture that the expected number of cherries in one of the binary trees of a tanglegram of size n chosen in the uniform distribution is n/4.
Further discussion of the applications of tanglegrams along with several variations on the theme are described in [20]. In particular, tanglegrams can be used to compute the subtree-prune-regraft distance between two binary trees. In a recent follow up paper, Gessel has used the formula given here for binary trees to count several variations on tanglegrams using the theory of species [13].
The paper proceeds as follows. In Section 2, we define our terminology and state the main theorems. We prove the main theorems in Section 3. Section 4 contains an algorithm to choose a tanglegram uniformly at random for a given n. In Section 5, we give several asymptotic approximations to the number of tanglegrams with increasing accuracy and complexity. In Section 6, we give a recursive formula for both the number of tanglegrams and for tangled chains. We conclude with several open problems and conjectures in Section 7.
