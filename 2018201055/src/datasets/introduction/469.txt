As a simple and non-invasive treatment with the minor side effect, Traditional Chinese Medicine (TCM) plays a significant role in health-care for several thousand years. It is widely used in China and numerous Asian countries [1], [2]. Therefore, there are lots of researches on TCM investigated to perform auxiliary diagnosis and treatment using the advanced techniques, such as image processing methods [3] and newly proposed deep learning methods [4]. Chinese herbs, as a part of TCM, have excellent performance on not only the treatment of the diseases but also the physical conditioning with the guidance of the theoretical system of TCM, so that they have gradually become a part of people’s life. However, due to a lack of professional equipment and knowledge, it is difficult for non-professionals to recognize Chinese herbs accurately so that Chinese herbs recognition tools are heavily expected. However, to the best of our knowledge, there is no research on this task currently. As there is no available Chinese herbal image dataset at present, Chinese herbal recognition seems much tricky, even if there are many excellent machine learning methods available, such as excellent deep convolution neural networks (CNNs) for visual object recognition [5] and detection [6], [7], [8]. Therefore, this paper begins with constructing a new Chinese herbal image dataset.
Chinese herbal recognition differs from both the regular image recognition  [9] and the fine-grained image recognition [5], where the former focuses on global semantic information such as the outline and shape, while the latter needs the more detailed local information. Chinese herbal recognition is confronted with two problems: (1) Some Chinese herbs, belonging to different species, are easy to be classified by the global shape features, as shown in Fig. 1. For example, Fructus Amomi and Liquorice are much different in global shape so that they can be easily classified using the shape features. (2) There are some other Chinese herbs with similar shapes belonging to the same species, requiring the more fine-grained features for the recognition, such as Croton and Cocklebur Fruit in Fig. 1, which have only a few differences in details. Therefore, the recognition granularity of inter-species differs from intra-species, where the former is easier to be classified than the latter. Thus we convert Chinese herbal recognition to a multi-granularity task. Generally, it is hard to take into account the above two cases when we only use the single-scale features, as the regular CNNs cannot detect the scale adaptively. Therefore, we need to consider multi-scale features and adaptively emphasize the corresponding scales that are efficient for different herbs, since features with different scales indicate the different granularity.Download : Download high-res image (5MB)Download : Download full-size imageFig. 1. Examples of main species in CNH-98. The blue box represents an example of the Species and the red box indicates an examples of the Class. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)
If CNNs are used, the features extracted from the convolution layers of different depth are rich in diversity. It is empirically confirmed that the features of the shallower layer contain both more details and spatial information due to the smaller convolution receptive field and high resolution, while the features of the deeper layer are more global and semantic in contrast [10]. They can be illustrated in Fig. 2 and the representation visualization [11]. To consider these two cases simultaneously, the pyramid structure of Feature Pyramid Networks [12] (FPN) can naturally leverage ConvNet’s pyramid feature hierarchy to aggregate features with different scales from a variety of levels. Namely, the pyramid structure of FPN can fuse semantic and spatial information [10] required by multi-granularity recognition task like Chinese herbal recognition.Download : Download high-res image (380KB)Download : Download full-size imageFig. 2. Feature maps from various layers of CNN, where feature maps are extracted from four levels of ResNet-18 to form a feature pyramid. It can be seen that the features from different layers of networks are diverse.
FPN is designed for object detection, which attaches predictors to all RoIs of all levels. However, when it is applied to the recognition task that requires multi-scale features, we have to feed the features of all levels into one classifier. In this way, it is much possible to generate a large number of redundant features, making it difficult to optimize the network during training. In such a case, some efficient features are expected to be selected. On the other hand, FPN implies a strong constraint that features from the adjacent levels are combined in a fixed way, which easily leads to inefficient fused features for samples with different granularity. Furthermore, its networks cannot dynamically adjust weights of features from different levels. In order to overcome these disadvantages, this paper proposes a new Attentional Pyramid Networks (APN) for Chinese herbal recognition, where both novel Competitive Attention (CA) and novel Spatial Collaborative Attention (SCA) are proposed and then applied. In this way, APN can obtain the more efficient fused features and adaptively model Chinese herbal images with different feature scales.
As a kind of channel-wise attention mechanism based on SENet [13], CA can automatically select features of different levels for different samples in a soft way when aggregating features of different levels. SE in SENet is limited to re-scaling weights of features from the single layers and single information stream, while the proposed CA extends the modelling ranges of channel-wise attention and spatial attention to multiple streams. It explicitly models the channel dependencies in the process of across-level features fusion, indicating an implicit competition between spatial and semantic information streams. On the other hand, channel-wise attention solely considers relatively the global information for each feature map, but we need to dynamically trade off the global and local information across different levels. Local details are usually reflected by the spatial dimension, so that the proposed SCA is based on the spatial attention [14] by collaboratively learning from information streams of different levels. It can collaboratively trade-off the global and local information of features from different levels and mutually complement for each other in the process of spatial attentional modelling. The competition and trade-off can help the pyramid network produce fused features that are more efficient for the multi-granularity task. SCA has two versions. One is parameter-free, which solely exploits the global descriptor of each channel to model spatial relations and ignores spatial clues between various channels. However, it is generally known that feature maps of the different channels tend to focus on the different spatial regions. Some pay attention to the global information such as the background and shape, while others to the local details like texture, which can be observed from the representation visualization [11]. Therefore, there may be a certain spatial correlation between different channels [15], which should not be neglected. Parametric SCA can be applied to deal with this issue, which can spatially capture the global and local complementary relationship between a variety of channels achieved by parametric filters. Obviously, both CA and SCA are easily extended to other neural networks with feature fusing on multiple information streams. Also, APN can be generalized to similar multi-granularity recognition tasks. In summary, several novel contributions are presented as follows:
1.A new standard Chinese-Herbs dataset is constructed, which not only supports Chinese herbal recognition but also supports the research of machine learning methods.2.A new Attentional Pyramid Networks (APN) for Chinese herbal recognition is proposed, where both novel competitive attention and novel spatial collaborative attention are proposed and then applied. APN can obtain the more efficiently fused features and adaptively model Chinese herbal images with different feature scales.3.The proposed CA can selectively place different emphasis on the features of different level for the multi-granularity task whereas SCA can adaptively quantify the importance of each image region. Furthermore, two variants of SCA are proposed to obtain the more effective performance.4.As an application, a new framework with APN for Chinese herbal recognition is proposed. Experimental results on our constructed dataset validate the effectiveness and the superior performance of our methods.
