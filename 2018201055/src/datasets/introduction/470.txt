1.1. Background and motivationDataset bias between the training and test datasets is a key research issue in pattern recognition. Recently, unsupervised domain adaptation [1], [2] has shown to be an effective approach to improve the generalization ability of a recognition model in an unlabeled test dataset. The model learned from the training dataset (source domain) is adapted to the test dataset (target domain) by instance selection [3], model refinement [4] or representation adaptation [5], [6]. Among these approaches, representation adaptation holds the benefit of avoiding the label prediction for target data, so that the prediction errors in the target domain would not be introduced in the process of domain adaptation. Hence, many representation adaptation methods [1], [7] have been proposed to learn the domain-invariant features by aligning data distributions across the source and target domains. Source label information is then propagated to the target domain via the aligned features.In the representation learning, the geometry [8] that reflects the neighborhood relationship within a dataset is important information. Thus it has been widely used as a guide for learning discriminative features of a single dataset in manifold learning [9]. However, when learning feature representations across domains, most existing representation adaptation methods [1], [10] ignore and break the geometry information. Consequently, the source and target feature distributions could not be fully aligned, as they have different geometries. A few adaptation methods [7], [11] realize the importance of geometry information, and they propose preserving the geometry of each domain during the distribution alignment. These methods assume that the source and target domains share the similar underlying manifolds, so that source and target features are distributed with similar geometries by the geometry preservation in each domain.Although better adaptation is achieved with the geometry preservation strategy, the above-mentioned assumption may be invalid in practical applications. It is because the assumption of similar underlying manifolds is based on the condition that different datasets share the same underlying modes of variability with the same degree of variations. But this condition is difficult to guarantee in practice. For example, in Fig. 1(a), human images in the source domain have similar poses, but the illumination conditions are different. In contrast, images in the target domain are taken under similar illumination conditions, but they are different in human pose. Therefore, the source-domain geometry records the sample similarities in illumination, while the geometry of the target domain reflects the pose differences among target samples. In addition, the degree of pose/illumination variations is difficult to control in practice, and thus it is probably different in different datasets. In these cases, the geometries of the underlying manifolds are different in different domains, and source and target geometries remain mismatched in the feature space by preserving geometry in each domain. Furthermore, the preservation of geometry would even conflict with the cross-domain feature alignment, when the geometries are inconsistent across domains. As illustrated in Fig. 1(a), source and target data are relying on different manifolds. The geometry of one or two domains needs to be broken to obtain fully adaptation between source and target representations. In contrast, source and target geometries are unchanged if we keep both source and target data embedded in the manifold of each domain. But in this way, the source and target data could not be aligned. In other words, geometry preservation leads to a poor performance of adaptation.Download : Download high-res image (961KB)Download : Download full-size imageFig. 1. Rationale of the proposed method (a) Examples of datasets with different geometries. The geometries in the source and target domains are different because of the difference in variability mode. The representation adaptation and geometry preservation conflict with each other. (b) Illustration of learning adaptive geometry for unsupervised geometry alignment. (Best view in color).
1.2. Rationale and contributionsAccording to the above analysis, this paper argues that data are distributed with different geometry structures [8] in different domains. We propose aligning both feature representations and geometries across domains for unsupervised domain adaptation. As many representation alignment methods [10], [12] have been proposed and achieved good performance, this paper focus on modeling the cross-domain geometry alignment. In unsupervised domain adaptation, the source and target geometries could not be directly matched, because the corresponding relations between source and target data are unknown without target labels. Thus unsupervised geometry alignment becomes a major challenge. Unsupervised graph matching algorithms [13] have been proposed to handle this problem by estimating the corresponding pairs of source and target data. But these methods do not work well for our problem, because the one-to-one corresponding relations are difficult to estimate in unsupervised domain adaptation. Moreover, the corresponding data of a target sample may not exist in the source domain in practice. Under this scenario, the unsupervised graph matching methods are infeasible. Other methods [14], [15] regard the geometry information as auxiliary features in the representation, and align the source and target geometries by reducing the Maximum Mean Discrepancy (MMD). But the geometry information that reflects the data relationship is not representative and distinguishable enough, especially in the target domain without labels. Hence, this direct alignment of geometries across domains has limited help to domain adaptation.To overcome the above limitations, rather than direct geometry matching, this paper learns a domain-adaptive geometry for unsupervised geometry alignment. As shown in Fig. 1(b), an adaptive geometry is derived from the label space, in order to relax the need of source-target correspondences for geometry alignment. We consider the problem of close-set domain adaptation, where the source and target domains have the same recognition tasks and share the categories of labels. Therefore, the label space is shared across domains, and the derived geometry is domain-adaptive. In specific, we design the unified geometry criteria based on the domain-shared label information to learn the adaptive geometry. These unified criteria restrict that values of the source and target geometries should be minimized or approach to a fixed distance. Source and target geometries are aligned by constraining with the unified criteria of adaptive geometry. In the source domain, the geometry alignment is guided by the source labels, while the target-domain geometry alignment is approximated by maximizing class discrepancy and preserving the target-domain geometry information.In this paper, we develop a geometry-aware dual-stream network to achieve the objective of aligning both representations and geometries across domains. In this network, the representation alignment is obtained by an adversarial adaptation network. On the other hand, discrepancy losses that refer to the unified criteria of adaptive geometry are employed for unsupervised geometry alignment. Moreover, the target-domain geometry is constrained by a geometry consistency loss to omit the arbitrary mapping of target data in unsupervised geometry alignment.The contributions of this paper can be summarized as•We identify the problem of geometry difference in different datasets, and propose an idea of geometry alignment to address the cross-domain geometry difference in unsupervised domain adaptation.•We propose learning the adaptive geometry to obtain the geometry alignment without target labels. The adaptive geometry is derived from the domain-shared label space, so that no label information is required in the target domain. Source and target geometries are aligned by meeting the criteria of the adaptive geometry.•We develop a geometry-aware dual-stream network to learn source and target features that are distributed with similar representations and unified geometry structures. In this network, unified criteria are designed as discrepancy losses for geometries in both source and target domains to learn the adaptive geometry.The preliminary version of this paper [16] has been published in an international conference. The major differences between the conference version and this paper include•The distribution difference between the source and target domains is discussed and analyzed from manifold aspect. The concept of geometry is introduced and new formulas are derived to represent the structures of data distributions in the source and target domains.•Adaptive geometry is learned to obtain geometry alignment without target labels for unsupervised domain adaptation. We also provide theoretical derivations and optimization processes to learn the adaptive geometry.•More experiments are conducted on challenging datasets. We also perform ablation study and stability analysis to further show the performance of the proposed method.The rest of this paper is organized as follows. Section 2 gives a review on unsupervised domain adaptation. The adaptive geometry learning algorithm is discussed and reported in Section 3. Experimental results are presented in Section 4, and a conclusion will be given in Section 5.
