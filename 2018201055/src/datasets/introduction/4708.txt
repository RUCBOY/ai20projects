Cloud computing provides fundamental support to address the challenges with shared computing resources including computing, storing, networking and analytical software. The application of these resources has fostered impressive Big Data advancements  [1], [2] and Internet of Things (IoT). Because of the wide range of applications, people have paid more attention to cloud security for data management, data storing, and data processing in recent decades. Recently, deep learning has made impressive success in a wide range of applications, such as bioinformatics, image processing, game playing, natural language processing, computer security etc. On the other hand, in order to get an accurate result without over-fitting, deep learning requires a lot of training records to determine tens of thousands of parameters. In many cases, the massive amount of training data cannot be provided by one single user, but collected from different users. The trend is to have these huge datasets stored in an untrusted third-party cloud system in encrypted form due to the confidentiality and sensitivity of the datasets.
To also leverage the computing ability provided by the cloud platform, more and more applications choose to conduct the deep learning on the cloud platform. In fact, if the amount of training records is huge, it is difficult, to download all records by a single user for processing. This poses a new challenge to the community, i.e., how to perform deep learning over outsourced encrypted data owned by multiple users in cloud. In this paper, we consider to develop a multi-key privacy-preserving deep neural network in cloud over encrypted data. The key challenges include (1) Data are located in different places and encrypted with different keys. To protect data privacy, all computation (e.g. inner product and the approximation of nonlinear sigmoid function used in deep learning), intermediate results generated during the deep learning process and the learning results must be secure. (2) To improve the efficiency of the deep learning process, computation should be done by the cloud server so as to decrease the computation/communication cost of the data owner(s). Existing solutions such as secure multi-party computation (SMC)  [3], encryption schemes, garbled circuit, and detective controls were designed for other scenarios and cannot be applied directly to tackle these two challenges.
Our Contributions. To solve the above challenges, this paper designs two schemes to support multi-key learning system. Both schemes allow multiple data owners with different datasets to collaboratively learn a neural network model securely in cloud computing. To protect the confidentiality, data owners encrypt their sensitive data with different public keys before uploading to cloud server.
We first propose a basic scheme which is based on multi-key fully homomorphic encryption (MK-FHE)  [4], [5], [6]. In this scheme, multiple data owners send their data (encrypted with different public keys chosen by data owners independently of each other) to an untrusted cloud server. Cloud server computes the output of deep learning on this joint data and issues it back to all participating data owners. Finally, all of the data owners jointly perform a secure SMC protocol to decrypt and extract results from this encrypted deep learning results.
To avoid the interaction among multiple data owners, we further propose an advanced scheme which is based on a hybrid structure by combining the double decryption mechanism (BCP scheme  [7]) and fully homomorphic encryption (FHE)  [8]. If we only use BCP scheme to support the secure computation, in the training phase, both the computation of inner product of the inputs and weights, and the computation of the activation function require additional communication with the cloud server. To solve this challenge, we introduce FHE scheme directly by transforming BCP ciphertext into FHE ciphertext, such that the computations over FHE ciphertext can be realized without interaction. In this scheme, a cloud server C and an authorized center (a trusted third party) AU are queried, which is assumed to be non-colluding and honest-but-curious. The cloud server C keeps the encrypted datasets under different public keys uploaded by multiple data owners. The authorized center AU, on the other hand, only holds the master key of the master decryption of BCP scheme and the private key of FHE. In this paper, all participants are assumed to be honest-but-curious.
In summary, our contributions can be summarized as follows: 
•We address a multi-key privacy-preserving deep learning in cloud computing by proposing two schemes, which allow multiple data owners to conduct collaboratively privacy-preserving deep learning.•Our multi-key privacy-preserving deep learning schemes are able to preserve the privacy of sensitive data, intermediate results as well as the training model.•We provide a security analysis to guarantee the privacy-preserving of our proposed two schemes.•We give an application of our advanced scheme in face recognition. Note that our solutions are generic and can be applied to perform many other machine mining with the same setting over the same setting.
Organization. The rest of this paper is organized as follows. In Section  2, we briefly discuss the related work. Some notations, including deep learning, stochastic gradient descent, BCP scheme, FHE, and MK-FHE will be described in Section  3. We give the system model definition and describe the details of our privacy-preserving deep learning system in Section  4 and Section  5, respectively. Section  6 shows the complexity and security analysis for the proposed system. And we give an application in our system in Section  7. Finally, we conclude the paper in Section  8.
