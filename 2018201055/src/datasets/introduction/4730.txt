Actively propagating worms are self-replicating computer programs that penetrate computer networks with the intent of spreading malicious code. Attacks of network worms, especially new ones, using previously unknown (zero-day) vulnerabilities of the targeted systems, are a significant threat to the computer network users [1], [2]. According to Symantec's recent estimates [3], the number of zero-day vulnerabilities discovered in 2015 more than doubled from the year before. The worms propagate quickly in large, interconnected and vulnerable systems [4], [5]. Standard passive security measures like authorization and access control are not a sufficient protection against the growing number of new threats [1], [6], [7]. One of the basic approaches to defend against actively propagating network threats is detection and prevention by IDS/IPS devices (Intrusion Detection/Prevention System). The current systems employ one or both of the following techniques [4], [6]:
•anomaly analysis, identifying threats by detecting deviations from a known normal profile of network activity in the monitored network,•using pre-generated rules (patterns, signatures) to detect malicious content in network flows.
Using anomaly detection requires generating a normal profile of traffic in the monitored network. Data exploration and knowledge discovery techniques are used for this purpose [5], [8], [9], discovering hidden relations and increasing the effectiveness of the method. However, this approach is very difficult to incorporate in large networks with highly variable traffic patterns – the normal profile of such a network is complex and changes relatively quickly. Therefore, the anomaly analysis requires cumbersome recalculations.
Another approach is to employ pre-generated signatures to detect network threats. In this paper we consider a worm signature as a formal description of a network threat based solely on the synthetic information. The signature is composed of tokens. A token is a commonly occurring string of bytes in the threat payload. The position of every token in the signature may be restricted. The strict definitions of the signature and the token are provided in Appendix A. The signature based approach is faster, less compute-intensive and very effective against known threats [6], [10]. Unfortunately, new attacks, for which no signatures are available, will not be detected using this technique. Therefore, it is very important to minimize the time needed to identify a new attack, create a signature and include it in the IDS rule sets.
Generation of a signature is a difficult task, usually performed manually by experts who analyse the attack, identify invariant fragments in the involved flows using their understanding of the attacked application and exploited vulnerability and construct the signature which – due to the involved knowledge – fully identifies the threat. However, for actively propagating worms this approach is too slow. Creation of a signature often requires hours or even days of work, while observations show that by that time over 90% of vulnerable systems will already be infected. The time limit for signature generation for active worms is measured in minutes, at most. Therefore, automated signature generation tools are necessary to provide a working signature as soon as a new attack appears. These systems work by searching for common features of suspicious flows, not seen in normal, benign traffic. Automatically generated signatures may be used to limit propagation of new threats in early phase, until manually created signatures are ready to be included in the rule sets permanently.
The problem considered in this paper is the automatic generation of signatures of zero-day polymorphic worms. A polymorphic worm is a network threat that is able to change its payload as the part of the spreading process. This may be achieved by using semantics-preserving code manipulation techniques or self-encryption mechanisms. As a consequence, replications of a polymorphic worm might not share a common invariant substring of a suitable length. Therefore most existing intrusion detection systems are not able to distinguish the manifestation of a worm outbreak in the network stream containing a copy of a polymorphic worm. In general, the nature of the polymorphic behaviour increases the complexity of the signature generation process. According to Kaur and Singh [11] polymorphic worms are the most effective attacks that avoid detection.
We have designed and developed a system Hindsight for automatic offline generation of signatures of polymorphic worms. Our framework implements an efficient algorithm for token extraction and a novel method for multi-token signature composition that uses stochastic optimization for calculating signatures accurately matching network worms.
The paper is organized as follows. The signature based approaches to intrusion detection in computer networks are presented in Section 2. Section 3 discusses the problem of signature generation in detail, giving a formal statement of our solution and proposed computing scheme. In Section 4 the algorithm for token extracting from data flows is discussed. The evolutionary based approach to calculation of network threat signatures is presented in Section 5. Section 6 describes the design and development of the software platform Hindsight for automatic offline generation of network threats signatures. The results of validation of our platform through simulation experiments are presented in Section 7. Section 8 discusses the possibility of using HPC infrastructure to increase the performance of the Hindsight system. The paper is concluded in Section 9. In Appendix A all necessary definitions are provided.
