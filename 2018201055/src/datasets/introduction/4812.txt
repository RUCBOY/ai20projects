Pattern avoidance is a central topic in graph theory and combinatorics [2], [7], [14], [16], [18], [21], [24], [25], [26]. In this paper, we study d-dimensional matrices (or arrays) with only two distinct entries, 0 and 1, that avoid certain patterns. We are interested in the extremal problem of finding the largest number of ones in these matrices.
The extremal theory of matrices was initiated in papers [1], [9], [22] around 1990 to study specific problems arising in computational and discrete geometry. Mitchell produced an algorithm for computing a shortest rectilinear path avoiding rectilinear obstacles in the plane [22]. He showed that the complexity of this algorithm is bounded above by the solution of the extremal problem of certain matrices. Bienstock and Győri [1] found an upper bound on the solution of the extremal problem, thus bounding the complexity of the algorithm. Mitchell’s algorithm can be directly applied to motion planning in robotics and wire routing in VLSI circuit design [20]. Füredi [9] used the extremal problem to derive an upper bound on Erdős–Moser [4] problem of determining the maximum number of unit distances in a convex polygon.
Matrix extremal problems also find applications to graph theory and other areas of combinatorics. If we associate 2-dimensional 0-1 matrices with ordered bipartite graphs by relating rows and columns to the two ordered partite sets of vertices and interpreting ones as edges, then this extremal problem can be viewed as the Turán extremal problem for ordered bipartite graphs [23]. The most recent surge in interest in the extremal theory of matrices is due to the resolution of the Stanley–Wilf conjecture in enumerative combinatorics using the extremal problem of matrices [17], [21].
We denote a d-dimensional n1×⋯×nd matrix by A=ai1,…,id, where 1≤il≤nℓ for ℓ=1,2,…,d. Matrix A is called a 0-1 matrix if all its entries are either 0 or 1. A multidimensional matrix is also called a multidimensional array in computer science. We may view a d-dimensional 0-1 matrix A=ai1,…,id geometrically as a d-dimensional rectangular box of lattice points with coordinates (i1,…,id). An ℓ-cross section of matrix A is the set of all the entries ai1,…,id whose ℓth coordinates have the same value. An ℓ-row of matrix A is the collection of all the entries ai1,…,id whose coordinates other than the ℓth coordinate have fixed values.
A d-dimensional k×⋯×k zero–one matrix is a permutation matrix if each of its ℓ-cross sections contains exactly one nonzero entry for every ℓ=1,…,d. The Kronecker product of two d-dimensional 0-1 matrices M and N, denoted by M⊗N, is a d-dimensional matrix obtained by replacing each 1-entry of M with a copy of N and each 0-entry of M with a zero matrix the same size as N.
We say that a d-dimensional 0-1 matrix A contains another 0-1 matrix P if A has a submatrix that can be transformed into P by changing any number of ones to zeros. Otherwise, A is said to avoid P. Denote by f(n,P,d) the maximum number of ones in a d-dimensional n×⋯×n zero–one matrix that avoids a given d-dimensional 0-1 matrix P. We are interested in the asymptotic behavior of the extremal function f(n,P,d) for large n.
A motivation to study the extremal problem of multidimensional matrices comes from graph theory. A 2-dimensional n×n zero–one matrix can be represented as an ordered bipartite graph with partite sets of size n. Similarly, a d-dimensional 0-1 matrix corresponds to an ordered d-partite, d-uniform hypergraph. The extremal function f(n,P,d) is the maximum number of hyperedges in an ordered d-partite, d-uniform hypergraph where each partite set has n vertices. Avoiding a given pattern P amounts to avoiding the corresponding ordered hypergraph.
It is easy to obtain trivial lower and upper bounds on f(n,P,d).
 Proposition 1.1If P is a 0- 1 matrix that contains at least two ones, then nd−1≤f(n,P,d)≤nd. 
 ProofWe can always choose a d-dimensional n×⋯×n zero–one matrix A, with 1-entries on a single ℓ-cross section for some ℓ and 0-entries elsewhere, such that A avoids P. Matrix A has exactly nd−1 ones, so the left inequality follows.The right inequality follows from the fact that every d-dimensional n×⋯×n zero–one matrix has a total of nd entries and that the matrix hence has at most nd ones.  □ 
The upper bound in Proposition 1.1 is one order higher than the lower bound. The main problem is to improve the lower and upper bounds on f(n,P,d) so that their orders are as close as possible.
The two-dimensional case of d=2 has been well studied. Füredi and Hajnal conjectured that f(n,P,2)=O(n) for all permutation matrices P [10]. Klazar showed that this conjecture implies the Stanley–Wilf conjecture [17]. Marcus and Tardos proved the Füredi and Hajnal conjecture [21] and hence settled the Stanley–Wilf conjecture. Keszegh conjectured that f(n,P,2)=O(n) for all tuple permutation matrices P [15]. Geneson proved that the conjecture is true [11].
When R is a k1×k2 matrix of all ones, the extremal problem for f(n,R,2) is the matrix version of the classical Zarankiewicz problem. Kővári, Sós, and Turán found an upper bound O(n2−max(k1,k2)k1k2) on f(n,R,2) [19]. A lower bound Ω(n2−k1+k2−2k1k2−1) was also known [5]. Hesterberg extended these bounds to f(n,P⊗R,2) where P is a permutation matrix [12], [13].
Pach and Tardos showed that f(n,P,2) is super-additive in n [23]. When P is a permutation matrix, the sequence {f(n,P,2)n} is bounded because of f(n,P,2)=O(n) and is therefore convergent by Fekete’s lemma on super-additive sequences [6]. The limit is known as the Füredi–Hajnal limit and has recently attracted great attention [3], [7], [8]. Cibulka [3] showed that this limit is always at least 2(k−1) when P is a k×k permutation matrix and that the limit is exactly 2(k−1) when P is the identity matrix. Fox showed that the Füredi–Hajnal limit has a lower bound 2Ω(k12) for a family of k×k permutation matrices [8]. Marcus and Tardos [21] showed that this limit has an upper bound 2O(klogk) for every k×k permutation matrix P, and Fox [7] improved this upper bound to 2O(k).
Little has been done on the multidimensional case. Klazar and Marcus [18] studied the extremal function when thed-dimensional matrix P is a permutation matrix of size k×⋯×k and found f(n,P,d)=O(nd−1), generalizing the d=2 results [21]. In particular, they showed that f(n,P,d)nd−1=2O(klogk), which is the multidimensional generalization of the Marcus and Tardos upper bound on the Füredi–Hajnal limit [21].
In this paper, we advance the extremal theory of matrices in two directions. In the first direction, we study the extremal functions f(n,R,d) and f(n,P⊗R,d), where P is a permutation matrix and R is a k1×⋯×kd matrix of ones only; matrix P⊗R is called a block permutation matrix. We show that both f(n,R,d) and f(n,P⊗R,d) have a lower bound Ω(nd−β) and an upper bound O(nd−α), where α=max(k1,…,kd)k1⋅k2⋅⋯⋅kd and β=k1+⋯+kd−dk1⋅k2⋅⋯⋅kd−1. These bounds significantly improve the trivial ones given in Proposition 1.1.
Both the lower bound Ω(nd−β) and the upper bound O(nd−α) are in the same order as Θ(nd−1) whenever α=β. This is exactly when only one of k1,…,kd of R is larger than 1; the corresponding P⊗R is called a tuple permutation matrix.
When α≠β, our results on f(n,R,d) generalize the Kővári–Sós–Turán upper bound [19] from two dimensions to higher dimensions. Our results on f(n,P⊗R,d) also extend Hesterberg’s results [12] from d=2 to d>2.
When α=β, our result that f(n,P,d)=Θ(nd−1) for every d-dimensional tuple permutation matrix P, on one hand, generalizes Geneson’s result [11] from d=2 to d≥2. On the other hand, even when d=2 our ideas improve some key calculations in Geneson’s paper [11]. These improvements are vital in our derivation of a new upper bound on the limit superior of the sequence {f(n,P,d)nd−1} that we discuss below.
The importance of our result f(n,P,d)=Θ(nd−1) for every d-dimensional tuple permutation matrix P lies in the fact that, in view of Proposition 1.1, Θ(nd−1) is the lowest possible order for the extremal function of any nontrivial d-dimensional matrix.
In the second direction, we study the limit inferior and limit superior of the sequence {f(n,P,d)nd−1} where P satisfies f(n,P,d)=Θ(nd−1). These are the multidimensional analogues of the Füredi–Hajnal limit. We show that the limit superior is bounded above by 2O(k) for all k×⋯×k permutation matrices P. This is a substantial improvement of Klazar and Marcus upper bound 2O(klogk) for d>2 in paper [18] and it also generalizes Fox’s bound 2O(k) on the Füredi–Hajnal limit in two dimensions [7]. We further show that this upper bound 2O(k) is also true for every tuple permutation matrix P, which is a new result even for d=2. We are able to extend the new upper bound from permutation matrices to tuple permutation matrices mainly because of our improvement of Geneson’s approach as mentioned above.
Finally, we show that the limit inferior of the sequence {f(n,P,d)nd−1} is at least d(k−1) for k×⋯×k permutation matrices, generalizing Cibulka’s result [3] from d=2 to all d≥2. We further show that the limit inferior has a lower bound 2Ω(k1∕2) for a family of k×⋯×k permutation matrices P.
The rest of the paper is organized as follows. In Section 2, we study f(n,P,d) when P is a block permutation matrix but not a tuple permutation matrix. The more difficult case when P is a tuple permutation matrix is analyzed in Section 3. In Section 4, we study the limit inferior and limit superior of the sequence {f(n,P,d)nd−1} for permutation and tuple permutation matrices P. We conclude the paper and discuss our future directions in Section 5.
