One of the most important one-point solution concepts in the framework of coalitional games with side payments is the Shapley value (Shapley, 1953), which proposes the allocation of resources in multiperson interactions by considering the power of the players during their various opportunities for cooperation. Since the pioneering work by Shapley, the Shapley value has been studied widely from a theoretical viewpoint. Many studies have also focused on the potential applications of the Shapley value to specific problems (e.g., see Lucchetti, Moretti, Patrone, Radrizzani, 2010, Moretti, 2010). However, since computing the Shapley value is an NP-complete problem (see Deng, Papadimitriou, 1994, Fernández, Algaba, Bilbao, Jiménez, Jiménez, López, 2002, or Faigle and Kern, 1992, for more details), the problem of its calculation must be addressed before it can employed as a useful tool in real situations.
Two main approaches have been employed to address the calculation of the Shapley value: developing efficient strategies to compute the Shapley value exactly.
Different approaches have been considered for the exact calculation of the Shapley value. In order to compute the Shapley value exactly, some specific features of the problem and/or the game are assumed. For instance, the Shapley value was obtained in a polynomial manner for some voting games by Bilbao et al. (2000). (Granot et al., 2002) developed a polynomial algorithm to obtain the Shapley value of an extended tree game, where a tree network serving heterogeneous customers was constructed. (Castro et al., 2008) computed the Shapley value for an airport game in polynomial time by considering that this value was obtained using the serial cost sharing rule. In addition, Deng and Papadimitriou (1994), Bolus (2011), Chalkiadakis et al. (2012), and Conitzer and Sandholm (2006) developed efficient strategies for computing the Shapley value by finding alternative efficient representations for transferable utility (TU) games. However, although these methods aim to serve as general tools, their applications are constrained to some specific classes of games, particularly weighted majority games and combinatorial optimization games. Moreover, all of these methods require a specific representation of the game.
By contrast, few studies have focused on the approximation of the Shapley value. Considering the widespread application of game theory to real-world problems where exact solutions are often not possible, then it is necessary to develop algorithms that may facilitate this approximation.

(i)To the best of our knowledge (also see Maleki et al., 2014), the first attempt to estimate the Shapley value for a large class of games was the algorithm proposed by Castro et al. (2009), who suggested the estimation of the Shapley value (or any semivalue) for cooperative games based on sampling. The only constraint on this algorithm being polynomial is the fact that the worth of any coalition must be computed polynomially. This approach generalizes the earliest approximation method proposed by Mann and Shapley (1960) for estimating the power index of a weighted voting game. In fact, Mann and Shapley (1960) stated that: “These methods have potential applications beyond the particular problem solved here.” Moreover, as proposed in the present paper, Mann and Shapley also considered alternative sampling methods for reducing the variance of the basic Monte Carlo sampling approach.(ii)If an efficient general purpose algorithm is available, then it will be possible to estimate the Shapley value by refining the original procedure by Castro et al. in order to exploit the specific properties of the problem considered. Thus, Maleki et al. (2014) proposed the use of stratified random sampling to reduce the estimated error in the original method described by Castro et al. They also considered the same strata treated in the present paper. However, their allocation method ignores the specific features of the game, thereby resulting in an estimation method that improves the original method based on simple random sampling, but it general performs poorly compared with the refinement that we propose in the present study. The reader may refer to Section 6
for a comparative analysis using the cooperative games analyzed by Castro et al. (2009).
Few studies have developed approximations to estimate the Shapley value and most of them are problem specific. Fatima et al. (2006) presented a randomized polynomial method for determining the approximate Shapley value for weighted voting games and k-majority voting games. Crama and Leruth (2007) also proposed the estimation of the Shapley value for a complex voting game that reflects the structure of shareholdings in complex interlocked shareholding structures based on a Monte Carlo simulation.
In this paper, we propose a refinement based on stratified random sampling, which we use instead of simple random sampling to estimate the Shapley value. As found with the original algorithm, these refined estimations are polynomial if each marginal contribution can be calculated in polynomial time. The remainder of this paper is organized as follows. In Section 2, we provide some basic concepts and notation. We also describe the ApproShapley algorithm proposed by Castro et al. (2009), which is the basis of our propose method. In Section 3, we analyze the sources of the variance in the estimations derived from ApproShapley and we propose three methods for reducing this variance. First, we propose a general method based on stratified random sampling St-ApproShapley, Shst, and we then determine the optimum allocation of the sample sizes in the corresponding strata St-ApproShapley-opt, Shst, opt. We also propose a two-stage estimation method that preserves the efficiency of the Shapley value, St-ApproShapley-eff, Shst, eff, in the case where efficiency is a demanding property. In Section 4, we analyze the estimated error for stratified random sampling with the optimal allocation approach, and we compare it with the estimation method proposed by Maleki et al., which is described in Section 3. In Section 5, we present the proposed estimation algorithm. Finally, in Section 6, we present some computational results to show the improvements obtained using the proposed method for the cooperative games analyzed by Castro et al. (2009). We give our conclusions in Section 7.
