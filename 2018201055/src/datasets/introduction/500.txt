The continual safe and efficient operation of nuclear reactors requires accurate computer codes that can perform predictive safety studies and load follow calculations. There is an increasing demand for best estimate plus uncertainty (BEPU) modeling of nuclear reactors (International Atomic Energy Agency, 2008), meaning that calculations are no longer done with intentional conservatism but rather as accurately as possible, and results are reported with a confidence band.List of abbreviationsADAutomatic DifferentiationBEPUBest Estimate Plus Uncertainty (method)DNDual NumberDNADDual Number Automatic DifferentiationGRESSGradient Enhanced Software SystemMTRMaterial Testing ReactorNEWTNew ESC-based Weighting Transport (code)NRFSouth African National Research FoundationNUDUNANUclear Data UNcertainty Analysis (code)SAFARI-1South African Fundamental Atomic Research Installation, generation 1SAMSSensitivity Analysis Module for SCALESCALEStandardized Computer Analyses for Licensing Evaluation (code system)S/USensitivity and Uncertainty (analysis)TSUNAMITools for Sensitivity and Uncertainty Analysis Methodology Implementation (code)XSUSACross Section Uncertainty and Sensitivity Analysis (code)
There are many sources of uncertainty in a nuclear reactor simulation and these can be broadly grouped into the categories: uncertainty in input data, approximations in modeling methods and errors introduced by user input to simulation software. The focus of this work lies in the first category, on the propagation of uncertainties from input data to response parameters. Improving modeling methods is another active field on its own and user errors are typically addressed by various quality assurance processes and procedures.
Uncertainty in input data can come from many sources. The basic nuclear data libraries used in reactor simulations are created from experimental measurements and mathematical models. These nuclear data libraries inherently carry uncertainties (Ivanov et al., 2013), which are usually characterized by the second moments (variances and covariances) of their joint probability distribution. Another source of uncertainty is engineering specifications, in which parameters are defined as a mean value with tolerances to compensate for the limited precision possible during manufacturing. This work is focused on nuclear data uncertainties but the same methodology can be extended to other sources of uncertainty.
To get a confidence band or variance on the parameters computed in a core calculation, the data uncertainties have to be propagated from the basic nuclear data libraries through all calculations. For instance, the uncertainty in reactor parameters such as keff or power distribution, due to uncertainties in the cross-section data, can be obtained. Furthermore, the contribution of each individual source of uncertainty to the total uncertainty can be estimated with sensitivity analysis. The uncertainty propagation and the sensitivity analysis are often performed together and are referred to as sensitivity and uncertainty (S/U) analysis.
S/U analysis for the neutronic modeling of nuclear reactors can be performed with a variety of techniques, however one of the most commonly used approaches involves stochastic sampling methods. This approach relies on the creation of many cross-section libraries (typically in the order of hundreds) by sampling cross-sections from nuclear data libraries, using predefined probability distributions. Each library is used to perform reactor calculations, after which statistical analysis is conducted on the aggregated outputs. Although this method is very general, and allows for simultaneous uncertainty analyses of many reactor responses, it requires multiple evaluations of the model (corresponding to each library), which leads to a high computational cost. Additionally, not all sampling methods allow for sensitivity analysis. Examples of codes that use this approach are NUDUNA (Buss et al., 2010), XSUSA (Wemple and Zwermann, 2017) and Sampler (Oak Ridge National Laboratory, 2011).
Another approach that is widely used to perform S/U analysis uses perturbation theory to calculate sensitivity coefficients for responses. These coefficients can then be used in combination with covariance data to calculate the uncertainty in responses. This method requires only two reactor calculations (a forward and adjoint calculation), however its drawback is that S/U analysis can only be performed for one response at a time. Each response requires a new specification of the sensitivity coefficients. Examples of codes that use this approach are TSUNAMI (Oak Ridge National Laboratory, 2011) and CASMO-4 (Pusa, 2012).
In the present work, we discuss an alternative approach to uncertainty propagation, based on a combination of dual number automatic differentiation and the propagation-of-uncertainties equation known as the sandwich formula. Automatic differentiation (AD) is a set of techniques which allow the accurate numeric evaluation of derivatives of functions calculated by a computer program. They exploit the fact that derivatives of a function can be calculated via elementary arithmetic operations (addition, subtraction, multiplication, division) and elementary functions (exp, log, sin, cos, etc.) by applying the chain rule repeatedly to these operations (Fike and Alonso, 2011, Andrews, 2013, Baydin et al., 2018). In this way, derivatives of arbitrary order can be computed automatically, accurate to working precision. Automatic differentiation requires, at most, a small, constant factor more arithmetic operations than alternative approaches such as finite difference or symbolic differentiation (Pennestrı̀ and Stefanelli, 2007, Pennestrı̀ and Valentini, 2009). In this work, dual number arithmetic is used to implement automatic differentiation. Similarly to the sampling method, the approach allows simultaneous S/U analysis of many parameters. As with the perturbation theory approach, it produces the sensitivities required by the local S/U method, but calculates them more accurately. However, these improvements come at the cost of an increase in the computational expense, the magnitude of which depends on the number of uncertain input parameters, as will be elaborated on in the theory section.
Dual numbers were invented by Clifford (1873) and further developed for use in rigid body motion by Kotel’nikov, 1895, Study, 1901. Dual algebra formalism was traditionally applied in such fields as geometry (Yaglom, 1968, Yaglom, 1979) and kinematic analysis of rigid bodies and robotics (Angeles, 1998, Angeles, 2012, Fischer, 1998, Pennestrı̀ and Stefanelli, 2007, Pennestrı̀ and Valentini, 2009, Heiß, 1986). In recent years, interest in AD has grown significantly in various scientific disciplines, including numerical methods (Bartholomew-Biggs et al., 2000, Neidinger, 2010, Peñuñuri et al., 2014, Safiran et al., 2016), theoretical physics (Labunets et al., 2017, Schutte, 2017, Torres del Castillo, 2019), sensitivity analysis (Spall and Yu, 2012, Andrews, 2013), design optimization (Fike et al., 2011, Gao et al., 2017), data assimilation and inverse problems (Henrard, 2014), and machine learning and artificial intelligence (Baydin et al., 2018). It is also used to increase the efficiency of optimization algorithms (Izzo et al., 2017), specifically for large-scale nonlinear optimization.
Sensitivity analysis is one of the natural applications for AD methods. However, despite the large body of sensitivity and uncertainty analysis publications produced in the field of nuclear reactor science and engineering in the last decade, AD has seemingly not made its way into the mainstream nuclear reactor analysis industry yet. Very few authors in the field used AD for sensitivity analysis. An approach based on the direct application of the chain rule is used in SCALE for propagating uncertainties from the unshielded to the resonance self-shielded cross sections (Rearden and Horwedel, 2006, Horwedel, 2006, Rearden and Horwedel, 2007). Further, limited, studies were conducted by Abdel-Khalik et al. (2008) and, more recently, by Khoza et al., 2020, Bokov et al., 2020. The purpose of the present paper is to fill this gap and to demonstrate how AD can be employed in conjunction with some traditionally used sensitivity analysis and uncertainty propagation techniques. Specifically, the forward mode of AD based on dual number arithmetic was considered in the study.
The rest of the paper is organized as follows. In Section 2 we provide a short overview of the dual number algebra and dual number automatic differentiation (DNAD) method as well as of tools available for the practical implementation of DNAD, followed by a discussion of its application to S/U analysis. In Section 3 we describe a test diffusion problem and illustrate ways in which AD can by applied for uncertainty propagation in conjunction with some traditional solution approaches. Results of calculations and their analysis are presented in Section 4. Finally, Section 5 contains conclusions and recommendations for future studies.
