Curvilinear structures are objects with thin, long, elongated and, sometimes, arborescent shape, and present distinct intensity when compared to their neighbouring structures (Bibiloni et al., 2016). In the biomedical field, many studies (Kim, Markoulli, 2018, Rieber, Huber, Erhard, Mueller, Schweyer, Koenig, Schiele, Theisen, Siebert, Schoenberg, 2006) suggest geometrical and topological changes in numerous anatomical curvilinear structures - e.g., retinal blood vessels, cerebral vasculature, lung airways, or nerve fibres - are closely linked to the presence or severity of diseases, including, for instance, diabetes, stroke, hypertension, and keratitis.
Acquiring images of these anatomical curvilinear structures has impact in a number of two-dimensional (2D) and three-dimensional (3D) imaging modalities, such as colour fundus imaging, optical coherence tomography angiography (OCTA), fluorescence angiogram (FA), confocal microscopy (CM), magnetic resonance angiography (MRA), computed tomography angiography (CTA), etc. The top row of Fig. 1 demonstrates five examples of different medical image types, which include both 2D (Fig. 1(a–d)) and 3D (Fig. 1(e)) images.Download : Download high-res image (925KB)Download : Download full-size imageFig. 1. Images (tow row) and their manual annotations of curvilinear structures (bottom row) in different medical imaging modalities. From the left to right column: Retinal color fundus image; Retinal optical coherence tomography angiogram (OCTA); Corneal confocal microscopy (CCM) image; Optical coherence tomography (OCT) and Brain MRA. Note that the manual annotations of OCTA and CCM are made at a centerline level, and the cerebral vasculatures are visualized in 3D by maximum intensity projection.
As one type of curvilinear structure, retinal blood vessels are an essential component of the retina, and the morphology change of their retinal vasculature is closely related to many systemic, metabolic, and haematologic diseases (Annunziata, et al., 2016, Ding, Xia, Li, 2014). Retinal blood vessels are usually observed in colour fundus images (Franklin and Rajan, 2014) and OCTA images (de Carlo et al., 2015). Colour fundus imaging can exclusively reveal the superficial vascular network. At the same time, OCTA is a new, non-invasive imaging technique that generates volumetric angiography images, and can visualise the radial peripapillary and deep capillary networks that are not well-distinguished in colour fundus images. Corneal nerve fibre properties such as branching, density, and tortuosity are linked to eye and systemic diseases such as herpes, simplex keratitis and dry eye diseases (Eladawi, et al., 2017, Kim, Markoulli, 2018). In vivo corneal confocal microscopy (CCM) is a common technique for the imaging and inspection of corneal nerve fibres. Early detection of their geometrical and topological changes often helps to reduce the incidence of vision loss and blindness. MRA is an MRI examination of the human brain vessels (cerebral vasculature), which is vital for the diagnosis of many serious diseases such as strokes (Liao et al., 2012). Cerebral small vessel deformation plays an indicative role in lacunar strokes and brain haemorrhages and are a leading cause of cognitive decline and functional loss in elderly patients (Cuadrado-Godia et al., 2018).
In consequence, accurate extraction of these curvilinear structures from medical images is often an essential step in quantitative image analysis and computer-aided diagnostic pipelines. The bottom row of Fig. 1 illustrates the manual annotations of five types of medical images. However, manual annotation of these curvilinear structures is an exhaustive time-consuming task for graders, and subject to human error, and thus impractical in high-throughput analysis settings like screening programmes or microscopy (Zhao et al., 2018b). In addition, the commercial software available (e.g. ImageJ1and TubeTK2) still rely heavily on manual refinement. This calls for fast, accurate, and fully automated curvilinear structure extraction methods.
Over the last two decades, we have witnessed the rapid development of curvilinear structure detection methods, especially for blood vessel segmentation, as evidenced by general reviews of 2D vessel segmentation (Fraz, Remagnino, Hoppe, Uyyanonvara, Rudnicka, Owen, Barman, 2012, Zhao, Zheng, Liu, Zhao, Luo, Yang, Na, Wang, Liu, 2018), and 3D vessel segmentation (Lesage et al., 2009). Most existing segmentation methods suffer from issues posed by high anatomical variability across populations, and the varying scales of curvilinear structures within an image. On one hand, noise, poor contrast and low resolution exacerbate these problems. Standard image segmentation methods often cannot robustly detect all the curvilinear structures of interest. On the other hand, deep learning-based techniques have yet to be used to segment retinal vessels in OCTA and most of them are designed for the segmentation of vessels or fibers from one specific biomedical imaging modality. Moreover, most of them are designed specifically for 2D images and cannot easily be extended to 3D ones. It has proven very challenging to develop a single curvilinear structure detection method that works well across a variety of medical imaging modalities.
In this paper, we introduce a novel Channel and Spatial Attention Network (CS2-Net) to extract curvilinear structures from images in different imaging modalities. Our work was inspired by Dual Attention Network (DANet) (Fu et al., 2019) that were designed for the segmentation of natural images. While medical images contain more unique features, such as simpler semantics and unitary patterns, we first construct a network backbone based on the encoder-decoder framework, and then introduce a 1×3and a 3×1convolutional kernel to capture more boundary feature to assist the segmentation of curvilinear structures, rather than only up-sampling the attention features in the last layer of DANet. Such approach is more attractive to the researchers and practitioners, since they need not choose a particular method for each imaging modality and it is more applicable to various imaging modalities. The proposed method extends considerably our previous work (Mou et al., 2019), which focused on 2D curvilinear structure segmentation in medical images only. In this work, we have improved it so that it is applicable to segment the curvilinear structures from both 2D and 3D imaging modalities. We have also expanded our data pool for evaluation from three biomedical imaging modalities to six with a total of nine different datasets. Overall, this work makes the following contributions:
1)A new curvilinear structure segmentation network is proposed based on dual self-attention modules, which can deal with both 2D and 3D imaging modalities in an unified manner;2)Two self-attention mechanisms are employed in the channel and spatial spaces to generate attention-aware expressive features. They can enhance the network to capture long-range dependencies and make an effective use of the multi-channel space for feature representation and normalization, enabling the network to classify the curvilinear structure from background more effectively;3)Experimental results on nine datasets (six 2D datasets and three 3D datasets) demonstrate that our proposed CS2-Net achieves on the whole state-of-the-art performances in detecting curvilinear structures from different biomedical imaging modalities both quantitatively and qualitatively. The source code of this work is available at: https://github.com/iMED-Lab/CS-Net.
